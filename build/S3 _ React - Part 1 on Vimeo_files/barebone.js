/* VimeoPlayer - v3.24.2 - 2020-11-26 - https://player.vimeo.com/NOTICE.txt */
!function(t){"use strict";if(function(){for(var t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n){var i=t[n];window.requestAnimationFrame=window[i+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i+"CancelAnimationFrame"]||window[i+"CancelRequestAnimationFrame"]}!/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)&&window.requestAnimationFrame&&window.cancelAnimationFrame||(window.requestAnimationFrame=function(t){return setTimeout(t,0)},window.cancelAnimationFrame=clearTimeout)}(),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),"undefined"!=typeof DOMTokenList&&!function(){var t=document.createElement("div");return t.classList.toggle("test-class",!1),!t.classList.contains("test-class")}()){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,i){!0!==i?!1!==i?n.call(this,t):this.remove(t):this.add(t)}}"function"!=typeof Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),i=1;i<arguments.length;i++){var e=arguments[i];if(null!=e)for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r])}return n}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){for(var n=Object(this),i=n.length>>>0,e=arguments[1],r=0;r<i;){var u=n[r];if(t.call(e,u,r,n))return u;r++}}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){for(var n=Object(this),i=n.length>>>0,e=arguments[1],r=0;r<i;){var u=n[r];if(t.call(e,u,r,n))return r;r++}return-1}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,n){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),e=i.length>>>0;if(0===e)return!1;var r=0|n,u=Math.max(r>=0?r:e-Math.abs(r),0);function o(t,n){return t===n||"number"==typeof t&&"number"==typeof n&&isNaN(t)&&isNaN(n)}for(;u<e;){if(o(i[u],t))return!0;u++}return!1}}),String.prototype.includes||(String.prototype.includes=function(t,n){return"number"!=typeof n&&(n=0),!(n+t.length>this.length)&&-1!==this.indexOf(t,n)}),Object.values||(Object.values=function(t){return Object.keys(t).map((function(n){return t[n]}))});var i={object:!0,symbol:!0},e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(t,n,i){return t(i={path:n,exports:{},require:function(t,n){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==n&&i.path)}},i.exports),i.exports}var u,o,s,a,h=function(t){return null!=t},c=Object.keys,f=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}()?Object.keys:function(t){return c(h(t)?Object(t):t)},d=function(t){if(!h(t))throw new TypeError("Cannot use null or undefined");return t},v=Math.max,l=function(){var t,n=Object.assign;return"function"==typeof n&&(n(t={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}()?Object.assign:function(t,n){var i,e,r,u=v(arguments.length,2);for(t=Object(d(t)),r=function(e){try{t[e]=n[e]}catch(t){i||(i=t)}},e=1;e<u;++e)f(n=arguments[e]).forEach(r);if(void 0!==i)throw i;return t},p=Array.prototype.forEach,y=Object.create,w=function(t,n){var i;for(i in t)n[i]=t[i]},m=function(t){var n=y(null);return p.call(arguments,(function(t){h(t)&&w(Object(t),n)})),n},b=function(t){return"function"==typeof t},g="razdwatrzy",E=String.prototype.indexOf,k="function"==typeof g.contains&&!0===g.contains("dwa")&&!1===g.contains("foo")?String.prototype.contains:function(t){return E.call(this,t,arguments[1])>-1},_=r((function(t){(t.exports=function(t,n){var i,e,r,u,o;return arguments.length<2||"string"!=typeof t?(u=n,n=t,t=null):u=arguments[2],null==t?(i=r=!0,e=!1):(i=k.call(t,"c"),e=k.call(t,"e"),r=k.call(t,"w")),o={value:n,configurable:i,enumerable:e,writable:r},u?l(m(u),o):o}).gs=function(t,n,i){var e,r,u,o;return"string"!=typeof t?(u=i,i=n,n=t,t=null):u=arguments[3],null==n?n=void 0:b(n)?null==i?i=void 0:b(i)||(u=i,i=void 0):(u=n,n=i=void 0),null==t?(e=!0,r=!1):(e=k.call(t,"c"),r=k.call(t,"e")),o={get:n,set:i,configurable:e,enumerable:r},u?l(m(u),o):o}})),T=function(t){if(!function(t){return!!t&&("symbol"==typeof t||!!t.constructor&&"Symbol"===t.constructor.name&&"Symbol"===t[t.constructor.toStringTag])}(t))throw new TypeError(t+" is not a symbol");return t},A=Object.create,S=Object.defineProperties,R=Object.defineProperty,O=Object.prototype,j=A(null);if("function"==typeof Symbol){u=Symbol;try{String(u()),a=!0}catch(t){}}var M=function(){var t=A(null);return function(n){for(var i,e,r=0;t[n+(r||"")];)++r;return t[n+=r||""]=!0,R(O,i="@@"+n,_.gs(null,(function(t){e||(e=!0,R(this,i,_(t)),e=!1)}))),i}}();s=function(t){if(this instanceof s)throw new TypeError("TypeError: Symbol is not a constructor");return o(t)};var I=o=function t(n){var i;if(this instanceof t)throw new TypeError("TypeError: Symbol is not a constructor");return a?u(n):(i=A(s.prototype),n=void 0===n?"":String(n),S(i,{t:_("",n),i:_("",M(n))}))};S(o,{for:_((function(t){return j[t]?j[t]:j[t]=o(String(t))})),keyFor:_((function(t){var n;for(n in T(t),j)if(j[n]===t)return n})),hasInstance:_("",u&&u.hasInstance||o("hasInstance")),isConcatSpreadable:_("",u&&u.isConcatSpreadable||o("isConcatSpreadable")),iterator:_("",u&&u.iterator||o("iterator")),match:_("",u&&u.match||o("match")),replace:_("",u&&u.replace||o("replace")),search:_("",u&&u.search||o("search")),species:_("",u&&u.species||o("species")),split:_("",u&&u.split||o("split")),toPrimitive:_("",u&&u.toPrimitive||o("toPrimitive")),toStringTag:_("",u&&u.toStringTag||o("toStringTag")),unscopables:_("",u&&u.unscopables||o("unscopables"))}),S(s.prototype,{constructor:_(o),toString:_("",(function(){return this.i}))}),S(o.prototype,{toString:_((function(){return"Symbol ("+T(this).t+")"})),valueOf:_((function(){return T(this)}))}),R(o.prototype,o.toPrimitive,_("",(function(){var t=T(this);return"symbol"==typeof t?t:t.toString()}))),R(o.prototype,o.toStringTag,_("c","Symbol")),R(s.prototype,o.toStringTag,_("c",o.prototype[o.toStringTag])),R(s.prototype,o.toPrimitive,_("c",o.prototype[o.toPrimitive]));var N=function(){var t;if("function"!=typeof Symbol)return!1;t=Symbol("test symbol");try{String(t)}catch(t){return!1}return!!i[typeof Symbol.iterator]&&!!i[typeof Symbol.toPrimitive]&&!!i[typeof Symbol.toStringTag]}()?Symbol:I,D=r((function(t,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.6+9869a4bc
 */
t.exports=function(){function t(t){return"function"==typeof t}var n=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},i=0,r=void 0,u=void 0,o=function(t,n){v[i]=t,v[i+1]=n,2===(i+=2)&&(u?u(l):p())},s="undefined"!=typeof window?window:void 0,a=s||{},h=a.MutationObserver||a.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var t=setTimeout;return function(){return t(l,1)}}var v=new Array(1e3);function l(){for(var t=0;t<i;t+=2)(0,v[t])(v[t+1]),v[t]=void 0,v[t+1]=void 0;i=0}var p=void 0;function y(t,n){var i=this,e=new this.constructor(b);void 0===e[m]&&I(e);var r=i.u;if(r){var u=arguments[r-1];o((function(){return j(r,e,u,i.h)}))}else R(i,e,t,n);return e}function w(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var n=new this(b);return _(n,t),n}p=c?function(){return process.nextTick(l)}:h?function(){var t=0,n=new h(l),i=document.createTextNode("");return n.observe(i,{characterData:!0}),function(){i.data=t=++t%2}}():f?function(){var t=new MessageChannel;return t.port1.onmessage=l,function(){return t.port2.postMessage(0)}}():void 0===s?function(){try{var t=Function("return this")().require("vertx");return void 0!==(r=t.runOnLoop||t.runOnContext)?function(){r(l)}:d()}catch(t){return d()}}():d();var m=Math.random().toString(36).substring(2);function b(){}var g={error:null};function E(t){try{return t.then}catch(t){return g.error=t,g}}function k(n,i,e){i.constructor===n.constructor&&e===y&&i.constructor.resolve===w?function(t,n){1===n.u?A(t,n.h):2===n.u?S(t,n.h):R(n,void 0,(function(n){return _(t,n)}),(function(n){return S(t,n)}))}(n,i):e===g?(S(n,g.error),g.error=null):void 0===e?A(n,i):t(e)?function(t,n,i){o((function(t){var e=!1,r=function(i,r,u,o){try{i.call(r,(function(i){e||(e=!0,n!==i?_(t,i):A(t,i))}),(function(n){e||(e=!0,S(t,n))}))}catch(t){return t}}(i,n,0,0,t.l);!e&&r&&(e=!0,S(t,r))}),t)}(n,i,e):A(n,i)}function _(t,n){t===n?S(t,new TypeError("You cannot resolve a promise with itself")):function(t){var n=typeof t;return null!==t&&("object"===n||"function"===n)}(n)?k(t,n,E(n)):A(t,n)}function T(t){t.m&&t.m(t.h),O(t)}function A(t,n){void 0===t.u&&(t.h=n,t.u=1,0!==t.g.length&&o(O,t))}function S(t,n){void 0===t.u&&(t.u=2,t.h=n,o(T,t))}function R(t,n,i,e){var r=t.g,u=r.length;t.m=null,r[u]=n,r[u+1]=i,r[u+2]=e,0===u&&t.u&&o(O,t)}function O(t){var n=t.g,i=t.u;if(0!==n.length){for(var e=void 0,r=void 0,u=t.h,o=0;o<n.length;o+=3)e=n[o],r=n[o+i],e?j(i,e,r,u):r(u);t.g.length=0}}function j(n,i,e,r){var u=t(e),o=void 0,s=void 0,a=void 0,h=void 0;if(u){if((o=function(t,n){try{return t(n)}catch(t){return g.error=t,g}}(e,r))===g?(h=!0,s=o.error,o.error=null):a=!0,i===o)return void S(i,new TypeError("A promises callback cannot return that same promise."))}else o=r,a=!0;void 0!==i.u||(u&&a?_(i,o):h?S(i,s):1===n?A(i,o):2===n&&S(i,o))}var M=0;function I(t){t[m]=M++,t.u=void 0,t.h=void 0,t.g=[]}var N=function(){function t(t,i){this.k=t,this.promise=new t(b),this.promise[m]||I(this.promise),n(i)?(this.length=i.length,this._=i.length,this.h=new Array(this.length),0===this.length?A(this.promise,this.h):(this.length=this.length||0,this.T(i),0===this._&&A(this.promise,this.h))):S(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype.T=function(t){for(var n=0;void 0===this.u&&n<t.length;n++)this.A(t[n],n)},t.prototype.A=function(t,n){var i=this.k,e=i.resolve;if(e===w){var r=E(t);if(r===y&&void 0!==t.u)this.S(t.u,n,t.h);else if("function"!=typeof r)this._--,this.h[n]=t;else if(i===D){var u=new i(b);k(u,t,r),this.R(u,n)}else this.R(new i((function(n){return n(t)})),n)}else this.R(e(t),n)},t.prototype.S=function(t,n,i){var e=this.promise;void 0===e.u&&(this._--,2===t?S(e,i):this.h[n]=i),0===this._&&A(e,this.h)},t.prototype.R=function(t,n){var i=this;R(t,void 0,(function(t){return i.S(1,n,t)}),(function(t){return i.S(2,n,t)}))},t}(),D=function(){function n(t){this[m]=M++,this.h=this.u=void 0,this.g=[],b!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof n?function(t,n){try{n((function(n){_(t,n)}),(function(n){S(t,n)}))}catch(n){S(t,n)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return n.prototype.catch=function(t){return this.then(null,t)},n.prototype.finally=function(n){var i=this.constructor;return t(n)?this.then((function(t){return i.resolve(n()).then((function(){return t}))}),(function(t){return i.resolve(n()).then((function(){throw t}))})):this.then(n,n)},n}();return D.prototype.then=y,D.all=function(t){return new N(this,t).promise},D.race=function(t){var i=this;return n(t)?new i((function(n,e){for(var r=t.length,u=0;u<r;u++)i.resolve(t[u]).then(n,e)})):new i((function(t,n){return n(new TypeError("You must pass an array to race."))}))},D.resolve=w,D.reject=function(t){var n=new this(b);return S(n,t),n},D.O=function(t){u=t},D.j=function(t){o=t},D.M=o,D.polyfill=function(){var t=void 0;if(void 0!==e)t=e;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var i=null;try{i=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===i&&!n.cast)return}t.Promise=D},D.Promise=D,D}()})),P=window.Promise||D;P.allSettled||(P.allSettled=function(t){return P.all(t.map((function(t){return t.then((function(t){return{status:"fulfilled",value:t}})).catch((function(t){return{status:"rejected",reason:t}}))})))});var C=window.Map||function(){var t,n,i,e=function(){n=[],i=[]},r=function(i){return-1<(t=n.indexOf(i))};return e(),{get size(){return n.length},has:r,clear:e,get:function(t){return i[n.indexOf(t)]},keys:function(){return n.slice()},values:function(){return i.slice()},entries:function(){return n.map((function(t,n){return[t,i[n]]}))},delete:function(e){return r(e)&&n.splice(t,1)&&!!i.splice(t,1)},forEach:function(t,e){var r=this;i.forEach((function(i,u){return t.call(e,i,n[u],r)}))},set:function(e,u){return r(e)?i[t]=u:i[n.push(e)-1]=u,this}}},x=window.WeakMap||function(){var t=Object.defineProperty,n=Date.now()%1e9,i=function(){this.name="__st"+(1e9*Math.random()>>>0)+n+++"__"};return i.prototype.set=function(n,i){if("object"!==F(n)&&"function"!=typeof n)throw new TypeError("Invalid value used as weak map key");var e=n[this.name];return e&&e[0]===n?e[1]=i:t(n,this.name,{value:[n,i],writable:!0}),this},i.prototype.get=function(t){var n;return(n=t[this.name])&&n[0]===t?n[1]:void 0},i.prototype.delete=function(t){var n=t[this.name];return!(!n||n[0]!==t||(n[0]=n[1]=void 0,0))},i.prototype.has=function(t){var n=t[this.name];return!!n&&n[0]===t},i}(),L=window.Array.from,U=[1];
/**
 * @license
 *
 * Portions of this polyfill are a derivative work of the Polymer project, which requires the following licence notice:
 *
 * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
 */"function"==typeof L&&L(U)===U&&(L=!1);var H=L||function(t){return[].slice.call(t,0)};function F(t){return(F="function"==typeof N&&"symbol"==typeof N.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof N&&t.constructor===N&&t!==N.prototype?"symbol":typeof t})(t)}function B(t,n){for(var i=0;i<n.length;i++){var e=n[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function V(t,n,i){return n&&B(t.prototype,n),i&&B(t,i),t}function q(t,n,i){return n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}function W(t,n){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.push.apply(i,e)}return i}function G(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?W(Object(i),!0).forEach((function(n){q(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):W(Object(i)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}))}return t}function $(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n}function Y(t){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function z(t,n){return(z=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function K(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function X(t,n,i){return(X=K()?Reflect.construct:function(t,n,i){var e=[null];e.push.apply(e,n);var r=new(Function.bind.apply(t,e));return i&&z(r,i.prototype),r}).apply(null,arguments)}function J(t){var n="function"==typeof C?new C:void 0;return(J=function(t){if(null===t||!function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,i)}function i(){return X(t,arguments,Y(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),z(i,t)})(t)}function Q(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Z(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if(void 0!==N&&N.iterator in Object(t)){var i=[],e=!0,r=!1,u=void 0;try{for(var o,s=t[N.iterator]();!(e=(o=s.next()).done)&&(i.push(o.value),!n||i.length!==n);e=!0);}catch(t){r=!0,u=t}finally{try{e||null==s.return||s.return()}finally{if(r)throw u}}return i}}(t,n)||nt(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(t){return function(t){if(Array.isArray(t))return it(t)}(t)||function(t){if(void 0!==N&&N.iterator in Object(t))return H(t)}(t)||nt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nt(t,n){if(t){if("string"==typeof t)return it(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?H(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?it(t,n):void 0}}function it(t,n){(null==n||n>t.length)&&(n=t.length);for(var i=0,e=new Array(n);i<n;i++)e[i]=t[i];return e}var et=r((function(t,n){t.exports=function(t){var n={};return(t=t||{}).prependOn=function(n,i){return t.on(n,i,!0)},t.eventNames=function(){return Object.keys(n)},t.on=function(i,e,r){for(var u=0,o=(i=[].concat(i)).length;u<o;u++){var s=i[u];if(!s)throw new Error("Tried to listen for an undefined event.");n[s]||(n[s]=[]),r?n[s].unshift(e):n[s].push(e)}return t},t.once=function(n,i,e){function r(){i.apply(t.off(n,r),arguments)}return r.handler=i,t.on(n,r,e)},t.off=function(i,e){if(!i)return n={},t;for(var r=0,u=(i=[].concat(i)).length;r<u;r++){var o=i[r];if(!o)throw new Error("Tried to remove an undefined event.");if(o in n)if(e){var s=n[o].indexOf(e);if(-1===s)for(var a=0,h=n[o].length;a<h;a++)if(n[o][a].handler===e){s=r;break}if(-1===s)return t;n[o].splice(s,1)}else delete n[o]}return t},t.fire=function(i){if(!i)throw new Error("Tried to fire an undefined event.");if(i in n)for(var e=n[i].slice(0),r=0,u=e.length;r<u;r++)if(e[r].apply(t,e.slice.call(arguments,1)),t.I){delete t.I;break}return t},t.halt=function(){return t.I=!0,t},t}}));function rt(t){return function(n){for(var i=arguments.length,e=new Array(i>1?i-1:0),r=1;r<i;r++)e[r-1]=arguments[r];return e.forEach((function(i){for(var e in i){var r=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(n,e,Object.assign(r,t))}})),n}}var ut=rt({enumerable:!1,configurable:!0,writeable:!1}),ot=rt({enumerable:!1,configurable:!1,writeable:!1}),st=rt({enumerable:!0,configurable:!0,writeable:!1}),at={defer:!0,async:!0};function ht(t,n){n=Object.assign(at,n);var i=window.vpimport__=window.vpimport__||{cache:{}};if(i.cache[t])return i.cache[t].N;var e=new P((function(e,r){var u=document.getElementsByTagName("head")[0],o=document.createElement("script");o.src=""+t,o.defer=n.defer,o.async=n.async,o.onreadystatechange=o.onload=function(){var n=Object.keys(i).filter((function(t){return"cache"!==t}))[0];i.cache[t].D=i[n],delete i[n],e(i.cache[t].D),u.removeChild(o)},o.onerror=function(n){r(n),delete i.cache[t],u.removeChild(o)},u.appendChild(o)}));return i.cache[t]={N:e},e}function ct(t){for(var n=function(t){return t&&"object"===F(t)},i=arguments.length,e=new Array(i>1?i-1:0),r=1;r<i;r++)e[r-1]=arguments[r];return e.reduce((function(t,i){return Object.keys(i||{}).forEach((function(e){var r=t[e],u=i[e];r&&void 0===u||(Array.isArray(u)?t[e]=(r||[]).concat(u):n(u)?t[e]=ct({},r,u):t[e]=u)})),t}),t)}function ft(){var t,n,i=new P((function(i,e){t=i,n=e}));return i.resolve=t,i.reject=n,i}function dt(t,n){for(var i=t,e=0;e<n.length;e++)if(n.start(e)<=t&&n.end(e)>=t){i=n.end(e);break}return i-t}function vt(t){return"string"!=typeof t?{}:t.replace("?","").split("&").reduce((function(t,n){if(n.length>0){var i=Z(n.split("="),2),e=i[0],r=i[1];t[e]=decodeURIComponent(r)}return t}),{})}function lt(t,n){var i=function(t){if("object"!==F(t))return"";var n=[];for(var i in t)t.hasOwnProperty(i)&&n.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return n.length?n.join("&"):""}(n);return"".concat(t).concat(i?"?".concat(i):"")}function pt(t,n,i){switch(i.length){case 0:return t.call(n);case 1:return t.call(n,i[0]);case 2:return t.call(n,i[0],i[1]);case 3:return t.call(n,i[0],i[1],i[2])}return t.apply(n,i)}function yt(t){return t}var wt=Math.max;function mt(t){return function(){return t}}var bt="object"==("undefined"==typeof global?"undefined":F(global))&&global&&global.Object===Object&&global,gt="object"==("undefined"==typeof self?"undefined":F(self))&&self&&self.Object===Object&&self,Et=bt||gt||Function("return this")(),kt=Et.Symbol,_t=Object.prototype,Tt=_t.hasOwnProperty,At=_t.toString,St=kt?kt.toStringTag:void 0,Rt=Object.prototype.toString,Ot=kt?kt.toStringTag:void 0;function jt(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Ot&&Ot in Object(t)?function(t){var n=Tt.call(t,St),i=t[St];try{t[St]=void 0;var e=!0}catch(t){}var r=At.call(t);return e&&(n?t[St]=i:delete t[St]),r}(t):function(t){return Rt.call(t)}(t)}function Mt(t){var n=F(t);return null!=t&&("object"==n||"function"==n)}function It(t){if(!Mt(t))return!1;var n=jt(t);return"[object Function]"==n||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n}var Nt=Et["P"],Dt=function(){var t=/[^.]+$/.exec(Nt&&Nt.keys&&Nt.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Pt=Function.prototype.toString;function Ct(t){if(null!=t){try{return Pt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var xt=/^\[object .+?Constructor\]$/,Lt=Function.prototype,Ut=Object.prototype,Ht=Lt.toString,Ft=Ut.hasOwnProperty,Bt=RegExp("^"+Ht.call(Ft).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Vt(t,n){var i=function(t,n){return null==t?void 0:t[n]}(t,n);return function(t){return!(!Mt(t)||function(t){return!!Dt&&Dt in t}(t))&&(It(t)?Bt:xt).test(Ct(t))}(i)?i:void 0}var qt=function(){try{var t=Vt(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),Wt=qt?function(t,n){return qt(t,"toString",{configurable:!0,enumerable:!1,value:mt(n),writable:!0})}:yt,Gt=Date.now,$t=function(t){var n=0,i=0;return function(){var e=Gt(),r=16-(e-i);if(i=e,r>0){if(++n>=800)return arguments[0]}else n=0;return t.apply(void 0,arguments)}}(Wt);function Yt(t,n){return $t(function(t,n,i){return n=wt(void 0===n?t.length-1:n,0),function(){for(var e=arguments,r=-1,u=wt(e.length-n,0),o=Array(u);++r<u;)o[r]=e[n+r];r=-1;for(var s=Array(n+1);++r<n;)s[r]=e[r];return s[n]=i(o),pt(t,this,s)}}(t,n,yt),t+"")}function zt(t,n){return t===n||t!=t&&n!=n}function Kt(t,n){for(var i=t.length;i--;)if(zt(t[i][0],n))return i;return-1}var Xt=Array.prototype.splice;function Jt(t){var n=-1,i=null==t?0:t.length;for(this.clear();++n<i;){var e=t[n];this.set(e[0],e[1])}}Jt.prototype.clear=function(){this.C=[],this.size=0},Jt.prototype.delete=function(t){var n=this.C,i=Kt(n,t);return!(i<0||(i==n.length-1?n.pop():Xt.call(n,i,1),--this.size,0))},Jt.prototype.get=function(t){var n=this.C,i=Kt(n,t);return i<0?void 0:n[i][1]},Jt.prototype.has=function(t){return Kt(this.C,t)>-1},Jt.prototype.set=function(t,n){var i=this.C,e=Kt(i,t);return e<0?(++this.size,i.push([t,n])):i[e][1]=n,this};var Qt=Vt(Et,"Map"),Zt=Vt(Object,"create"),tn=Object.prototype.hasOwnProperty,nn=Object.prototype.hasOwnProperty;function en(t){var n=-1,i=null==t?0:t.length;for(this.clear();++n<i;){var e=t[n];this.set(e[0],e[1])}}function rn(t,n){var i=t.C;return function(t){var n=F(t);return"string"==n||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t}(n)?i["string"==typeof n?"string":"hash"]:i.map}function un(t){var n=-1,i=null==t?0:t.length;for(this.clear();++n<i;){var e=t[n];this.set(e[0],e[1])}}function on(t){var n=this.C=new Jt(t);this.size=n.size}function sn(t,n,i){"__proto__"==n&&qt?qt(t,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[n]=i}function an(t,n,i){(void 0!==i&&!zt(t[n],i)||void 0===i&&!(n in t))&&sn(t,n,i)}en.prototype.clear=function(){this.C=Zt?Zt(null):{},this.size=0},en.prototype.delete=function(t){var n=this.has(t)&&delete this.C[t];return this.size-=n?1:0,n},en.prototype.get=function(t){var n=this.C;if(Zt){var i=n[t];return"__lodash_hash_undefined__"===i?void 0:i}return tn.call(n,t)?n[t]:void 0},en.prototype.has=function(t){var n=this.C;return Zt?void 0!==n[t]:nn.call(n,t)},en.prototype.set=function(t,n){var i=this.C;return this.size+=this.has(t)?0:1,i[t]=Zt&&void 0===n?"__lodash_hash_undefined__":n,this},un.prototype.clear=function(){this.size=0,this.C={hash:new en,map:new(Qt||Jt),string:new en}},un.prototype.delete=function(t){var n=rn(this,t).delete(t);return this.size-=n?1:0,n},un.prototype.get=function(t){return rn(this,t).get(t)},un.prototype.has=function(t){return rn(this,t).has(t)},un.prototype.set=function(t,n){var i=rn(this,t),e=i.size;return i.set(t,n),this.size+=i.size==e?0:1,this},on.prototype.clear=function(){this.C=new Jt,this.size=0},on.prototype.delete=function(t){var n=this.C,i=n.delete(t);return this.size=n.size,i},on.prototype.get=function(t){return this.C.get(t)},on.prototype.has=function(t){return this.C.has(t)},on.prototype.set=function(t,n){var i=this.C;if(i instanceof Jt){var e=i.C;if(!Qt||e.length<199)return e.push([t,n]),this.size=++i.size,this;i=this.C=new un(e)}return i.set(t,n),this.size=i.size,this};var hn=function(t,n,i){for(var e=-1,r=Object(t),u=i(t),o=u.length;o--;){var s=u[++e];if(!1===n(r[s],s,r))break}return t},cn="object"==(void 0===t?"undefined":F(t))&&t&&!t.nodeType&&t,fn=cn&&"object"==("undefined"==typeof module?"undefined":F(module))&&module&&!module.nodeType&&module,dn=fn&&fn.exports===cn?Et.Buffer:void 0,vn=dn?dn.allocUnsafe:void 0;function ln(t,n){if(n)return t.slice();var i=t.length,e=vn?vn(i):new t.constructor(i);return t.copy(e),e}var pn=Et.Uint8Array;function yn(t){var n=new t.constructor(t.byteLength);return new pn(n).set(new pn(t)),n}function wn(t,n){var i=n?yn(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}function mn(t,n){var i=-1,e=t.length;for(n||(n=Array(e));++i<e;)n[i]=t[i];return n}var bn=Object.create,gn=function(){function t(){}return function(n){if(!Mt(n))return{};if(bn)return bn(n);t.prototype=n;var i=new t;return t.prototype=void 0,i}}();function En(t,n){return function(i){return t(n(i))}}var kn=En(Object.getPrototypeOf,Object),_n=Object.prototype;function Tn(t){var n=t&&t.constructor;return t===("function"==typeof n&&n.prototype||_n)}function An(t){return"function"!=typeof t.constructor||Tn(t)?{}:gn(kn(t))}function Sn(t){return null!=t&&"object"==F(t)}function Rn(t){return Sn(t)&&"[object Arguments]"==jt(t)}var On=Object.prototype,jn=On.hasOwnProperty,Mn=On.propertyIsEnumerable,In=Rn(function(){return arguments}())?Rn:function(t){return Sn(t)&&jn.call(t,"callee")&&!Mn.call(t,"callee")},Nn=Array.isArray;function Dn(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function Pn(t){return null!=t&&Dn(t.length)&&!It(t)}var Cn="object"==(void 0===t?"undefined":F(t))&&t&&!t.nodeType&&t,xn=Cn&&"object"==("undefined"==typeof module?"undefined":F(module))&&module&&!module.nodeType&&module,Ln=xn&&xn.exports===Cn?Et.Buffer:void 0,Un=(Ln?Ln.isBuffer:void 0)||function(){return!1},Hn=Function.prototype,Fn=Object.prototype,Bn=Hn.toString,Vn=Fn.hasOwnProperty,qn=Bn.call(Object),Wn={};function Gn(t){return function(n){return t(n)}}Wn["[object Float32Array]"]=Wn["[object Float64Array]"]=Wn["[object Int8Array]"]=Wn["[object Int16Array]"]=Wn["[object Int32Array]"]=Wn["[object Uint8Array]"]=Wn["[object Uint8ClampedArray]"]=Wn["[object Uint16Array]"]=Wn["[object Uint32Array]"]=!0,Wn["[object Arguments]"]=Wn["[object Array]"]=Wn["[object ArrayBuffer]"]=Wn["[object Boolean]"]=Wn["[object DataView]"]=Wn["[object Date]"]=Wn["[object Error]"]=Wn["[object Function]"]=Wn["[object Map]"]=Wn["[object Number]"]=Wn["[object Object]"]=Wn["[object RegExp]"]=Wn["[object Set]"]=Wn["[object String]"]=Wn["[object WeakMap]"]=!1;var $n="object"==(void 0===t?"undefined":F(t))&&t&&!t.nodeType&&t,Yn=$n&&"object"==("undefined"==typeof module?"undefined":F(module))&&module&&!module.nodeType&&module,zn=Yn&&Yn.exports===$n&&bt.process,Kn=function(){try{return Yn&&Yn.require&&Yn.require("util").types||zn&&zn.binding&&zn.binding("util")}catch(t){}}(),Xn=Kn&&Kn.isTypedArray,Jn=Xn?Gn(Xn):function(t){return Sn(t)&&Dn(t.length)&&!!Wn[jt(t)]};function Qn(t,n){if(("constructor"!==n||"function"!=typeof t[n])&&"__proto__"!=n)return t[n]}var Zn=Object.prototype.hasOwnProperty;function ti(t,n,i){var e=t[n];Zn.call(t,n)&&zt(e,i)&&(void 0!==i||n in t)||sn(t,n,i)}function ni(t,n,i,e){var r=!i;i||(i={});for(var u=-1,o=n.length;++u<o;){var s=n[u],a=e?e(i[s],t[s],s,i,t):void 0;void 0===a&&(a=t[s]),r?sn(i,s,a):ti(i,s,a)}return i}var ii=/^(?:0|[1-9]\d*)$/;function ei(t,n){var i=F(t);return!!(n=null==n?9007199254740991:n)&&("number"==i||"symbol"!=i&&ii.test(t))&&t>-1&&t%1==0&&t<n}var ri=Object.prototype.hasOwnProperty;function ui(t,n){var i=Nn(t),e=!i&&In(t),r=!i&&!e&&Un(t),u=!i&&!e&&!r&&Jn(t),o=i||e||r||u,s=o?function(t,n){for(var i=-1,e=Array(t);++i<t;)e[i]=n(i);return e}(t.length,String):[],a=s.length;for(var h in t)!n&&!ri.call(t,h)||o&&("length"==h||r&&("offset"==h||"parent"==h)||u&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||ei(h,a))||s.push(h);return s}var oi=Object.prototype.hasOwnProperty;function si(t){return Pn(t)?ui(t,!0):function(t){if(!Mt(t))return function(t){var n=[];if(null!=t)for(var i in Object(t))n.push(i);return n}(t);var n=Tn(t),i=[];for(var e in t)("constructor"!=e||!n&&oi.call(t,e))&&i.push(e);return i}(t)}function ai(t,n,i,e,r){t!==n&&hn(n,(function(u,o){if(r||(r=new on),Mt(u))!function(t,n,i,e,r,u,o){var s=Qn(t,i),a=Qn(n,i),h=o.get(a);if(h)an(t,i,h);else{var c=u?u(s,a,i+"",t,n,o):void 0,f=void 0===c;if(f){var d=Nn(a),v=!d&&Un(a),l=!d&&!v&&Jn(a);c=a,d||v||l?Nn(s)?c=s:function(t){return Sn(t)&&Pn(t)}(s)?c=mn(s):v?(f=!1,c=ln(a,!0)):l?(f=!1,c=wn(a,!0)):c=[]:function(t){if(!Sn(t)||"[object Object]"!=jt(t))return!1;var n=kn(t);if(null===n)return!0;var i=Vn.call(n,"constructor")&&n.constructor;return"function"==typeof i&&i instanceof i&&Bn.call(i)==qn}(a)||In(a)?(c=s,In(s)?c=function(t){return ni(t,si(t))}(s):Mt(s)&&!It(s)||(c=An(a))):f=!1}f&&(o.set(a,c),r(c,a,e,u,o),o.delete(a)),an(t,i,c)}}(t,n,o,i,ai,e,r);else{var s=e?e(Qn(t,o),u,o+"",t,n,r):void 0;void 0===s&&(s=u),an(t,o,s)}}),si)}function hi(t,n,i,e,r,u){return Mt(t)&&Mt(n)&&(u.set(n,t),ai(t,n,void 0,hi,u),u.delete(n)),t}function ci(t){return Yt((function(n,i){var e=-1,r=i.length,u=r>1?i[r-1]:void 0,o=r>2?i[2]:void 0;for(u=t.length>3&&"function"==typeof u?(r--,u):void 0,o&&function(t,n,i){if(!Mt(i))return!1;var e=F(n);return!!("number"==e?Pn(i)&&ei(n,i.length):"string"==e&&n in i)&&zt(i[n],t)}(i[0],i[1],o)&&(u=r<3?void 0:u,r=1),n=Object(n);++e<r;){var s=i[e];s&&t(n,s,e,u)}return n}))}var fi=ci((function(t,n,i,e){ai(t,n,i,e)})),di=Yt((function(t){return t.push(void 0,hi),pt(fi,void 0,t)})),vi=function(){function t(t){this.L=!1,this.U=!1,this.H=t,et(this)}V(t,null,[{key:"displayName",get:function(){return"ExternalDisplay"}},{key:"supported",get:function(){return!1}},{key:"supportedVideoTypes",get:function(){return[]}}]);var n=t.prototype;return n.showPicker=function(){},n.getFile=function(){var t=this.constructor.displayName.replace("ExternalDisplay","");if(this.H.externalDisplayFiles[t])return this.H.externalDisplayFiles[t];var n=this.constructor.supportedVideoTypes,i=this.H.files.filter((function(t){return-1!==n.indexOf(t.mime)})).sort((function(t,i){return t.mime===i.mime?t.priority-i.priority:n.indexOf(t.mime)-n.indexOf(i.mime)}));if(!i.length)throw new Error("No files available for ".concat(this.constructor.displayName," external display."));return i[0]},V(t,[{key:"active",get:function(){return this.U}},{key:"available",get:function(){return this.L}},{key:"element",get:function(){return document.createElement("div")}}]),t}(),li={ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",RESIZE:"resize",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting",WEBKIT_BEGIN_FULLSCREEN:"webkitbeginfullscreen",WEBKIT_END_FULLSCREEN:"webkitendfullscreen",WEBKIT_PRESENTATION_MODE_CHANGED:"webkitpresentationmodechanged"},pi={AVAILABLE:"externaldisplayavailable",UNAVAILABLE:"externaldisplayunavailable",ACTIVATED:"externaldisplayactivated",DEACTIVATED:"externaldisplaydeactivated"},yi={AIRPLAY_AVAILABLE:"available",AIRPLAY_UNAVAILABLE:"unavailable",AIRPLAY_ACTIVATED:"activated",AIRPLAY_DEACTIVATED:"deactivated"},wi={SCANNER_CHANGE:"scannerchange",SCANNER_ERROR:"scannererror",FILE_ERROR:"fileerror",FILE_SRC_UPDATE:"filesrcupdate",DOWNLOAD_START:"downloadstart",DOWNLOAD_END:"downloadend",DOWNLOAD_ERROR:"downloaderror",DOWNLOAD_TIMEOUT:"downloadtimeout",DRM_AUTH_FAILURE:"drmauthfailure",DRM_AUTH_SUCCESS:"drmauthsuccess",DRM_FAILURE:"drmfailure",DRM_OUTPUT_RESTRICTED:"drmoutputrestricted",EME_UNSUPPORTED:"emeunsupported",CURRENT_FILE_CHANGE:"currentfilechange",MEDIA_URL_EXPIRED:"mediaurlexpired",MEDIA_URL_BAD_REQUEST:"mediaurlbadrequest",STREAM_CHANGE:"streamchange",STREAM_CHANGE_START:"streamchangestart",STREAM_BUFFER_START:"streambufferstart",STREAM_BUFFER_END:"streambufferend",DROPPED_FRAMES:"droppedframes",BANDWIDTH:"bandwidth",STREAM_TARGET_CHANGE:"streamtargetchange",PRESENTATION_MODE_CHANGE:"presentationmodechange",CUE_POINT:"cuepoint",BUFFER_OCCUPANCY:"bufferoccupancy",MANIFEST_TIMEOUT:"manifesttimeout",MANIFEST_LOADED:"manifestloaded",STREAMS_LOADED:"streamsloaded",TEXT_SRC_UPDATE:"texttracksrcupdate",TEXT_TRACKS_AVAILABLE:"texttracksavailable",AV_DURATION_MISMATCH:"avdurationmismatch",BUFFER_STARTED:"bufferstarted",BUFFER_ENDED:"bufferended",QUOTA_EXCEEDED_ERROR:"quotaexceedederror",CHAPTER_CUES_UPDATED:"chaptercuesupdated",APPEND_BUFFER_END:"appendbufferend"},mi={STREAM_ONLINE:"livestreamonline",STREAM_OFFLINE:"livestreamoffline",BUFFER_GAP_JUMP:"livebuffergapjump",BUFFER_GAP_JUMP_PREVENT:"livebuffergapjumpprevent"},bi={CAMERA_UPDATE:"cameraupdate",CAMERA_CHANGE:"camerachange",MOTION_START:"motionstart",MOTION_END:"motionend",SPATIAL_UNSUPPORTED:"spatialunsupported",WEBVR_ENTER:"entervr",WEBVR_EXIT:"exitvr",WEBVR_HARDWARE_AVAILABLE:"webvrhardwareavailable"},gi={MEDIASESSION_PLAY:"mediasessionplay",MEDIASESSION_PAUSE:"mediasessionpause",MEDIASESSION_SEEK_FORWARD:"mediasessionseekforward",MEDIASESSION_SEEK_BACKWARD:"mediasessionseekbackward"},Ei={BRAIN_ML_MODEL_ERR:"brainmlmodelerr",BRAIN_ML_MODEL_NET_ERR:"brainmlmodelresperr",BRAIN_ML_MODEL_TIMEOUT:"brainmlmodeltimeout",BRAIN_ML_SWITCH_TO_SKYFIRE:"brainmlmodelswitchtoskyfire",BRAIN_ML_MODEL_INPUTS:"brainmlmodelinputs"},ki=Object.assign({},li,pi,yi,wi,bi,mi,gi,Ei),AirPlayExternalDisplay=function(t){function AirPlayExternalDisplay(n){var i;return(i=t.call(this,n)||this).F=document.createElement("video"),i.F.setAttribute("data-airplay",""),i.F.setAttribute("x-webkit-airplay","allow"),i.addVideoEventListeners(),i}$(AirPlayExternalDisplay,t),V(AirPlayExternalDisplay,null,[{key:"displayName",get:function(){return"AirPlayExternalDisplay"}},{key:"supported",get:function(){return"WebKitPlaybackTargetAvailabilityEvent"in window}},{key:"supportedVideoTypes",get:function(){return["application/vnd.apple.mpegurl","video/mp4"]}}]);var n=AirPlayExternalDisplay.prototype;return n.addVideoEventListeners=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.F;n.addEventListener(li.LOADED_METADATA,(function(n){t.fire(li.LOADED_METADATA,n)})),n.addEventListener("webkitplaybacktargetavailabilitychanged",(function(n){switch(n.availability){case"available":t.L||(t.L=!0,t.fire(yi.AIRPLAY_AVAILABLE));break;case"not-available":t.L&&(t.L=!1,t.fire(yi.AIRPLAY_UNAVAILABLE))}})),n.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",(function(n){if(n.target.webkitCurrentPlaybackTargetIsWireless)return t.U=!0,void t.fire(yi.AIRPLAY_ACTIVATED);t.U=!1,t.fire(yi.AIRPLAY_DEACTIVATED)}))},n.showPicker=function(){var t=this;this.F.webkitShowPlaybackTargetPicker(),this.loadMetadata().then((function(){return t.F.webkitShowPlaybackTargetPicker()})).catch((function(){}))},n.loadMetadata=function(){var t=this;return this.F.readyState>=1?P.resolve():new P((function(n,i){t.F.addEventListener(li.LOADED_METADATA,(function(){n()})),t.F.src=t.getFile().src}))},V(AirPlayExternalDisplay,[{key:"element",get:function(){return this.F},set:function(t){if(!(t instanceof HTMLVideoElement))throw new TypeError("The element for AirPlay must be a <video>.");t!==this.F&&(this.addVideoEventListeners(t),this.F=t,this.F.setAttribute("x-webkit-airplay","allow"))}}]),AirPlayExternalDisplay}(vi),_i=navigator.userAgent.toLowerCase();function Ti(t){t=t.toLowerCase();var n=new RegExp(t).test(_i);return"safari"===t?n&&new RegExp("version").test(_i):n}function Ai(t){var n=document.createElement("div"),i=t.charAt(0).toUpperCase()+t.slice(1),e=(t+" "+["Webkit","Moz","O","ms"].join(i+" ")+i).split(" ");for(var r in e){var u=e[r];if(void 0!==n.style[u])return u}return t}var Si=!!Ti("android")&&(parseFloat(_i.replace(/^.* android (\d+)\.(\d+).*$/,"$1.$2"))||!0),Ri=window.devicePixelRatio||1,Oi=!(!Ti("windows phone")&&!Ti("iemobile"))&&(parseFloat(_i.replace(/^.* windows phone (os )?(\d+)\.(\d+).*$/,"$2.$3"))||!0),ji=!!Ti("msie")&&parseFloat(_i.replace(/^.*msie (\d+).*$/,"$1")),Mi=!!Ti("trident")&&parseFloat(_i.replace(/^.*trident\/(\d+)\.(\d+).*$/,"$1.$2"))+4,Ii=!!(Ti("ipad;")||Ti("iphone;")||Ti("ipod touch;"))&&parseFloat(_i.replace(/^.* os (\d+)_(\d+).*$/,"$1.$2")),Ni=Ti("opera")||Ti("opr"),Di=/^Mozilla\/5\.0 \(.* Mac OS X.*\(KHTML, like Gecko\)(?: Mobile\/[\S]*|)$/i.test(_i);function Pi(){if(!Ti("safari"))return[];var t=_i.split(" ").find((function(t){return/version\//.test(t)}));return t?t.replace("version/","").split(".").map((function(t){return parseInt(t,10)})):[]}var Ci=Ti("safari")&&Ti("apple")&&!Ti("chrome")&&!Ti("android")&&Pi()[0]>=11,xi={airPlay:"WebKitPlaybackTargetAvailabilityEvent"in window,android:Si,appleMail:Di,hasAutoplayPolicy:Si||Ii||Ci||function(){if(!Ti("chrome"))return[];var t=_i.split(" ").find((function(t){return Ii?/CriOS\//.test(t):/chrome\//.test(t)}));return t?t.replace("chrome/","").split(".").map((function(t){return parseInt(t,10)})):[]}()[0]>=66,iOS:Ii,mobileAndroid:Si&&Ti("mobile"),browser:{bb10:Ti("bb10"),chrome:Ti("chrome"),firefox:Ti("firefox"),ie:ji||Mi,edge:Ti("edge"),opera:Ni,safari:Ti("safari")&&Ti("apple")&&!Ti("chrome")&&!Ti("android")},devicePixelRatio:Ri,iPhone:Ti("iphone;")||Ti("ipod touch;")||Ti("ipod;"),iPad:Ti("ipad;"),iPadNonRetina:Ti("ipad;")&&Ri<2,mac:Ti("mac os"),pointerEvents:window.navigator.pointerEnabled||window.navigator.msPointerEnabled||!1,passiveEvents:function(){var t=!1;try{var n=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassive",null,n),window.removeEventListener("testPassive",null,n)}catch(t){}return t}(),svg:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||Ti("windows phone")||window.navigator.maxTouchPoints>1||window.navigator.msMaxTouchPoints||!1,transformProperty:Ai("transform"),transitionProperty:Ai("transition"),webp:function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))&&0===t.toDataURL("image/webp").indexOf("data:image/webp")}(),windowsPhone:Oi},Li=/mac os x 10_13/.test(_i),Ui=xi.iOS&&xi.iOS>=11,Hi=xi.iPhone&&812===window.screen.availHeight&&375===window.screen.availWidth,Fi=xi.iPhone&&896===window.screen.availHeight&&414===window.screen.availWidth,Bi=xi.iPad&&1112===window.screen.availWidth&&834===window.screen.availHeight,Vi=xi.iPad&&834===window.screen.availWidth&&1194===window.screen.availHeight,qi=xi.iPad&&1024===window.screen.availWidth&&1366===window.screen.availHeight,Wi=Hi||Fi||Bi||Vi||qi;function Gi(){return!!(Ci&&Li||Ci&&Ui)||"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported('video/mp4; codecs="hvc1"')}function $i(){return!(xi.iOS||xi.iPad||xi.browser.ie)&&(!Ti("safari")||Pi()[0]>11||11===Pi()[0]&&(Pi()[2]>1||Pi()[1]>0))}xi.hevc=Gi(),xi.hdr=Ci&&Ui&&Wi,xi.vp9hdr=(window.matchMedia("(color-gamut: p3)").matches||window.matchMedia("(color-gamut: rec2020)").matches)&&screen.colorDepth>=48&&(MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.01"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.01"')),xi.av1="undefined"!=typeof MediaSource&&MediaSource.isTypeSupported('video/mp4; codecs="av01.0.31M.08.0.110.01.01.01.0"'),xi.webvr=!(!window.navigator||!("getVRDisplays"in window.navigator)),xi.webxr=!!(window.navigator&&"xr"in window.navigator&&"supportsSession"in window.navigator.xr),xi.spatialPlayback=$i(),xi.spatialHEVC=!xi.browser.safari&&$i()&&Gi(),xi.stereoscopic=xi.spatialPlayback&&xi.mobileAndroid;var Yi=/Firefox/.test(navigator.userAgent),zi=/i(Phone|Pad|Pod touch);/.test(navigator.userAgent),Ki=/Android/.test(navigator.userAgent),Xi={firefox:Yi,iOS:zi,android:Ki,androidMobile:Ki&&/mobile/.test(navigator.userAgent.toLowerCase()),chrome:function(){var t=navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\./);return!!t&&{major:t[1],minor:t[2]}}()};function Ji(t,n){var i,e=0;return q(i={},N.iterator,(function(){return this})),q(i,"next",(function(){return e<t.length?{done:!1,value:n?[t[e],n[e++]]:t[e++]}:{done:!0}})),i}var Qi=function(t){for(var n=0,i=this.length;n<i;n++)if(this[n].id==="".concat(t))return this[n];return null};function Zi(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.item=function(t){return this[t]},t.getTrackById=Qi,t}function te(){return void 0!==window.performance&&"function"==typeof window.performance.now?window.performance.now():Date.now()}function ne(t){return te()-t}function ie(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(t){return(t^(16*Math.random()>>t)/4).toString(16)}))}function ee(t){for(var n=window.atob(t),i=n.length,e=new Uint8Array(i),r=0;r<i;r++)e[r]=n.charCodeAt(r);return e}function re(t){return ee(t).buffer}function ue(t,n,i,e){var r=0,u=0,o=t,s=n,a=i/e;return o/s>=a?(u=s,r=(a*s).toFixed(2)):(r=o,u=(o/a).toFixed(2)),{width:r,height:u,left:Math.max((o-r)/2,0),top:Math.max((s-u)/2,0)}}function oe(t){var n=[document.fullscreenElement,document.webkitFullscreenElement,document.webkitCurrentFullScreenElement,document.mozFullScreenElement,document.msFullscreenElement].find((function(t){return void 0!==t}));return void 0!==n?!!n:t.webkitDisplayingFullscreen}function se(t,n){return["".concat(t,';codecs="').concat(n,'"'),"".concat(t,';codecs="').concat("avc1.42E01E,mp4a.40.2",'"')].find(MediaSource.isTypeSupported)||t}function ae(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t=parseFloat(t),isNaN(t))return 0;var i=Math.pow(10,n);return Math.round(t*i)/i}function he(t,n){return t&&t.tests&&t.tests[n]?t.tests[n]:null}function ce(t){return t&&"ML"===t.displayName}var TelecineError=function(t,n){this.name=t,this.message=n,Object.freeze(this)},fe=new x,de=function(){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=parseFloat(t);if(isNaN(i))throw new TypeError("Time must be a number.");if(i<0)throw new TypeError("Time must be a positive number.");this.time=t,this.data=n,this.id=ie();try{var e="undefined"==typeof VTTCue?TextTrackCue:VTTCue;this.vttCue=new e(t,t+.25,JSON.stringify(n)),this.vttCue.id=this.id}catch(t){throw new TelecineError("CuePointsNotSupported","Cue points are not supported in this browser.")}fe.set(this.vttCue,this),Object.freeze(this)}return t.fromVTTCue=function(n){if(fe.has(n))return fe.get(n);var i={};try{i=JSON.parse(n.text)}catch(t){}return new t(n.startTime,i)},t}();function ve(t,n,i){var e;try{document.removeChild({})}catch(r){e=Object.create(Object.getPrototypeOf(r),{name:{value:n,configurable:!0,writable:!0},code:{value:t,configurable:!0,writable:!0},message:{value:i,configurable:!0,writable:!0},toString:{value:function(){return"".concat(n,": DOM Exception ").concat(t)},configurable:!0,writable:!0}})}return Object.freeze(e)}var le=function(t,n){if(!t||void 0===t[n])throw ve(1,"INDEX_SIZE_ERR");return t[n]};function pe(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object.freeze(q({get length(){return t.length},start:function(n){return le(t,n)},end:function(t){return le(n,t)}},N.iterator,(function(){return Ji(t,n)})))}pe.from=function(t){if(!(t instanceof TimeRanges))throw new TypeError("Can only create a TelecineTimeRange from a TimeRanges object.");for(var n=[],i=[],e=0,r=t.length;e<r;e++)n.push(t.start(e)),i.push(t.end(e));return pe(n,i)};var ye=document.createElement("video"),we={"application/vnd.apple.mpegurl":"application/vnd.apple.mpegurl","video/mp4":'video/mp4; codecs="avc1.64001E"',"video/webm":'video/webm; codecs="vp8, vorbis"',"video/x-flv":'video/x-flv; codecs="vp6"'},me=function(){var t="undefined"==typeof TextTrack?{}:TextTrack;return{disabled:"DISABLED"in t?t.DISABLED:"disabled",hidden:"HIDDEN"in t?t.HIDDEN:"hidden",showing:"SHOWING"in t?t.SHOWING:"showing"}}(),be=function(){var t=document.createElement("track");return"track"in t&&"oncuechange"in t.track}(),ge=new x,Ee=function(){function t(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.B=t,this.V=i,this.q=null,this.W=null,this.G=[],et(this),this.on("play",(function(){return n.$()}));var e=t.querySelector("video");e||((e=document.createElement("video")).preload="none",this.B.appendChild(e)),e.setAttribute("tabindex","-1"),this.H=e,i.playRequest&&(this.Y=i.playRequest,this.Y.video=e),i.htmlScanner&&i.htmlScanner.controls&&(this.H.controls=!0),this.K=this.handleVideoEvent.bind(this),this.addVideoEventListeners(),this.X="none",this.J=!1,this.Z=!1,this.tt=-1}V(t,null,[{key:"displayName",get:function(){return"HTMLScanner"}},{key:"supported",get:function(){return t.supportedVideoTypes.length>0}},{key:"supportedVideoTypes",get:function(){var t=[];if("function"!=typeof ye.canPlayType)return t;for(var n in we){var i=we[n];xi.android&&"application/vnd.apple.mpegurl"===n||(xi.android&&!xi.mobileAndroid&&"video/mp4"===n&&xi.android instanceof String?parseInt(xi.android.split(".")[0],10)>3&&t.push(n):ye.canPlayType(i).replace(/^no$/,"")&&t.push(n))}return t}},{key:"supportedAudioTypes",get:function(){return[]}},{key:"supportedExternalDisplays",get:function(){return[AirPlayExternalDisplay]}},{key:"supportsSettingVolume",get:function(){if(xi.android||xi.iOS)return!1;var t=ye.volume;return ye.volume=.5*t,ye.volume!==t}},{key:"supportsTextTracks",get:function(){return void 0!==ye.textTracks&&ye.textTracks instanceof TextTrackList}},{key:"supportsPlaybackRate",get:function(){if(xi.android&&Xi.chrome&&Xi.chrome.major<52)return!1;var t=ye.playbackRate;ye.playbackRate=.5*t;var n=t!==ye.playbackRate;return ye.playbackRate=t,n}}]);var n=t.prototype;return n.deactivate=function(){this.q&&(this.q.off("filesrcupdate"),this.q.off("texttracksrcupdate")),this.removeVideoEventListeners(),this.removeSnapshot(),this.H.style.display="none"},n.reactivate=function(){this.addVideoEventListeners(),this.H.style.display=""},n.addVideoEventListeners=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.H;Object.keys(li).forEach((function(i){var e=li[i];n.addEventListener(e,t.K)}))},n.removeVideoEventListeners=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.H;Object.keys(li).forEach((function(i){var e=li[i];n.removeEventListener(e,t.K)}))},n.play=function(t){var n=this;return this.Y.start(t).catch((function(t){throw n.nt(t),t}))},n.nt=function(t){this.fire(li.ERROR,new TelecineError(t.name,t.message))},n.pause=function(){this.Y.cancel(),this.H.pause()},n.onpause=function(){},n.ontimeupdate=function(){this.tt=this.currentTime},n.addTextTrack=function(t){var n,i,e=this;t.src?((n=document.createElement("track")).kind=t.kind,n.src=t.src,n.id="telecine-track-".concat(t.id),n.srclang=t.language,n.label=t.label,this.H.appendChild(n),i=n.track):(i=this.H.addTextTrack(t.kind,t.label,t.language),this.it=this.it||{},this.it["telecine-track-".concat(t.id)]=i),i.addEventListener("cuechange",(function(){return t.dispatchEvent("cuechange")})),this.H.addEventListener("timeupdate",(function(){oe(e.H)&&(t.mode=i.mode)}));var r=function(){var n=Xi.iOS&&oe(e.H);!t.et||n?t.mode=i.mode:i.mode=me[t.mode]},u=[];if(n?n.addEventListener("load",r):r(),["loadeddata","seeking"].forEach((function(t){e.H.addEventListener(t,r),u.push([t,r])})),t.et&&(i.mode=me[t.mode]),!be){var o=[],s=function(){if(i&&"disabled"!==me[i.mode]){if(o.length!==i.activeCues.length)return t.dispatchEvent("cuechange"),void(o=H(i.activeCues));for(var n=0,e=i.activeCues.length;n<e;n++)if(i.activeCues[n].startTime!==o[n].startTime)return t.dispatchEvent("cuechange"),void(o=H(i.activeCues))}};this.H.addEventListener("timeupdate",s),u.push(["timeupdate",s])}return ge.set(t,u),i},n.removeTextTrack=function(t){var n=this,i=this.H.querySelector("#telecine-track-".concat(t.id));i&&this.H.removeChild(i);var e=ge.get(t);Array.isArray(e)&&e.forEach((function(t){var i=Z(t,2),e=i[0],r=i[1];n.H.removeEventListener(e,r)}))},n.getCuesForTrack=function(t){var n=this.getTrackById("telecine-track-".concat(t.id));return n?H(n.cues):[]},n.getActiveCuesForTrack=function(t){var n=this.getTrackById("telecine-track-".concat(t.id));return n?H(n.activeCues):[]},n.setModeForTrack=function(t,n){var i=this.getTrackById("telecine-track-".concat(t.id));return i&&i.mode!==me[n]&&(i.mode=me[n],be||"disabled"===n||t.dispatchEvent("cuechange")),this},n.setSrcForTrack=function(t,n){var i=this.H.querySelector("#telecine-track-".concat(t.id));return i&&null===i.track.cues&&(i.src=n),this},n.rt=function(t,n){var i,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.ut||(this.ut=this.H.addTextTrack("chapters"),this.ut.mode="hidden");var r=t.timecode,u=e?e.timecode:n,o=window.VTTCue||window.TextTrackCue;try{i=new o(r,u,t.title)}catch(t){throw new TelecineError("ChaptersNotSupported","Chapters are not supported in this browser.")}i.size=(u-r)/n,i.id=r,this.ut.addCue(i)},n.addChapter=function(t,n){var i=this.video.chapters,e={timecode:t,title:n};i.push(e),i.sort((function(t,n){return t.timecode-n.timecode}));var r=i[i.indexOf(e)+1];this.rt(e,this.video.duration,r),this.ot(this.ut,this.video.duration)},n.removeChapter=function(t){try{this.ut.removeCue(t)}catch(t){throw new TelecineError("ChaptersNotSupported","Chapters are not supported in this browser.")}var n=this.video.chapters.find((function(n){return n.timecode===t.timecode}));this.video.chapters.splice(n,1),this.ot(this.ut,this.video.duration)},n.ot=function(t,n){for(var i=0;i<t.cues.length;i++){var e=t.cues[i],r=t.cues[i+1],u=r?r.startTime:n;e.endTime=u,e.size=(u-e.startTime)/n}this.fire(wi.CHAPTER_CUES_UPDATED)},n.addChapters=function(t,n){var i=this;0!==t.length&&n&&(t=t.filter((function(t){return i.st(t,n)}))).sort((function(t,n){return t.timecode-n.timecode})).forEach((function(e,r){return i.rt(e,n,t[r+1])}))},n.addCuePoint=function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.at||(this.at=this.H.addTextTrack("metadata"),this.at.mode="hidden",this.at.addEventListener("cuechange",(function(t){H(t.target.activeCues).forEach((function(t){n.fire(wi.CUE_POINT,de.fromVTTCue(t))}))})),this.H.addEventListener("canplay",(function(t){n.at.mode="hidden"}))),t=parseFloat(t),isNaN(t))throw new TypeError("Time must be a number.");if(t<0||t>=this.duration)throw new TypeError("Time must be a positive number less than the duration of the video.");var e=new de(t,i);return this.at.addCue(e.vttCue),e},n.removeCuePoint=function(t){if(!t)throw new TelecineError("InvalidCuePoint","The specified cue point is not valid.");return this.at.removeCue(t.vttCue),!0},n.removeAllCuePoints=function(){var t=this;return this.at&&this.at.length&&H(this.at.cues).forEach((function(n){t.at.removeCue(n)})),!0},n.onerror=function(){if(!this.H.error)return!1;switch(this.H.error.code){case this.H.error.MEDIA_ERR_SRC_NOT_SUPPORTED:return this.ht("MediaSrcNotSupportedError","The media was not suitable."),this.ct(),!1;case this.H.error.MEDIA_ERR_DECODE:return-1!==this.tt&&xi.iOS?(this.H.load(),this.currentTime=this.tt,this.tt=-1,!1):(this.ht("MediaDecodeError","The media could not be decoded."),this.ct(),!1);case this.H.error.MEDIA_ERR_NETWORK:return this.ht("MediaNetworkError","A network error ocurred while fetching the media."),!1;case this.H.error.MEDIA_ERR_ABORTED:return this.ht("MediaAbortedError","The user agent aborted the fetching of the media."),!1;default:return this.ht("MediaUnknownError","An unknown error occurred."),!1}},n.ht=function(t,n){this.fire(li.ERROR,new TelecineError(t,n))},n.onended=function(){if(this.H.paused||this.H.pause(),this.currentTime<this.H.duration)return!1},n.onwaiting=function(){return!1},n.onwebkitbeginfullscreen=function(){this.Z=!0},n.onwebkitendfullscreen=function(){this.Z=!1},n.onwebkitpresentationmodechanged=function(){switch(this.H.webkitPresentationMode){case"picture-in-picture":this.H.controls=!0;break;case"inline":this.V.htmlScanner&&this.V.htmlScanner.controls||(this.H.controls=!1)}this.fire(wi.PRESENTATION_MODE_CHANGE,this.H.webkitPresentationMode)},n.shouldHandleVideoEvent=function(t){return!0},n.handleVideoEvent=function(t){t.target===this.H&&!1!==this.shouldHandleVideoEvent(t)&&("function"==typeof this["on".concat(t.type)]&&!1===this["on".concat(t.type)](t)||this.fire(t.type))},n.swapVideo=function(t,n){var i=t.paused;this.removeVideoEventListeners(t),t.parentElement.replaceChild(n,t),t.pause(),n.currentTime=t.currentTime,i||n.play(),this.addVideoEventListeners(n),this.H=n},n.onexternaldisplayactivated=function(t){this.J||(this.H!==t.element&&(this.ft=this.H,this.swapVideo(this.H,t.element)),this.J=!0)},n.onexternaldisplaydeactivated=function(t){this.J&&(this.ft&&(this.swapVideo(t.element,this.ft),this.ft=null),this.J=!1)},n.setVideoSrc=function(t){this.H.src=t},n.canSeekTo=function(t){var n=this.duration;if(n&&t>n&&(t=n),this.H.seekable.length>0)for(var i=0,e=this.H.seekable.length;i<e;i++)if(this.H.seekable.start(i)<=t&&this.H.seekable.end(i)>=t)return!0;return!1},n.seekToTime=function(t){var n=this;return this.canSeekTo(t)?(this.H.currentTime=t,P.resolve(this.H.currentTime)):new P((function(i,e){var r=function e(){n.canSeekTo(t)&&(Object.keys(li).forEach((function(t){var i=li[t];n.H.removeEventListener(i,e)})),n.H.currentTime=t,i(n.H.currentTime))};Object.keys(li).forEach((function(t){var i=li[t];n.H.addEventListener(i,r)}))}))},n.takeSnapshot=function(){var t=this.B.querySelector("[telecine-snapshot]");t||((t=document.createElement("canvas")).setAttribute("telecine-snapshot",""),this.B.appendChild(t)),t.setAttribute("width","".concat(this.B.clientWidth,"px")),t.setAttribute("height","".concat(this.B.clientHeight,"px")),t.style.display="";var n=ue(this.H.clientWidth,this.H.clientHeight,this.H.videoWidth,this.H.videoHeight),i=n.width,e=n.height,r=n.left,u=n.top;t.style.cssText="position:absolute;width:".concat(i,"px;height:").concat(e,"px;left:").concat(r,"px;top:").concat(u,"px");var o=t.getContext("2d");t.width>0&&t.height>0&&o.drawImage(this.H,0,0,t.width,t.height)},n.removeSnapshot=function(){var t=this.B.querySelector("[telecine-snapshot]");t&&(t.style.display="none")},n.getTrackById=function(t){if(this.it&&this.it[t])return this.it[t];if("function"==typeof this.H.textTracks.getTrackById)return this.H.textTracks.getTrackById(t);var n=document.getElementById(t);return n?n.track:null},n.initDrm=function(){var t=this.q.drmHandler;t&&t.init(this)},n.showExternalDisplayPicker=function(t){if(!this.G.length)throw new TelecineError("ExternalDisplayUnvailable","No external displays are available.");if(t){var n=this.G.filter((function(n){return n.constructor.displayName.replace("ExternalDisplay","")===t}))[0];if(!n)throw new TelecineError("InvalidExternalDisplay","The specified external display is not available.");n.showPicker()}else this.G[0].showPicker()},n.dt=function(){return this.vt.length<1?null:this.vt.slice(0).sort((function(t,n){return t.priority-n.priority}))[0]},n.lt=function(){var t=this.dt();t?this.currentFile=t:this.fire(wi.SCANNER_ERROR,{reason:"all files failed"})},n.st=function(t,n){return void 0!==t.timecode&&t.timecode>=0&&t.timecode<=n&&void 0!==t.title},n.ct=function(){var t=this.vt.indexOf(this.W);this.vt.splice(t,1),this.lt()},n.$=function(){var t=this;if("mediaSession"in navigator){var n={title:this.q.title,artist:this.q.subtitle,artwork:[]};this.q.metadata.thumbnail&&n.artwork.push({src:this.q.metadata.thumbnail}),navigator.mediaSession.metadata=new MediaMetadata(n),"function"==typeof navigator.mediaSession.setActionHandler&&(navigator.mediaSession.setActionHandler("play",(function(){t.play().then((function(){return t.fire(gi.MEDIASESSION_PLAY)})).catch(t.nt.bind(t))})),navigator.mediaSession.setActionHandler("pause",(function(){t.pause(),t.fire(gi.MEDIASESSION_PAUSE)})),navigator.mediaSession.setActionHandler("seekforward",(function(){t.currentTime=Math.min(t.duration,t.currentTime+10),t.fire(gi.MEDIASESSION_SEEK_FORWARD)})),navigator.mediaSession.setActionHandler("seekbackward",(function(){t.currentTime=Math.max(0,t.currentTime-10),t.fire(gi.MEDIASESSION_SEEK_BACKWARD)})))}},V(t,[{key:"chaptersTrack",get:function(){return this.ut}},{key:"manifest",get:function(){return this.pt}},{key:"buffered",get:function(){return pe.from(this.H.buffered)}},{key:"cuePoints",get:function(){return this.at?H(this.at.cues).map((function(t){return de.fromVTTCue(t)})):[]}},{key:"currentFile",get:function(){return this.W},set:function(n){var i=this,e=!this.H.paused,r=this.currentTime,u=!this.W||n.video.id!==this.W.video.id;if(u||this.takeSnapshot(),this.W=n,u&&(this.H.preload=this.X),this.constructor===t&&this.H.readyState>0&&(this.H.currentTime=0),(Xi.iOS||xi.android)&&this.W.video.title){var o=this.W.video.title;this.W.video.subtitle&&(o="".concat(o," ").concat(this.W.video.subtitle)),this.H.setAttribute("title",o)}else this.H.removeAttribute("title");this.setVideoSrc(this.W.src,u),this.fire(wi.CURRENT_FILE_CHANGE,n),Xi.iOS&&!u&&this.play().catch(this.nt.bind(this)),this.constructor!==t||u?e&&this.play().catch(this.nt.bind(this)):(this.seekToTime(r).then((function(t){return e&&i.play().catch(i.nt.bind(i)),t})).catch((function(){})),this.once("canplay",(function(){return i.removeSnapshot()})),this.once("playing",(function(){return i.removeSnapshot()})))}},{key:"currentTime",get:function(){return this.H.currentTime},set:function(t){this.seekToTime(t)}},{key:"duration",get:function(){return this.H.duration}},{key:"ended",get:function(){return this.H.ended}},{key:"externalDisplayAvailable",get:function(){return this.G.some((function(t){return t.available}))}},{key:"externalDisplayActive",get:function(){return this.G.some((function(t){return t.active}))}},{key:"loop",get:function(){return this.H.loop},set:function(t){this.H.loop=t}},{key:"isLowerProfileAvailable",get:function(){return null}},{key:"muted",get:function(){return this.H.muted},set:function(t){this.H.muted=t}},{key:"playsinline",get:function(){return this.H.playsinline},set:function(t){this.H.playsinline=t,t?this.H.setAttribute("playsinline",""):this.H.removeAttribute("playsinline")}},{key:"paused",get:function(){return this.H.paused}},{key:"defaultPlaybackRate",get:function(){return this.H.defaultPlaybackRate},set:function(t){this.H.defaultPlaybackRate=t}},{key:"playbackRate",get:function(){return this.H.playbackRate},set:function(t){this.H.playbackRate=t}},{key:"played",get:function(){return this.H.played}},{key:"seekable",get:function(){return this.H.seekable}},{key:"seeking",get:function(){return this.H.seeking}},{key:"preload",get:function(){return this.X},set:function(t){this.H.preload=t,this.X=t}},{key:"presentationMode",get:function(){return this.H.webkitPresentationMode?this.H.webkitPresentationMode:"inline"},set:function(t){if(-1===this.supportedPresentationModes.indexOf(t))throw new TelecineError("InvalidPresentationMode","The ".concat(t," presentation mode is not supported."));"function"==typeof this.H.webkitSetPresentationMode&&this.H.webkitSetPresentationMode(t)}},{key:"supportedPresentationModes",get:function(){var t=["inline"];return"function"==typeof this.H.webkitSupportsPresentationMode&&this.H.webkitSupportsPresentationMode("picture-in-picture")&&t.push("picture-in-picture"),t}},{key:"video",get:function(){return this.q},set:function(t){var n=this;if(this.reactivate(),this.q!==t){if(this.q&&(this.q.off("filesrcupdate"),this.q.off("texttracksrcupdate")),this.removeAllCuePoints(),this.q=t,this.vt=t.files.filter((function(t){return-1!==n.constructor.supportedVideoTypes.indexOf(t.mime)})),this.q.on("filesrcupdate",(function(t){t===n.W&&n.lt()})),this.q.on("texttracksrcupdate",(function(t){n.video.currentScanner&&n.video.currentScanner.setSrcForTrack(t,t.src)})),this.V.externalDisplays&&this.V.externalDisplays.length){this.G=[];var i=this.constructor.supportedExternalDisplays;Array.isArray(i)||(i=[]);var e=i.map((function(t){return t.displayName}));this.V.externalDisplays.filter((function(t){return t.supported&&-1!==e.indexOf(t.displayName)})).forEach((function(i){var e=new i(t),r=i.displayName.replace("ExternalDisplay","");e.on(li.LOADED_METADATA,(function(t){return n.fire(li.LOADED_METADATA,t)})),e.on("available",(function(){return n.fire(pi.AVAILABLE,{type:r})})),e.on("unavailable",(function(){return n.fire(pi.UNAVAILABLE,{type:r})})),e.on("activated",(function(){"function"==typeof n.onexternaldisplayactivated&&n.onexternaldisplayactivated(e),n.fire(pi.ACTIVATED,{type:r})})),e.on("deactivated",(function(){"function"==typeof n.onexternaldisplaydeactivated&&n.onexternaldisplaydeactivated(e),n.fire(pi.DEACTIVATED,{type:r})})),n.G.push(e)}))}this.lt(),Xi.iOS&&this.G.forEach((function(t){"AirPlay"===t.constructor.displayName&&(t.element=n.H)})),this.initDrm()}}},{key:"videoElement",get:function(){return this.H}},{key:"videoWidth",get:function(){return this.H.videoWidth}},{key:"videoHeight",get:function(){return this.H.videoHeight}},{key:"volume",get:function(){return this.H.volume},set:function(t){this.H.volume=t}},{key:"readyState",get:function(){return this.H.readyState}}]),t}(),ke={};try{ke.Set=Set}catch(t){!function(t,n){var i=n(e.prototype,{size:{configurable:!0,get:function(){return this.yt.length}}});function e(t){n(this,{yt:{value:[]}}),t&&t.forEach(this.add,this)}function r(n,i){return-1<(t=n.yt.indexOf(i))}function u(t){return[t,t]}i.add=function(t){return r(this,t)||this.yt.push(t),this},i.clear=function(){var t=this.yt.length;this.yt.splice(0,t)},i.delete=function(n){return r(this,n)&&!!this.yt.splice(t,1)},i.entries=function(){return this.yt.map(u)},i.forEach=function(t,n){this.yt.forEach((function(i,e){t.call(n,i,i,this)}),this)},i.has=function(t){return r(this,t)},i.keys=i.values=function(){return this.yt.slice(0)},ke.Set=e}(0,Object.defineProperties)}var _e=ke.Set,Te={method:"GET",async:!0,retry:0,throwHttpErrors:!0,headers:{},hooks:{beforeRequest:[],beforeRetry:[],afterResponse:[]},validateStatus:function(t){return t>=200&&t<300},retryStatus:function(t){return[408,413,429].includes(t)||t>=500&&t<600}};function Ae(t,n){var i=this;this.headers={},this.perfTimings={},ct(this,n),this.ok=2==(this.status/100|0),this.body=t,this.text=function(){return P.resolve(t)},this.json=function(){return P.resolve(JSON.parse(t))},this.blob=function(){return P.resolve(new Blob([t]))},this.arrayBuffer=function(){return P.resolve(t)},this.clone=function(){return new Ae(t,i)}}var Se=function(t){function n(){var n;return(n=t.call(this,"The operation was aborted.")||this).name="AbortError",n}return $(n,t),n}(J(Error)),Re=function(t){function n(n){var i;return(i=t.call(this,n.statusText)||this).name="HTTPError",i.response=n,i}return $(n,t),n}(J(Error)),Oe=function(t){function n(){var n;return(n=t.call(this,"A network error occurred.")||this).name="NetworkError",n}return $(n,t),n}(J(Error)),je=function(t){function n(n){var i;return(i=t.call(this,"Request timed out.")||this).name="TimeoutError",i.timeoutMs=n,i}return $(n,t),n}(J(Error));function Me(){}function Ie(t,n,i){if(!t.s){if(i instanceof Ne){if(!i.s)return void(i.o=Ie.bind(null,t,n));1&n&&(n=i.s),i=i.v}if(i&&i.then)return void i.then(Ie.bind(null,t,n),Ie.bind(null,t,2));t.s=n,t.v=i;var e=t.o;e&&e(t)}}var Ne=function(){function t(){}return t.prototype.then=function(n,i){var e=new t,r=this.s;if(r){var u=1&r?n:i;if(u){try{Ie(e,1,u(this.v))}catch(t){Ie(e,2,t)}return e}return this}return this.o=function(t){try{var r=t.v;1&t.s?Ie(e,1,n?n(r):r):i?Ie(e,1,i(r)):Ie(e,2,r)}catch(t){Ie(e,2,t)}},e},t}();function De(t){return t instanceof Ne&&1&t.s}function Pe(t){var n=function(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return P.resolve(t.apply(this,n))}catch(t){return P.reject(t)}}}((function(e){return function(t,n){try{var i=t()}catch(t){return n(t)}return i&&i.then?i.then(void 0,n):i}(e,(function(r){var u=!1;i++;var o=function(n){if(!t.retryAbortErrors&&n instanceof Se)return 0;if(n instanceof je)return 0;if(i>=t.retry)return 0;if(n instanceof Re){if(!t.retryStatus(n.response.status))return 0;var e=n.response.headers["retry-after"];if(e&&t.retryStatus(n.response.status)){var r=Number(e);return isNaN(r)?r=Date.parse(e)-Date.now():r*=1e3,r}if(413===n.response.status)return 0}return.3*Math.pow(2,i-1)*1e3}(r);return function(s,a){var h=function(){if(0!==o&&i>0)return function(t,n,i){return t&&t.then||(t=P.resolve(t)),n?t.then(n):t}(function(t){return new P((function(n,i){return setTimeout(n,t)}))}(o),(function(){var o=t.hooks.beforeRetry||[];return function(t,n){return t&&t.then?t.then(n):n()}(function(t,n,i){var e,r,u=-1;return function i(o){try{for(;++u<t.length;)if((o=n(u))&&o.then){if(!De(o))return void o.then(i,r||(r=Ie.bind(null,e=new Ne,2)));o=o.v}e?Ie(e,1,o):e=o}catch(t){Ie(e||(e=new Ne),2,t)}}(),e}(o,(function(n){return function(t,n){return t&&t.then?t.then(Me):P.resolve()}((0,o[n])(t,r,i))})),(function(){return u=!0,n(e)}))}))}();return h&&h.then?h.then(a):a(h)}(0,(function(n){if(u)return n;if(t.throwHttpErrors)throw r}))}))})),i=0;return n}function Ce(t,n,i){return i?n?n(t):t:(t&&t.then||(t=P.resolve(t)),n?t.then(n):t)}function xe(t,n,i){if(!t.s){if(i instanceof Le){if(!i.s)return void(i.o=xe.bind(null,t,n));1&n&&(n=i.s),i=i.v}if(i&&i.then)return void i.then(xe.bind(null,t,n),xe.bind(null,t,2));t.s=n,t.v=i;var e=t.o;e&&e(t)}}var Le=function(){function t(){}return t.prototype.then=function(n,i){var e=new t,r=this.s;if(r){var u=1&r?n:i;if(u){try{xe(e,1,u(this.v))}catch(t){xe(e,2,t)}return e}return this}return this.o=function(t){try{var r=t.v;1&t.s?xe(e,1,n?n(r):r):i?xe(e,1,i(r)):xe(e,2,r)}catch(t){xe(e,2,t)}},e},t}();function Ue(t){return t instanceof Le&&1&t.s}function He(t,n,i){var e,r,u=-1;return function o(s){try{for(;++u<t.length&&(!i||!i());)if((s=n(u))&&s.then){if(!Ue(s))return void s.then(o,r||(r=xe.bind(null,e=new Le,2)));s=s.v}e?xe(e,1,s):e=s}catch(t){xe(e||(e=new Le),2,t)}}(),e}function Fe(t,n){return t&&t.then?t.then(n):n(t)}function Be(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return P.resolve(t.apply(this,n))}catch(t){return P.reject(t)}}}var Ve={json:"application/json",text:"text/plain",arrayBuffer:"*/*",blob:"*/*"},qe=["get"];function We(t,n){var i=Be((function(){var t=!1,i=!1,e=n.hooks.beforeRequest||[];return Fe(He(e,(function(r){return Ce((0,e[r])(n),(function(e){return e instanceof Ge?(n=e,void(i=!0)):e instanceof Ae?(t=!0,P.resolve(e).then($e(n))):void 0}))}),(function(){return i||t})),(function(i){return t?i:function(t){var n=t.url,i=t.method,e=t.body,r=t.onDownloadProgress;return new P((function(u,o){var s=new XMLHttpRequest;for(var a in s.open(i.toUpperCase(),n,t.async),t.timeout&&(s.timeout=t.timeout),s.onload=function(){if(0!==s.status||s.responseURL&&0===s.responseURL.indexOf("file:")){var t={};s.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(n,i,e){t[i]=t[i]?"".concat(t[i],",").concat(e):e}));var n={};if(window.performance&&void 0!==window.performance.getEntriesByType){var i=window.performance.getEntriesByType("resource");if(i.length){var e=i.filter((function(t){return t.name===s.responseURL})).sort((function(t,n){return t.connectStart-n.connectStart}));e.length&&(n=e[e.length-1].toJSON())}}u(new Ae(s.response,{headers:t,statusText:s.statusText,status:s.status,url:s.responseURL,perfTimings:n}))}},s.onabort=function(){o(new Se)},s.onerror=function(){o(new Oe)},s.ontimeout=function(){o(new je(t.timeout))},"function"==typeof r&&s.addEventListener("progress",r),t.headers)s.setRequestHeader(a,t.headers[a]);t.withCredentials&&(s.withCredentials=!0),t.responseType&&(s.responseType=t.responseType),t.abort=s.abort.bind(s),s.send(e||null)}))}(n).then($e(n))}))})),e=n=new Ge(t,n),r=e.method,u=e.json,o=e.jwt,s=e.searchParams;if(u&&(n.headers["Content-Type"]=Ve.json,n.body=JSON.stringify(u)),o&&(n.headers.Authorization="jwt ".concat(o)),s){var a=Z(n.url.split("?"),2),h=a[0],c=a[1];n.url=lt(h,G(G({},vt(c)),s))}var f=-1!==qe.indexOf(r.toLowerCase())?Pe(n)(i):i(),d=function(t){f[t]=Be((function(){return n.headers["Content-Type"]=Ve[t],Ce(f,(function(n){return n.clone()[t]()}))}))};for(var v in Ve)d(v);return function t(n,i){var e=n.then.bind(n);return Object.assign(n,{abort:i,then:function(){return t(e.apply(void 0,arguments),i)}})}(f,(function(){return n.abort()}))}function Ge(t,n){ct(this,Te,t="string"==typeof t?{url:t}:t,n)}function $e(t){var n=t.validateStatus,i=t.throwHttpErrors,e=t.hooks;return Be((function(r){var u=e.afterResponse||[];return Fe(He(u,(function(n){return Ce((0,u[n])(t,r.clone()),(function(t){t instanceof Ae&&(r=t)}))})),(function(){if(!n||n(r.status))return r;if(i)throw new Re(r);return r}))}))}["get","post","put","patch","head","delete"].forEach((function(t){return We[t]=function(n,i){return We(n,G({method:t},i))},We[t]}));function Ye(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===t.length)return 0;for(var i=0,e=0,r=0;r<t.length;r++){var u=n[r]||1;e+=u,i+=t[r]*u}return i/e}function ze(t){if(0===t.length)return 0;for(var n=0,i=0;i<t.length;i++)n+=1/t[i];return t.length/n}function Ke(t,n){if(t.sort(),0===t.length)return 0;if(n<=0)return t[0];if(n>=1)return t[t.length-1];var i=t.length*n,e=Math.floor(i),r=e+1,u=i%1;return r>=t.length?t[e]:t[e]*(1-u)+t[r]*u}function Xe(t){t.sort((function(t,n){return t-n}));var n=Math.floor(t.length/2);return t.length%2?t[n]:(t[n-1]+t[n])/2}function Je(){return"undefined"!=typeof performance?performance.now():Date.now()}var Qe=function(t){function n(){return t.apply(this,arguments)||this}return $(n,t),n}(J(Error));function Ze(){}var tr=[],nr=[],ir=[];function er(t,n,i){return i?n?n(t):t:(t&&t.then||(t=P.resolve(t)),n?t.then(n):t)}var rr=[],ur=function(){function t(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.retryCount,i=void 0===n?3:n,e=t.parallel,r=void 0===e?1:e,u=t.includeWithSpeeds,o=void 0===u||u,s=t.timeout,a=void 0===s?0:s,h=t.retryAbortErrors,c=void 0===h||h;this.wt=[],this.bt=new _e,this.gt=new x,this.Et=i,this.kt=!1,this._t=!1,this.Tt=r,this.At=o,this.St=a,this.Rt=c,this.Ot()}t.getPercentileSpeed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.8,i=tr.slice(-t);return Ke(i,n)},t.getAverageSpeed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=tr.slice(-t);return Ye(i,n)},t.getHarmonicAverageSpeed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n=tr.slice(-t);return ze(n)},t.getVolatilityScaler=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n=tr.slice(-t);if(n.length<3)return null;var i=Ye(n,[]),e=Math.min.apply(Math,tt(n));return e/i},t.getMedianSpeed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n=tr.slice(-t);return Xe(n)},t.getResponseSpeeds=function(){return tr},t.getProgressSpeeds=function(){return rr},t.getFailedSegments=function(){return nr},t.getSuccessfulSegments=function(){return ir};var n=t.prototype;return n.add=function(t,n){var i=this;return new P((function(e,r){var u=i.jt(t,e,r);i.Mt(u,n),i.kt&&!i._t&&i.It()}))},n.start=function(){this.kt||(this.kt=!0,this.It())},n.stop=function(){this.kt=!1},n.abort=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=this.wt.filter((function(t){return!n||n===t.stream}));i.forEach((function(n){n.reject(new Qe("Stream manually aborted")),t.fire("downloadabort",n.identifier)})),this.wt=this.wt.filter((function(t){return n&&n!==t.stream})),this.bt.forEach((function(t){n&&n!==t.stream||t.request.abort()}))},n.Nt=function(t){for(var n=0;n<this.wt.length&&!(this.wt[n].priority>t.priority);n++);this.wt.splice(n,0,t)},n.Ot=function(){var t=this;this.Dt=new x,et(this),window.addEventListener("online",(function(){t.start(),t.Pt&&(t.Pt.resolve(),t.Pt=null)})),window.addEventListener("offline",(function(){t.stop(),t.abort(),t.Pt=new ft}))},n.Mt=function(t,n){t.hasOwnProperty("priority")?this.Nt(t):this.wt[n?"unshift":"push"](t)},n.It=function(){if(this.kt){this._t=!0;for(var t=this.Tt-this.bt.size,n=0;n<t;n++)this.Ct()}},n.jt=function(t,n,i){var e=t;return t.id&&(e=t.id),G(G({},t),{},{identifier:e,resolve:n,reject:i})},n.xt=function(){0!==this.bt.size||0!==this.wt.length?this.bt.size<this.Tt&&this.It():this._t=!1},n.Ct=function(){if(0!==this.wt.length){var t=this.wt.shift(),n=t.url,i=t.byteRange,e=t.isInitSegmentRequest,r=t.identifier,u=t.timeout,o={stream:t.stream,data:{url:n,isInitSegmentRequest:e,requestSendTime:Je(),uuid:([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(t){return(t^16*Math.random()>>t/4).toString(16)}))}},s=this.St,a=parseInt(u,10);a>=0&&(s=a);var h={url:n,type:"segment",responseType:"arraybuffer",retry:this.Et,hooks:{beforeRetry:[this.Lt.bind(this)]},onDownloadProgress:this.Ut(r,o),headers:i&&{Range:"bytes=".concat(i)},retryAbortErrors:this.Rt,timeout:s};this.fire("downloadstart",r),o.request=We(h).then(this.Ht(o,t)).catch(this.Ft(o,t)),this.bt.add(o)}else this._t=!1},n.Lt=function(){try{var t=this;return function(n){var i=function(){if(t.Pt)return function(t,n){return t&&t.then?t.then(Ze):P.resolve()}(t.Pt)}();if(i&&i.then)return i.then(Ze)}()}catch(t){return P.reject(t)}},n.Ut=function(t,n){var i=this,e=0,r=0,u=Je();return function(o){if(o.lengthComputable){var s=8*(o.loaded-r),a=Je(),h=a-u,c={startTime:u,length:h,bitrate:s/(h/1e3),index:e};e>0&&(rr.length>=100&&rr.shift(),rr.push(c)),u=a,r=o.loaded,e+=1,i.Dt.set(n,{bytesTotal:o.total,bytesLoaded:o.loaded,percent:o.loaded/o.total,identifier:t}),i.fire("progress",t)}}},n.Ht=function(t,n){var i=this,e=Je(),r=n.identifier,u=n.resolve;return function(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return P.resolve(t.apply(this,n))}catch(t){return P.reject(t)}}}((function(o){return er(o.arrayBuffer(),(function(s){return t.data.duration=Je()-t.data.requestSendTime,i.bt.delete(t),i.Dt.delete(t),i.Bt(n,e,s.byteLength),i.fire("downloadend",r,{request:t,response:o}),ir.push({url:t.data.url,status:200,duration:t.data.duration}),er(i.Vt(t,s),(function(t){u(s=t),i.xt()}))}))}))},n.Bt=function(t,n,i){var e=t.includeWithBandwidthChecks,r=(Je()-n)/1e3;if(i>8e3){var u=8*i/r;tr.length>100&&tr.shift(),this.At&&e&&tr.push(u)}},n.Vt=function(t,n){return t.data.url&&t.data.url.match(".ts$")?this.qt(t,n):P.resolve(new Uint8Array(n))},n.qt=function(t,n){try{var i=this;return function(t,n){var e=function(){if(!i.Wt)return er(ht("module/mux-mp4.js"),(function(t){i.Wt=new t({keepOriginalTimestamps:!0})}))}();return e&&e.then?e.then(n):n()}(0,(function(){return new P((function(e){i.Wt.on("data",(function(n){i.Wt.off("data");var r=new Uint8Array(n.initSegment.byteLength+n.data.byteLength);r.set(n.initSegment,0),r.set(n.data,n.initSegment.byteLength),e(t.data.isInitSegmentRequest?n.initSegment:r)})),i.Wt.push(new Uint8Array(n)),i.Wt.flush()}))}))}catch(t){return P.reject(t)}},n.Ft=function(t,n){var i=this,e=n.identifier,r=n.reject,u=n.size;return function(n){var o=Je()-t.data.requestSendTime;if(t.data.duration=o,n instanceof Se)nr.push({url:t.data.url,status:"abort",duration:o}),i.fire("downloadabort",e);else if(n instanceof Re)nr.push({url:t.data.url,status:n.response.status,duration:o}),i.fire("downloaderror",e,n.response.status);else if(n instanceof je){if(nr.push({url:t.data.url,status:"timeout",duration:o}),u>0&&n.timeoutMs>0){var s=8*u/(n.timeoutMs/1e3);s*=.5,tr.push(s)}i.fire("downloadtimeout",e,{timeoutMs:n.timeoutMs})}i.Dt.delete(t),i.bt.delete(t),r(n),i.xt()}},V(t,[{key:"parallel",get:function(){return this.Tt},set:function(t){this.Tt=t}},{key:"pendingFetches",get:function(){var t=this,n=[];return this.bt.forEach((function(i){if(t.Dt.get(i)){var e=t.Dt.get(i);e.elapsedTime=Je()-i.data.requestSendTime,n.push(e)}})),n}}]),t}(),or=function(){function t(t){et(this),this.Gt=t,this.$t=null,this.Yt=null,this.zt=!1,this.Kt=!0,this.Xt=null,this.Jt=[],this.Qt=[],this.Zt=!1,this.tn=null,this.nn=!1,this.in=void 0,this.rn=!1,this.un=!0,this.sn={},this.an=this.hn.bind(this),this.Gt.on("durationset",this.cn.bind(this))}var n=t.prototype;return n.addStream=function(t){var n=this;t.on("segmentadd",(function(){return n.fn()}));var i=this.Qt.push(t)-1;t.index=i,null===this.Yt&&(this.dn(i),this.zt=!0)},n.streamIndexAtTime=function(t){return this.sn[void 0]?{stream:this.activeStreamIndex}:this.sn[Math.floor(t/6)]},n.switchTo=function(t){var n=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=t;"object"===F(t)&&(e=t.index);var r=this.Yt!==e,u=r;if(!r&&this.zt&&(r=!0),r){this.zt=!1;var o=this.Yt,s=this.Qt[o];this.fire("streamchangestart",o,e),s&&u&&i&&s.abort(),this.vn=e,this.dn(e)}return this.fn(),new P((function(t){r?n.ln=function(){n.vn===e&&(n.ln=null,t(),n.fire("streamchange",e))}:t()}))},n.isTimeInBuffer=function(t){for(var n=0;n<this.$t.buffered.length;n++){var i=this.$t.buffered.start(n),e=this.$t.buffered.end(n);if(i<=t&&e>=t)return!0}return!1},n.hasAppendedFinalSegment=function(){return void 0!==this.in&&this.isTimeInBuffer(this.in)},n.clear=function(){this.Qt.forEach((function(t){return t.clear()}))},n.remove=function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.Gt.pn.duration;return new P((function(e,r){n.Jt.push([t,i,e]),n.fn()}))},n.removeEventListeners=function(){this.$t&&this.$t.removeEventListener("updateend",this.an)},n.cn=function(){var t=this.Gt.pn.duration,n=Math.floor(t/6);n+=6%t>1?1:0;for(var i=0;i<n;i++)this.sn[i]={stream:null,segment:i,type:"video"}},n.yn=function(){this.$t.addEventListener("updateend",this.an)},n.dn=function(t){this.Kt=!0,this.Yt=t,this.Gt.wn.streamIndex=t},n.hn=function(){this.mn(),this.bn(),this.fn()},n.mn=function(){if(this.nn&&this.endTime)return this.nn=!1,this.in=this.endTime,void this.Gt.checkEndOfStream();!this.activeStream.hasNextSegment()&&this.in>0&&"open"===this.Gt.pn.readyState&&this.Gt.checkEndOfStream()},n.bn=function(){this.Xt&&(this.fire("appendbufferend",this.Xt),this.Xt=null,this.ln&&this.ln())},n.fn=function(){if(this.$t){if(this.activeStream&&"closed"!==this.Gt.pn.readyState&&!this.$t.updating)if(this.Jt.length)this.gn();else if(!this.Zt&&!this.rn)return this.Kt?(this.Kt=!1,void this.En()):void this.kn()}else this.on("sourcebufferattach",this.fn)},n.gn=function(){var t=this,n=Z(this.Jt.shift(),3),i=n[0],e=n[1],r=n[2];this.$t.addEventListener("updateend",(function n(i){t.$t.removeEventListener("updateend",n),r(),clearTimeout(t.tn),t.tn=setTimeout((function(){t.Zt=!1,t.fn()}),5e3)})),this.$t.remove(i,e)},n.En=function(){var t=this;this.rn=!0,this.activeStream.getInitSegment().then((function(n){return t.Xt=null,t.$t.appendBuffer(n),t.rn=!1,n})).catch((function(n){t.Kt=!0,t.rn=!1}))},n.kn=function(){var t=this.activeStream.getNextSegment();if(null!==t){var n=this.activeStream.getIdForSegment(t);this.activeStream.isFinal(t)&&(this.nn=!0),this.Xt=n,this.fire("appendbufferstart",n);try{this.$t.appendBuffer(t),this.sn[n.segment]=n,this.un&&(this.un=!1,this.fire("initialbufferstart"))}catch(n){if("QuotaExceededError"===n.name){if(this.Zt=!0,this.fire("quotaexceedederror",this.$t.buffered),this.Gt.H.currentTime>6){var i=this.Gt.H.currentTime-6;this.Gt.removeBuffer(0,i)}this.activeStream._n.unshift(t)}}}},V(t,[{key:"streams",get:function(){return this.Qt}},{key:"activeStreamIndex",get:function(){return this.Yt}},{key:"activeStream",get:function(){return this.Qt[this.Yt]}},{key:"sourceBuffer",get:function(){return this.$t},set:function(t){this.$t=t,this.yn(),this.fire("sourcebufferattach")}},{key:"endTime",get:function(){var t=this.$t.buffered;if(t.length>0)return t.end(t.length-1)}}]),t}(),sr=function(){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ur;et(this),this._n=[],this.Tn=t,this.Kt=!0,this.An=NaN,this.Sn=n,this.Rn=i,this.Rn.start(),this.On=new x,this.jn={}}t.isValidSegmentUrl=function(t){return"string"==typeof t||"string"==typeof t.url&&"string"==typeof t.byteRange};var n=t.prototype;return n.getIdForSegment=function(n){return t.isValidSegmentUrl(n)?this.jn[n]:this.On.get(n).id},n.isFinal=function(t){return this.On.get(t).final},n.addSegment=function(n){var i=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.identifier,u=void 0===r?null:r,o=e.isFinalSegment,s=void 0!==o&&o,a=e.loadOnly,h=void 0!==a&&a,c=e.priority,f=void 0===c?0:c,d=e.includeWithBandwidthChecks,v=void 0===d||d,l=e.timeout,p=void 0===l?null:l,y=e.size,w=void 0===y?null:y;return this.Kt&&this.getInitSegment(),t.isValidSegmentUrl(n)?(this.jn[n]=u||n,this.fire("queued",this.getIdForSegment(n)),this.Rn.add({url:n.url||n,byteRange:n.byteRange,id:this.getIdForSegment(n),stream:this,includeWithBandwidthChecks:v,isInitSegmentRequest:!1,priority:f,timeout:p,size:w}).then((function(t){i.On.set(t,{id:u||n,final:s}),i._n.push(t),i.fire("bufferqueueadd",i.getIdForSegment(n)),h||i.fire("segmentadd")}))):(this.On.set(n,{id:u,final:s}),this._n.push(n),this.fire("bufferqueueadd",u),P.resolve())},n.clear=function(){this._n=[]},n.abort=function(){var t=this;this.getInitSegment().then((function(){t.Rn.abort(t)})).catch((function(t){}))},n.hasNextSegment=function(){return this._n.length>0},n.getNextSegment=function(){return 0===this._n.length?null:this._n.shift()},n.getInitSegment=function(){var n=this;this.Kt=!1;var i=this.Tn.url||this.Tn;return t.isValidSegmentUrl(i)?this.Rn.add({url:i,byteRange:this.Tn.byteRange,id:null,stream:this,isInitSegmentRequest:!0}).then((function(t){return n.Tn=t,n.Tn})):P.resolve(this.Tn)},V(t,[{key:"codec",get:function(){return this.Sn},set:function(t){this.Sn=t}},{key:"index",get:function(){return this.An},set:function(t){this.An=t}},{key:"pendingFetches",get:function(){return this.Rn.pendingFetches}}]),t}(),ar=function(){function t(t){this.H=t,this.kt=!1,this.Mn=null,this.In={},this.Nn={},this.Dn=0,this.Pn=0,this.Cn="default",this.bound={startCheckingDroppedFrames:this.xn.bind(this),stopCheckingDroppedFrames:this.Ln.bind(this)}}var n=t.prototype;return n.start=function(){return this.xn(),this},n.stop=function(){return this.Ln(),this},n.destroy=function(){this.Ln(),this.Un()},n.getDroppedFrameRate=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"average",e=this.In[n];if(!e)return 0;if(e.length<t)return 0;var r=e.slice(-t);return"median"===i?Xe(r):Ye(r)},n.getDroppedFrameTotal=function(){return{dropped:this.Hn(),total:this.Fn()}},n.yn=function(){this.H.addEventListener("playing",this.bound.startCheckingDroppedFrames),this.H.addEventListener("pause",this.bound.stopCheckingDroppedFrames),this.H.addEventListener("ended",this.bound.stopCheckingDroppedFrames)},n.Un=function(){this.H.removeEventListener("playing",this.bound.startCheckingDroppedFrames),this.H.removeEventListener("pause",this.bound.stopCheckingDroppedFrames),this.H.removeEventListener("ended",this.bound.stopCheckingDroppedFrames)},n.xn=function(){this.kt=!0,this.Bn()},n.Ln=function(){this.kt=!1},n.Bn=function(){var t=this;if(this.kt&&null!==this.Cn){clearTimeout(this.Mn);var n=this.Hn(),i=n-this.Dn;this.Dn=n;var e=this.Vn(),r=e-this.Pn;this.Pn=e,this.In[this.Cn]||(this.In[this.Cn]=[]),this.Nn[this.Cn]||(this.Nn[this.Cn]=[]),this.In[this.Cn].length>100&&this.In[this.Cn].shift(),this.Nn[this.Cn].length>100&&this.Nn[this.Cn].shift(),this.In[this.Cn].push(i),this.Nn[this.Cn].push(r),this.Mn=setTimeout((function(){t.Bn()}),1e3)}},n.Hn=function(){return"function"==typeof this.H.getVideoPlaybackQuality?this.H.getVideoPlaybackQuality().droppedVideoFrames:this.H.webkitDroppedFrameCount||0},n.Fn=function(){return"function"==typeof this.H.getVideoPlaybackQuality?this.H.getVideoPlaybackQuality().totalVideoFrames:this.H.webkitDecodedFrameCount||0},n.Vn=function(){if("function"==typeof this.H.getVideoPlaybackQuality){var t=this.H.getVideoPlaybackQuality();return t.totalVideoFrames-t.droppedVideoFrames-t.corruptedVideoFrames}return this.H.webkitDecodedFrameCount||0},V(t,[{key:"streamIndex",get:function(){return this.Cn},set:function(t){this.Cn=t}}]),t}(),hr=function(){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.H=t,this.V=n,et(this);var i=this.V,e=i.fetcherTimeout,r=void 0===e?0:e,u=i.fetcherRetryAbortErrors,o=void 0===u||u;this.wn=new ar(t),this.pn=new MediaSource,this.Rn=new ur({parallel:1,timeout:r,retryAbortErrors:o}),this.qn={},this.Wn=[],this.Gn=null,this.$n=this.Yn.bind(this),this.yn()}var n=t.prototype;return n.switchTo=function(t){return 1===this.Wn.length&&this.video.switchTo(t)},n.getCurrentSpeed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.type,i=void 0===n?"average":n,e=t.howMany,r=void 0===e?10:e,u=t.weights,o=void 0===u?[]:u,s=t.percentile,a=void 0===s?null:s;return"harmonicAverage"===i?ur.getHarmonicAverageSpeed(r):"average"===i?ur.getAverageSpeed(r,o):"median"===i?ur.getMedianSpeed(r):ur.getPercentileSpeed(r,a)},n.getVolatilityScaler=function(t){return ur.getVolatilityScaler(t)},n.getResponseSpeeds=function(){return ur.getResponseSpeeds()},n.getFailedSegments=function(){return ur.getFailedSegments()},n.getSuccessfulSegments=function(){return ur.getSuccessfulSegments()},n.getDroppedFrameRate=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeStreamIndex,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"average";return this.wn.getDroppedFrameRate(t,n,i)},n.getDroppedFrameTotal=function(){return this.wn.getDroppedFrameTotal()},n.clear=function(){this.Wn.forEach((function(t){return t.clear()}))},n.streamIndexAtTime=function(t,n){return this.qn[n].streamIndexAtTime(t)?this.qn[n].streamIndexAtTime(t).stream:null},n.removeBuffer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.H.duration;if(t>=(n=n||0))return P.resolve();var i=this.Wn.map((function(i){return i.remove(t,n)}));return P.all(i)},n.addStream=function(t,n){var i=this,e=this.zn(t);if(!this.qn[e]){var r=new or(this,e);this.qn[e]=r,this.Wn.push(r),this.readyPromise.then((function(){var n;try{n=i.pn.addSourceBuffer(t)}catch(t){if(22!==t.code)return void i.fire("srcnotsupported",t);n=i.qn[e]}i.V.duration&&(n.appendWindowEnd=i.V.duration+.1),r.sourceBuffer=n})).catch((function(t){})),["appendbufferstart","appendbufferend","streamchange","streamchangestart","initialbufferstart","quotaexceedederror"].forEach((function(t){r.on(t,(function(n){i.fire(t,n)}))}))}var u=new sr(n,t,this.Rn);return["queued","bufferqueueadd"].forEach((function(t){u.on(t,(function(n){i.fire(t,n)}))})),this.qn[e].addStream(u),u},n.checkEndOfStream=function(){var t=this;this.Wn.every((function(t){return t.hasAppendedFinalSegment()}))&&this.H.addEventListener("timeupdate",(function n(){t.H.removeEventListener("timeupdate",n),t.Wn.every((function(n){return n.isTimeInBuffer(t.H.currentTime)}))&&t.endOfStream()}))},n.abortFetches=function(){this.Rn.abort()},n.endOfStream=function(){"open"===this.pn.readyState&&(this.Kn()||(this.pn.endOfStream(),this.fire("endofstream")))},n.destroy=function(){this.clear(),this.Xn(),this.off(),this.wn.destroy(),this.Rn.abort(),this.H.src&&(this.H.removeAttribute("src"),this.H.load())},n.yn=function(){var t=this;this.readyPromise=new P((function(n,i){t.Gn=n,t.pn.addEventListener("sourceopen",t.$n)})),["downloadstart","downloadend","downloadabort","downloaderror","downloadtimeout","progress"].forEach((function(n){t.Rn.on(n,(function(){for(var i=arguments.length,e=new Array(i),r=0;r<i;r++)e[r]=arguments[r];t.fire.apply(t,[n].concat(e))}))}))},n.Kn=function(){for(var t=0;t<this.pn.sourceBuffers.length;t++)if(this.pn.sourceBuffers[t].updating)return!0;return!1},n.Yn=function(){URL.revokeObjectURL(this.H.src),this.pn.removeEventListener("sourceopen",this.$n),this.V.duration&&(this.pn.duration=this.V.duration,this.fire("durationset")),this.Gn()},n.Xn=function(){this.Wn.forEach((function(t){return t.removeEventListeners()}))},n.zn=function(t){return 0===t.indexOf("audio")?"audio":"video"},V(t,[{key:"mediaSource",get:function(){return this.pn}},{key:"pendingFetches",get:function(){return this.Rn.pendingFetches}},{key:"streams",get:function(){return 1===this.Wn.length&&this.video.streams}},{key:"activeStreamIndex",get:function(){return 1===this.Wn.length&&this.video.activeStreamIndex}},{key:"video",get:function(){return!!this.qn.video&&this.qn.video}},{key:"audio",get:function(){return!!this.qn.audio&&this.qn.audio}}]),t}(),cr=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n)||this).V=e,i.blacklisted=[],i.whitelisted=[],i.MAX_LOADABLE_SEGMENTS_AUTO=3,i.MAX_LOADABLE_SEGMENTS_LOCKED=15,i.SEGMENT_DURATION=6,i}$(n,t),V(n,[{key:"displayName",get:function(){return"MediaSource"}}]);var i=n.prototype;return i.isTimeInBuffer=function(t,n,i){return this.Jn(t,t,n,i,1)},i.getDistanceFromBuffer=function(t,n){for(var i=t,e=0;e<n.length;e++)if(n.start(e)<=t&&n.end(e)>=t){i=n.end(e);break}return i-t},i.blacklist=function(t){this.blacklisted[t]=1},i.lock=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.whitelisted=t},i.filterStreams=function(t,n,i){for(var e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=[],o=!1,s=0;s<t.length;s++)if(e&&e[0]===t[s].width&&e[1]===t[s].height)u.push(t[s]);else{if(o)break;if(!(this.blacklisted[s]&&-1===this.whitelisted.indexOf(s)||this.whitelisted.length&&-1===this.whitelisted.indexOf(s)))if(this.whitelisted.length)u.push(t[s]);else{var a=this.Qn(n,i,t[s].width,t[s].height,r),h=1e3/(window.devicePixelRatio||1),c=i<h?1.75:1;a>=c&&(o=!0),u.push(t[s]),e=[t[s].width,t[s].height]}}return u},i.getCurrentSpeed=function(){var t="average",n=3,i=[1,2,5];return this.V.tests&&this.V.tests.harmonic_average&&this.V.tests.harmonic_average.group&&(t="harmonicAverage",n=this.Zn(),i=[]),this.scanner.sorcerer.getCurrentSpeed({type:t,howMany:n,weights:i})},i.getAudioIndexFromVideo=function(t,n,i){if(0===n.length)return!1;if(!t[i])return 0;for(var e=0;e<n.length;e++){if(n[e].bitrate<8e4&&t[i].bitrate<5e5)return e;if(n[e].bitrate>144e3&&t[i].bitrate>1e6)return e}return 0},i.ti=function(t,n,i,e){var r=i/e,u=t-n*r,o=n-t/r,s=t-u,a=n-o;return u>0&&(a=n),o>0&&(s=t),[s,a]},i.Qn=function(t,n,i,e){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=this.ti(t,n,i,e),o=i*e;r&&(o*=r);var s=window.devicePixelRatio||1,a=u[0]*u[1]*s*s;return o/a},i.Zn=function(){var t=he(this.V,"lookahead_count");return t&&t.group&&t.data.count?t.data.count:t&&t.data.segment_lookahead_count?t.data.segment_lookahead_count:this.MAX_LOADABLE_SEGMENTS_AUTO},i.ni=function(t,n,i){var e=i&&i.bitrate>11e6;return 1===this.whitelisted.length?e?30:this.MAX_LOADABLE_SEGMENTS_LOCKED*this.SEGMENT_DURATION:this.Zn()*this.SEGMENT_DURATION},i.Jn=function(t,n,i,e){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!i)return!1;n=Math.min(n,e);for(var u=0;u<i.length;u++){var o=ae(i.start(u))-r,s=ae(i.end(u))+r;if(o<=t&&s>=n)return!0}return!1},i.ii=function(t){return t.video.length>0&&t.audio.length>0},i.ei=function(t,n,i,e){var r=1;return this.ii(e)&&(r=.05),this.Jn(t.start,t.end,n,i,r)},n}(function(){function t(t){this.scanner=t}V(t,[{key:"displayName",get:function(){return"Brain"}}]);var n=t.prototype;return n.destroy=function(){},n.shouldPowerUp=function(t,n){return!1},n.shouldPowerDown=function(t,n){return!1},n.canPowerUp=function(t,n){return 1!==t.length&&n<t.length-1},n.canPowerDown=function(t,n){return 1!==t.length&&n>0},n.filterStreams=function(t){return t},t}()),fr=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).BANDWIDTH_UPSWITCH_THRESHOLD=.85,i.BANDWIDTH_DOWNSWITCH_THRESHOLD=.9,i}$(n,t),V(n,[{key:"displayName",get:function(){return"Skyfire"}}]);var i=n.prototype;return i.shouldPowerUp=function(t,n,i){i&&this.V.startingBandwidthThreshold&&(this.BANDWIDTH_UPSWITCH_THRESHOLD=this.V.startingBandwidthThreshold);var e=t.indexOf(n);if(-1===e&&(e=0),!this.canPowerUp(t,e))return P.resolve(!1);var r=this.getCurrentSpeed();if(!r)return P.resolve(!1);var u=this.ri(r,this.BANDWIDTH_UPSWITCH_THRESHOLD,t);return u===e||!i&&u>e&&dt(this.scanner.currentTime,this.scanner.H.buffered)<1.5*this.SEGMENT_DURATION?P.resolve(!1):P.resolve(u)},i.shouldPowerDown=function(t,n){var i=t.indexOf(n);if(-1===i){var e=this.isTimeInBuffer(this.scanner.H.duration,this.scanner.H.buffered,this.scanner.H.duration);return this.whitelisted.length||this.blacklisted.length||!e?P.resolve(t.length-1):P.resolve(!1)}if(!this.canPowerDown(t,i))return P.resolve(!1);var r=this.getCurrentSpeed();if(!r)return P.resolve(!1);if(this.hasTooManyDroppedFrames(i,n,this.V.droppedFrameSwitchPercent))return P.resolve(i-1);var u=this.ri(r,this.BANDWIDTH_DOWNSWITCH_THRESHOLD,t);return u===i?P.resolve(!1):P.resolve(u)},i.hasTooManyDroppedFrames=function(t,n,i){return this.scanner.sorcerer.getDroppedFrameRate(10,t,"median")/n.framerate*100>=i&&(this.blacklist(t),!0)},i.getTimeEstimateToLoad=function(t,n){if(null===n)return 3;var i=n.segments[t],e=i.end-i.start,r=this.getCurrentSpeed();return e*(n.bitrate+n.audioBitrate)/r*1.3},i.canPlayFromTimeInStream=function(t,n){if(!this.isTimeInBuffer(t,this.scanner.H.buffered,this.scanner.H.duration))return!1;if(!n)return!1;var i=this.getSegmentsToLoad(!1,"video",n);if(0===i.length)return!0;var e=dt(t,this.scanner.H.buffered);return this.getTimeEstimateToLoad(i[0],n)<e},i.getSegmentsToLoad=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video",i=arguments.length>2?arguments[2]:void 0,e=this.scanner.H,r=this.scanner.currentTime,u=[],o=this.ni(r,e.duration,i),s=r+o,a=this.scanner.sorcerer[n].activeStreamIndex,h=this.scanner.Qt[n][a];if(!h)return u;var c=this.scanner.sorcerer[n].sourceBuffer,f=null;c&&(f=c.buffered);for(var d=0;d<h.segments.length;d++){var v=h.segments[d];if(!(v.end<r||v.start>s)){var l=r>=v.start&&r<v.end,p=this.ei(v,f,this.scanner.H.duration,this.scanner.Qt);!t&&p||t&&p&&l||(l||s>=v.start)&&u.push(d)}}return u},i.ri=function(t,n,i){for(var e=0,r=e;r<i.length;r++)t*n>i[r].bitrate+i[r].audioBitrate&&(e=r);return e},n}(cr),dr=function(t){function n(n){var i,e,r,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(r=t.call(this,n,u)||this).ui=u.tests.ml_brain.data.mimir_url,r.oi=u.tests.ml_brain.data.geolocation,r.si={},r.ai=null,r.hi=[],r.ci=[],r.fi=[],r.di=[],r.vi=[],r.li=[],r.pi=[],r.yi=[],r.wi=null,r.mi=null,r.bi=null,r.gi=!1,r.Ei=!1,r.ki=0,r._i=[],r.Ti=0,r.Ai=[[wi.DOWNLOAD_START,r.Si.bind(Q(r))],[wi.DOWNLOAD_END,r.Ri.bind(Q(r))],[wi.APPEND_BUFFER_END,r.Oi.bind(Q(r))],[wi.DOWNLOAD_TIMEOUT,r.ji.bind(Q(r))]],r.Mi=[r.Ii],r.Ni=[r.Di],r.Ai.forEach((function(t){r.scanner.on(t[0],t[1])})),(i=Te.hooks.beforeRequest).push.apply(i,tt(r.Mi)),(e=Te.hooks.afterResponse).push.apply(e,tt(r.Ni)),r}$(n,t),V(n,[{key:"displayName",get:function(){return"ML"}}]);var i=n.prototype;return i.destroy=function(){var t=this;this.Ai.forEach((function(n){t.scanner.off(n[0],n[1])})),this.Mi.forEach((function(t){var n=Te.hooks.beforeRequest,i=n.indexOf(t);i>=0&&n.splice(i,1)})),this.Ni.forEach((function(t){var n=Te.hooks.afterResponse,i=n.indexOf(t);i>=0&&n.splice(i,1)}))},i.Si=function(t){var n=t.identifier;"video"===n.type&&(this.mi={index:n.segment,streamIndex:n.stream,complete:null}),"audio"===n.type&&(this.bi={index:n.segment,streamIndex:n.stream,complete:null})},i.Pi=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video";return"video"===n?null!==this.mi&&this.mi.index===t.segment&&this.mi.streamIndex===t.stream:"audio"===n&&null!==this.bi&&this.bi.index===t.segment},i.Ci=function(){return null!==this.mi||null!==this.bi},i.Ri=function(t){var n=t.identifier,i=t.data,e=i.request,r=i.response,u=e.data.duration/1e3,o=r.body.byteLength,s=null;r.perfTimings&&(s=r.perfTimings.responseStart-r.perfTimings.connectStart),"video"===n.type&&this.Pi(n,"video")&&(this.mi.complete={downloadTime:u,byteLength:o,ttfb:s,uuid:e.data.uuid},this.Ei||(this.xi(n.stream,n.segment-1,u,o,s),this.Ei=!0)),"audio"===n.type&&this.Pi(n,"audio")&&(this.bi.complete={downloadTime:u,byteLength:o,ttfb:s,uuid:e.data.uuid})},i.ji=function(t){var n=t.identifier,i=(t.data.timeoutMs||8e3)/1e3,e=n.segment,r=this.scanner.Qt[n.type][n.stream].segments[e].size;delete this.si[e],this.xi(n.stream,e,i,r,.1,void 0)},i.Li=function(){this.mi=null,this.bi=null},i.Oi=function(t){var n=t.identifier;if("video"===n.type&&(this.Ti+=1),this.ii(this.scanner.Qt)){if(this.Pi(n,"video")&&this.Pi(n,"audio")&&null!==this.mi.complete&&null!==this.bi.complete){var i=this.mi.complete,e=this.bi.complete,r=i.downloadTime+e.downloadTime,u=i.byteLength+e.byteLength,o=i.ttfb+e.ttfb;this.xi(n.stream,n.segment-1,r,u,o,i.uuid),this.Li()}}else if(this.Pi(n,"video")&&null!==this.mi.complete){var s=this.mi.complete;this.xi(n.stream,n.segment-1,s.downloadTime,s.byteLength,s.ttfb,s.uuid),this.Li()}},i.xi=function(t,n,i,e,r,u){var o=this.scanner.Qt.video[t],s=this.scanner.sorcerer.video.sourceBuffer;s&&o&&(this.hi.push(this.getTotalBufferDuration()),this.di.push(dt(this.scanner.currentTime,s.buffered)),this.vi.push(t),this.ci.push(i),this.fi.push(e),this.pi.push(r),this.li.push(o.segments.length-n),this.yi.push(u))},i.handleScrubEnd=function(t){var n=this.ci.length,i=n?this.ci[n-1]:0,e=this.fi.length,r=e?this.fi[e-1]:0,u=this.pi.length,o=u?this.pi[u-1]:0,s=this.scanner.Qt.video[t],a=this.Ui(s),h=a?a.index:this.li[this.li.length-1],c=this.yi.length?this.yi[this.yi.length-1]:"";this.xi(t,h,i,r,o,c)},i.shouldPowerUp=function(t,n,i){var e=t.indexOf(n);if(-1===e&&(e=0),1===this.whitelisted.length)return this.whitelisted[0]>e?P.resolve(0):P.resolve(!1);if(1===this.scanner.Qt.video.length)return P.resolve(!1);if(!this.canPowerUp(t,e))return P.resolve(!1);if(this.scrubInProgress)return P.resolve(!1);var r=this.Ui(n);if(null===r)return P.resolve(!1);var u={index:r.index,streamIndex:r.streamIndex},o=r.index;if(null!==this.ai&&this.ai.index===u.index&&this.ai.streamIndex===u.streamIndex)return P.resolve(!1);if(!(o in this.si))return this.Hi(u,t,n).then((function(t){return t>e&&t})).catch(console.error);var s=this.si[o];return s>e?P.resolve(s):P.resolve(!1)},i.shouldPowerDown=function(t,n){var i=t.indexOf(n);if(-1===i){var e=this.isTimeInBuffer(this.scanner.H.duration,this.scanner.H.buffered,this.scanner.H.duration);return this.whitelisted.length||this.blacklisted.length||!e?P.resolve(t.length-1):P.resolve(!1)}if(1===this.whitelisted.length)return this.whitelisted[0]<i?P.resolve(0):P.resolve(!1);if(1===this.scanner.Qt.video.length)return P.resolve(!1);if(!this.canPowerDown(t,i))return P.resolve(!1);if(this.scrubInProgress)return P.resolve(!1);var r=this.Ui(n);if(null===r)return P.resolve(!1);var u={index:r.index,streamIndex:r.streamIndex},o=r.index;if(null!==this.ai&&this.ai.index===u.index&&this.ai.streamIndex===u.streamIndex)return P.resolve(!1);if(!(o in this.si))return this.Hi(u,t,n).then((function(t){return t<i&&t})).catch(console.error);var s=this.si[o];return s<i?P.resolve(s):P.resolve(!1)},i.getTotalBufferDuration=function(){var t=this.scanner.sorcerer.video.sourceBuffer,n=0;if(!t)return n;for(var i=0;i<t.buffered.length;i++){var e=t.buffered.start(i);n+=t.buffered.end(i)-e}return n},i.canPlayFromTimeInStream=function(t,n){return!!this.isTimeInBuffer(t,this.scanner.H.buffered,this.scanner.H.duration)&&!!n},i.Fi=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=t.slice(0);if(i.length<8){for(var e=8-i.length,r=0;r<e;r++)i.unshift(n);return i}return i.slice(i.length-8,i.length)},i.Bi=function(t,n){var i=this,e={240:1,360:2,480:3,540:3,720:4,1080:5,1440:6,2160:7},r={240:0,360:1,480:2,540:2,720:3,1080:4,1440:5,2160:6},u=[0,0,0,0,0,0,0,0],o=[0,0,0,0,0,0,0,0],s=[0,0,0,0,0,0,0,0];this.Ti<3&&(s[s.length-1]=1);for(var a=0;a<n.length;a++){var h=n[a],c=parseInt(h.quality,10);c in e&&(u[e[c]]=1);var f=this.getAudioIndexFromVideo(n,this._i,a),d=null;"number"==typeof f&&(d=this._i[f]);for(var v=0;v<h.segments.length;v++)if(v===t&&c in r){var l=h.segments[v].size,p=0;d&&d.segments[v]&&(p=d.segments[v].size),o[r[c]]=l+p}}var y=this.vi.map((function(t){return parseInt(i.scanner.Qt.video[t].quality,10)}));return{availableQualities:u,nextChunkSizes:o,lastBufferSizes:this.Fi(this.hi),lastChunkDownloadTimes:this.Fi(this.ci),lastTtfb:this.Fi(this.pi,.1),lastChunkSizes:this.Fi(this.fi),lastChunkQualities:this.Fi(y),numRemainingChunks:this.Fi(this.li),lastPlaybackHeads:this.Fi(this.di),geolocation:[[this.oi]],videoStart:s}},i.Vi=function(t,n){for(var i=-1,e=-1,r=0;r<t.length;r++)t[r]>e&&(e=t[r],i=r);for(var u=[],o=0;o<n.length;o++)1===n[o]&&u.push(o);return{1:240,2:360,3:540,4:720,5:1080,6:1440,7:2160}[u[i]]},i.qi=function(t,n){for(var i=0;i<n.length;i++){var e=parseInt(n[i].quality,10);if(e===t)return i;if(480===e&&540===t)return i}return 0},i.Ii=function(t){t.startTime=te()},i.Di=function(t,n){return n.duration=ne(t.startTime),n},i.Hi=function(t,n,i){var e=this,r=this.Bi(t.index,n);return this.ai=t,We.post(this.ui,{json:{inputs:r},timeout:2e3}).then((function(i){var u=JSON.parse(i.body),o=e.Vi(u.outputs[0],r.availableQualities),s=e.qi(o,n);if(e.si[t.index]=s,e.yi.length&&e.wi){var a=e.yi[e.yi.length-1];e.scanner.fire(Ei.BRAIN_ML_MODEL_INPUTS,G({chunkRequestID:a,duration:i.duration,geolocation:e.oi},e.wi))}return e.wi=r,e.ai=null,s})).catch((function(n){if(n instanceof Re){var i={status:n.response.status,resp:n.response.body,url:e.ui};e.scanner.fire(Ei.BRAIN_ML_MODEL_ERR,i),e.ki++}if(n instanceof je){var r={url:e.ui};e.scanner.fire(Ei.BRAIN_ML_MODEL_TIMEOUT,r),e.ki++}if(n instanceof Oe){var u={url:e.ui};e.scanner.fire(Ei.BRAIN_ML_MODEL_NET_ERR,u),e.ki++}e.ki>=2&&e.scanner.resetBrain(!0);var o=t.streamIndex;return e.si[t.index]=o,e.ai=null,o}))},i.Ui=function(t){var n=this.scanner.sorcerer.video.sourceBuffer,i=null;if(n&&(i=n.buffered),null===i)return null;for(var e=this.Wi(t),r=0;r<e.length;r++){var u=e[r].segment;if(!this.ei(u,i,this.scanner.H.duration,this.scanner.Qt))return e[r]}return null},i.Wi=function(t){var n=this.scanner.H,i=this.scanner.currentTime,e=i+this.ni(i,n.duration,t),r=[],u=this.scanner.sorcerer.video.activeStreamIndex,o=this.scanner.Qt.video[u];if(!o)return r;for(var s=0;s<o.segments.length;s++){var a=o.segments[s];a.end<i||a.start>e||(i>=a.start&&i<a.end||e>=a.start)&&r.push({segment:a,index:s,streamIndex:u})}return r},i.Gi=function(t,n){var i=this;Object.keys(this.si).filter((function(n){return-1===t.indexOf(parseInt(n,10))})).forEach((function(t){var e=i.si[t],r=i.scanner.Qt.video[e].segments[t];i.ei(r,n,i.scanner.H.duration,i.scanner.Qt)||delete i.si[t]}))},i.getSegmentsToLoad=function(t,n,i){var e=this.Wi(i),r=this.scanner.sorcerer[n].sourceBuffer,u=null;r&&(u=r.buffered),this.Gi(e.map((function(t){return t.index})),u);for(var o=[],s=0;s<e.length;s++){var a=e[s].segment,h=e[s].index,c=this.ei(a,u,this.scanner.H.duration,this.scanner.Qt),f=h in this.si;c||!f&&1!==this.whitelisted.length&&1!==this.scanner.Qt.video.length||o.push(h)}return o},V(n,[{key:"audioStreams",set:function(t){this._i=t}},{key:"scrubInProgress",set:function(t){this.gi=t},get:function(){return this.gi}}]),n}(cr),vr=function(){function t(t,n){this.H=t,this.$i=n}var n=t.prototype;return n.start=function(){return clearInterval(this.Yi),this.Yi=setInterval(this.zi.bind(this),200),this.zi()},n.stop=function(){clearInterval(this.Yi)},n.onSegmentAppended=function(){this.zi()},n.zi=function(){var t=this.H.buffered,n=this.H.currentTime,i=this.Ki(t,n);if(0===this.H.readyState)return!1;if(this.H.paused)return!1;var e=this.H.duration;if(n>=e)return this.H.currentTime=e-.1,!0;if(t.length<=i)return!1;var r=t.start(i);return!(r>=e||r-n>.5||0!==i||(this.stop(),this.Xi("audio",r),this.Xi("video",r),this.H.currentTime=r,0))},n.Ki=function(t,n){if(!t||!t.length)return null;for(var i=0;i<t.length;i++){var e=t.start(i),r=t.end(i);if(e>n&&(0===i||r-n<=.1))break}return i>=0?i:null},n.Xi=function(t,n){var i=this.$i(0,t);i&&i.segments&&i.segments[0]&&(i.segments[0].start=n)},t}(),lr=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).reset(),i.manifestLoadDurations=[],e.mediaSourceScanner&&(i.Ji=e.mediaSourceScanner.maxPreloadStreamIndex),i}$(n,t),V(n,null,[{key:"displayName",get:function(){return"MediaSourceScanner"}},{key:"supported",get:function(){return"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported}},{key:"supportedVideoTypes",get:function(){return["application/vnd.vimeo.dash+json","video/vnd.mpeg.dash.mpd"]}}]);var i=n.prototype;return i.deactivate=function(){t.prototype.deactivate.call(this),this.sorcerer&&this.sorcerer.destroy(),this.reset()},i.reset=function(){this.Qi=new _e,this.Zi={},xi.browser.safari&&(this.te=new vr(this.H,this.$i.bind(this))),this.resetBrain(),this.ne=!1,this.ee=!1,this.pt=null,this.Qt={},this.Qt.audio=[],this.Qt.video=[],this._i=[],this.re=null,this.ue=null,this.oe=null,this.se=null,this.ae=null,this.he=null,this.ce=!1,this.fe=null,this.de=!1,this.ve=!1,this.le=null,this.pe=null,this.ye=!1,this.we=[],this.me={},this.be=0,this.ge=null,clearInterval(this.Ee),clearTimeout(this.ke)},i.resetBrain=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.V.mediaSourceScanner||{};if(n.tests=this.V.tests,this._e&&this._e.destroy(),t){var i=ce(this._e);return this._e=new fr(this,n),void(i&&this.fire(Ei.BRAIN_ML_SWITCH_TO_SKYFIRE))}this._e=new fr(this,n);var e=he(n,"ml_brain");e&&e.group&&e.data.use_model&&(this._e=new dr(this,n))},i.preloadStream=function(){var t=this;if(this.le)return this.le;var n=0,i=1;this.Qt.audio.length&&(i=2);var e=this.sorcerer.video.activeStreamIndex;this.we.length&&(e=this.we[0]);var r=0,u=this._e.getSegmentsToLoad(!1,"video",e);u.length>0&&(r=u[0]);var o=function(){},s=function(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n&&(e=t.sorcerer.video.activeStreamIndex),t.ge=e,t.Te(!0)},a=function(e){(n+=1)<i||(e.segment===r&&0===t.we.length?t.Ae(!0).then((function(i){if(!1!==i&&i>e.stream){if(t.sorcerer.video.switchTo(i,!1),t.Qt.audio.length){var r=t._e.getAudioIndexFromVideo(t.Qt.video,t.Qt.audio,i);t.sorcerer.audio.switchTo(r,!1)}return n=0,void s(!0)}o()})).catch(console.error):o())};return this.le=new P((function(n,i){o=function(){var i=t.$i(e).segments[0].end,r=t.Se(!0);if(t.currentTime>=r&&(t.currentTime=r),t.currentTime>i&&(t.sorcerer.clear(),t.Qi=new _e),t.sorcerer.video.switchTo(e,!1),t.Qt.audio.length){var u=t._e.getAudioIndexFromVideo(t.Qt.video,t.Qt.audio,e);t.sorcerer.audio.switchTo(u,!1)}t.sorcerer.off("bufferqueueadd",a),t.ge=null,t.ne=!0,n()},t.sorcerer.on("bufferqueueadd",a),s()})),this.le},i.loadManifest=function(t){var n=this,i=Date.now();return xi.browser.ie&&t&&-1!==t.indexOf("archive_playlist")?(setTimeout((function(){n.ht("MediaUnknownError","An unknown error occurred.")}),250),new P((function(){}))):We({url:t,timeout:1e4,type:"manifest"}).then((function(e){return e.url&&e.url!==t&&-1!==e.url.indexOf("live-archive")&&(n.ue=e.url.split("/").slice(0,-2).join("/")),n.manifestLoadDurations.push({url:t,status:e.status,duration:Date.now()-i}),n.fire(wi.MANIFEST_LOADED),e.text()})).then(function(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return P.resolve(t.apply(this,n))}catch(t){return P.reject(t)}}}((function(n){var i;return function(e,r){var u=function(){if(-1!==t.indexOf(".mpd"))return function(t,n,i){return t&&t.then||(t=P.resolve(t)),n?t.then(n):t}(ht("module/media-manifest.js"),(function(e){var r=e.parseMPD;i=r(n,t)}));i=JSON.parse(n)}();return u&&u.then?u.then(r):r()}(0,(function(){return i}))}))).catch((function(e){if(n.manifestLoadDurations.push({url:t,status:e.response&&e.response.status,duration:Date.now()-i}),n.reset(),e instanceof Re&&410===e.response.status)return n.fire(wi.MEDIA_URL_EXPIRED),new P((function(){}));throw e instanceof Re&&400===e.response.status?n.fire(wi.MEDIA_URL_BAD_REQUEST,e.response.url):e instanceof je&&n.fire(wi.MANIFEST_TIMEOUT),e}))},i.setVideoSrc=function(t,n){var i=this,e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e&&!n&&this.re){if(("metadata"===this.X||"none"===this.X&&!this.paused)&&!this.ne)return void this.re.then((function(){var n=i.paused;i.setVideoSrc(t,n,!1)})).catch(console.error);if("auto"===this.X)return void this.re.then((function(){i.setVideoSrc(t,!1,!1)})).catch(console.error)}n&&this.reset(),n||!this.paused||this.sorcerer||(n=!0);var r=this.Re;n&&(r=this.Ot);var u=t.split("/");u.pop();var o="".concat(u.join("/"),"/");this.ce=!n,this.re=this.Oe(t,this.X).then(this.loadManifest.bind(this)).then((function(t){return"string"==typeof i.ue&&-1!==i.ue.indexOf("live-archive")||(i.ue=o),t})).then(r.bind(this)),n&&"auto"===this.X&&(this.re=this.je(this.re,this.preloadStream.bind(this),!1)),this.re=this.Me(this.re)},i.getBitrateAtTime=function(t,n){if(!this.sorcerer)return 0;var i=this.sorcerer.streamIndexAtTime(t,n);return this.Qt[n][i]?this.Qt[n][i].bitrate:0},i.lockStreamIndexes=function(){var t=this,n=this.we.map((function(n){return t.Qt.video.indexOf(t.Qt.video[n])})),i=!this.paused;if(i&&(this.Ie=!0,this.H.pause()),this.me.video=!1,this._e.lock(n),this.ee||"auto"===this.X){var e=Math.max(this.currentTime-7,0),r=Math.min(this.currentTime+7,this.H.duration);this.sorcerer.removeBuffer(e,r).then((function(){!t.ee&&"auto"===t.X||t.ended?t.Ne():(t.seekToTime(t.currentTime),i&&t.paused&&(t.De=!0,t.H.play()))})).catch(console.error)}},i.seekToTime=function(t){var n=this;if(t===this.currentTime)return P.resolve();var i=null===this.se;if(i||(this.Pe&&(this.Pe(),this.Pe=null),this.Ce=null,this.se=null,this.ae=null),this.se=t,this.xe(),this.ne)for(var e in this.Qt)if(this.Qt[e].length>0){var r=this.sorcerer[e].activeStreamIndex;this.sorcerer[e].streams[r].abort()}return this.Ce=this.Le(t),P.all([this.re,this.pe]).then((function(){n.Ne()})).catch(console.error),this.Ue&&0===t&&this.fire(li.SEEKING),i||this.play().catch(this.nt.bind(this)),this.re.then((function(){return n.Ce})).catch((function(t){}))},i.takeSnapshot=function(){},i.initDrm=function(){},i.onstalled=function(){return!1},i.onseeked=function(t){this.ee&&this.Te()},i.onended=function(n){return t.prototype.onended.call(this,n),!0},i.onseeking=function(t){this.ee},i.xe=function(){var t=this;this.He(),clearTimeout(this.Fe),this.Fe=setTimeout((function(){t.Be()}),200)},i.He=function(){this.Ve||(this.Ve=!0,ce(this._e)&&(this._e.scrubInProgress=!0))},i.Be=function(){if(this.Ve=!1,ce(this._e)){this._e.scrubInProgress=!1;var t=this.sorcerer.video.activeStreamIndex;this._e.handleScrubEnd(t),this.Ne()}},i.ontimeupdate=function(n){if(!this.sorcerer)return!1;if(t.prototype.ontimeupdate.call(this),this.te&&this.te.stop(),0===this.currentTime)return this.ee;if(this.se)return!1;this.ee||(this.ee=!0),this.ve&&this.currentTime>=this.ve&&(this.sorcerer.removeBuffer(0,this.ve-2),this.ve=!1);var i=this.sorcerer.getDroppedFrameTotal();this.fire(wi.DROPPED_FRAMES,i);var e=this.sorcerer.getResponseSpeeds(),r=this.Qt.video[this.sorcerer.video.activeStreamIndex],u=this.V.tests&&this.V.tests.download_bitrate;if((!u||!u.group)&&r&&this._e.getCurrentSpeed){var o={speed:this._e.getCurrentSpeed(),bitrate:r.bitrate,speeds:e};this.fire(wi.BANDWIDTH,o)}var s=this.H.buffered.length;if(!s)return!0;var a=this.H.buffered.end(s-1);return Math.ceil(a)===Math.ceil(this.H.duration)||(Math.abs(this.currentTime-a)<.2?(this.ye||(this.fire(wi.STREAM_BUFFER_START,{hasLowerStreamIndex:this.sorcerer.video.activeStreamIndex>0}),this.ye=!0),!1):void 0)},i.qe=function(){return!!this.ended||Math.ceil(this.currentTime)===Math.ceil(this.H.duration)},i.We=function(){return!!this.sorcerer&&!this.qe()&&(null!==this.ge?(this.Ge(),!0):0!==this.currentTime||this.ne?(this.Ne(),!0):this.ee)},i.onprogress=function(){this._e.canPlayFromTimeInStream(this.currentTime,this.$i())&&this.ye&&(this.fire(wi.STREAM_BUFFER_END),this.ye=!1)},i.onwaiting=function(){return!this.te||!this.te.start()},i.onerror=function(){return!!this.H.error&&(this.H.error.code===this.H.error.MEDIA_ERR_DECODE?(this.fire(wi.SCANNER_ERROR,{reason:"encountered media decode error"}),!1):t.prototype.onerror.call(this))},i.pause=function(){t.prototype.pause.call(this)},i.play=function(){var n=this;return this.Te(),t.prototype.play.call(this,(function(){return n.he&&n.he(),n.ce||n.ne||"auto"===n.X||(n.re=n.je(n.re,n.preloadStream.bind(n))),n.re.then((function(){return P.resolve(n.Ce)}))}))},i.onpause=function(){return this.Ie?(this.Ie=!1,!1):(t.prototype.onpause.call(this),!0)},i.onplay=function(){return!this.De||(this.De=!1,!1)},i.je=function(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],e=t.then(n);return i&&(e=this.Me(e)),e},i.Me=function(t){var n=this;return t.catch((function(t){return n.fire(wi.FILE_ERROR,{reason:t}),new P((function(t,n){}))}))},i.$e=function(){this.ne&&this.Qt.video[this.sorcerer.video.activeStreamIndex].bitrate/1e3>12e3&&(this.pe=this.sorcerer.removeBuffer())},i.Oe=function(t,n){var i=this;return new P((function(e,r){"none"!==n||i.ce&&!i.paused?e(t):i.he=function(){e(t),i.he=null}}))},i.Le=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.se;return new P((function(i,e){var r=t.ee&&0===n,u=t._e.canPlayFromTimeInStream(n,t.$i());r||u?i(n):(t.$e(),t.ae=i)})).then((function(n){t.se=null,t.Ce=null;var i=new P((function(n,i){t.Pe=i,t.H.addEventListener("seeked",(function i(){n(t.H.currentTime),t.H.removeEventListener("seeked",i)}))}));return t.H.currentTime=n,i}))},i.Ye=function(t,n){"auto"!==t&&"auto"===n&&(this.re=this.je(this.re,this.preloadStream.bind(this))),t!==n&&"none"!==n&&this.he&&this.he()},i.ze=function(t){var n=t.audio.reduce((function(t,n){return t+n.duration}),0),i=t.video.reduce((function(t,n){return t+n.duration}),0),e=n/t.audio.length,r=i/t.video.length;return e+4<r?r-e:0},i.Ke=function(t){return t.video.every((function(t){return t.segments.every((function(t){return"size"in t}))}))},i.Re=function(t){var n=this;return new P((function(i,e){if(n.pt=t,n.Qt.video=n.Xe(t.video),t.audio){var r=n.ze(t);if(r>0)return n.fire(wi.AV_DURATION_MISMATCH,r),n.fire(wi.SCANNER_ERROR,{reason:"Encountered A/V duration mismatch"}),void e();var u=t.audio.filter((function(t){return"opus"===t.codecs})),o=t.audio.filter((function(t){return"opus"!==t.codecs})),s=MediaSource.isTypeSupported('audio/mp4; codecs="opus"')&&u.length?u:o;n.Qt.audio=n.Xe(s)}for(var a=0;a<n.Qt.video.length;a++){var h=0;if(t.audio){var c=n._e.getAudioIndexFromVideo(n.Qt.video,n.Qt.audio,a),f=n.Qt.audio[c];f&&(h=f.bitrate)}n.Qt.video[a].audioBitrate=h}ce(n._e)&&n.Qt.audio.length>0&&(n._e.audioStreams=n.Qt.audio),n.Je(n.Qt.video,n.Qt.audio,n.pt.key_info),n.Ke(t)||n.resetBrain(!0),n.fire(wi.STREAMS_LOADED,n.Qt),i()}))},i.Qe=function(t,n){this.sorcerer&&this.sorcerer.destroy(),this.sorcerer=new hr(t,n),this.H.src=URL.createObjectURL(this.sorcerer.mediaSource),this.successfulSegments=this.sorcerer.getSuccessfulSegments(),this.failedSegments=this.sorcerer.getFailedSegments(),this.Te()},i.Te=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.Ze(500),clearTimeout(this.ke),this.ke=setTimeout((function(){t.Ze(5e3)}),6e4),n&&this.We()},i.Ze=function(t){var n=this;clearInterval(this.Ee),this.Ee=setInterval((function(){n.We()}),t)},i.Se=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t?1/0:0;for(var i in this.Qt)this.Qt[i].length&&(n=Math[t?"min":"max"](n,this.Qt[i][0].duration));return n},i.Ot=function(t){var n=this;return this.Re(t).then((function(){var i=n.video&&n.video.metadata.percentShown?n.video.metadata.percentShown:null,e=n._e.filterStreams(n.Qt.video,n.H.clientWidth,n.H.clientHeight,i).length-1,r=n.Qt.video[0];n.we.length&&(r=n.Qt.video[n.we[0]]),void 0!==n.Ji&&e<=n.Qt.video.indexOf(t.video[n.Ji])&&(r=n.Qt.video[e]),n.Qe(n.H,{duration:n.Se(),fetcherTimeout:8e3,fetcherRetryAbortErrors:!1}),n.sorcerer.on("srcnotsupported",(function(){n.fire(wi.SCANNER_ERROR,{reason:"this codec is not supported for mediasource playback"})}));var u=n.Qt.video.indexOf(r),o=function(t){n.Qt[t].forEach((function(i,e){var r=n.tr(e,"init",t);n.nr(e,t)&&n.Qt[t][e].init_segment_range&&(r={url:r,byteRange:n.ir(e,"init",t)}),n.sorcerer.addStream("".concat(i.mime_type,'; codecs="').concat(n.Qt[t][e].codecs,'"'),r)}))};for(var s in n.Qt)o(s);n.sorcerer.video.switchTo(u),n.sorcerer.on("queued",n.er.bind(n)),n.sorcerer.on("downloadabort",n.rr.bind(n)),n.sorcerer.on("appendbufferend",n.Oi.bind(n)),n.sorcerer.on("downloadstart",n.Si.bind(n)),n.sorcerer.on("downloadend",n.Ri.bind(n)),n.sorcerer.on("downloaderror",n.ur.bind(n)),n.sorcerer.on("downloadtimeout",n.ji.bind(n)),n.sorcerer.on("quotaexceedederror",n.or.bind(n)),n.sorcerer.video.on("streamchange",n.sr.bind(n)),n.sorcerer.video.on("streamchangestart",n.ar.bind(n)),n.sorcerer.mediaSource.addEventListener("sourceended",(function(){n.fire(li.PROGRESS)}))}))},i.Xe=function(t){var n=t.slice(0);return n.sort((function(t,n){var i=t.width*t.height*t.bitrate,e=n.width*n.height*n.bitrate;return t.width===n.width&&t.height===n.height?t.framerate-n.framerate:i-e})),n},i.nr=function(t,n){return!!this.Qt[n][t].segments[0].range},i.ir=function(t,n,i){return"init"===n?this.Qt[i][t].init_segment_range:this.Qt[i][t].segments[n].range},i.hr=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"video",e="init"===n;if(e)return 0;var r=this.Qt[i][t].segments[n].start;return r},i.tr=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"video",e="init"===n;if(e&&!this.Qt[i][t].init_segment_range&&-1===this.Qt[i][t].init_segment.indexOf(".")){var r=this.Qt[i][t].init_segment;return re(r)}var u=this.ue,o=this.pt.base_url&&-1!==this.pt.base_url.indexOf("//");return o&&(u=this.pt.base_url),this.pt.base_url&&!o&&(u+=this.pt.base_url),this.Qt[i][t].base_url&&(u+=this.Qt[i][t].base_url),this.nr(t,i)?u:"init"===n?u+=this.Qt[i][t].init_segment:(this.Qt[i][t].segments[n].url&&(u+=this.Qt[i][t].segments[n].url),u)},i.cr=function(t,n,i){return"".concat(t,":").concat(n,":").concat(i)},i.dr=function(t,n,i){return n===this.Qt[i][t].segments.length-1},i.lr=function(t,n){var i=[],e=this.Zi[t];if(!e)return i;for(var r=0;r<e.length;r++)this.Qi.has(this.cr(e[r],t,n))&&i.push(e[r]);return i},i.getCurrentStream=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"video";return this.$i(0,t)},i.$i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video";return void 0!==this.sorcerer&&(t=this.sorcerer[n].activeStreamIndex),this.Qt[n][t]},i.Ae=function(t,n){var i=this,e=this.Qt.video,r=this.video&&this.video.metadata.percentShown?this.video.metadata.percentShown:null;if(0===(e=this._e.filterStreams(e,this.H.clientWidth,this.H.clientHeight,r)).length)return P.resolve(!1);if(this.me.video&&!ce(this._e))return P.resolve(!1);var u=e[e.length-1];if(u.id!==this.oe){this.oe=u.id;var o={index:this.Qt.video.indexOf(u),streams:this.Qt.video};this.fire(wi.STREAM_TARGET_CHANGE,o)}var s=this.$i();return this._e.shouldPowerUp(e,s,t).then((function(t){return!1===t?i._e.shouldPowerDown(e,s).then((function(t){return!1===t?t:i.Qt.video.indexOf(e[t])})):i.Qt.video.indexOf(e[t])}))},i.pr=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"video";this.Ae(!1,n).then((function(i){"audio"===n&&(!1===i&&(i=t.sorcerer.video.activeStreamIndex),i=t._e.getAudioIndexFromVideo(t.Qt.video,t.Qt.audio,i),t.sorcerer.audio.activeStreamIndex===i&&(i=!1));var e=!1;!1!==i&&(e=i>t.sorcerer[n].activeStreamIndex,t.me[n]=!0,t.sorcerer[n].switchTo(i).then((function(){t.me[n]=!1})).catch(console.error));for(var r=e,u=t._e.getSegmentsToLoad(r,n,t.$i()),o=t.sorcerer[n].activeStreamIndex,s=function(i){var e=t.tr(o,u[i],n),r=t.lr(u[i],n);if(r.length>1)return"continue";if(1===r.length&&o<=r[0])return"continue";var s=t.dr(o,u[i],n),a={stream:o,segment:u[i],type:n},h=t.sorcerer[n].streams[o],c=e;t.nr(o,n)&&(c={url:c,byteRange:t.ir(o,u[i],n)});var f=t.hr(o,u[i],n),d="video"===n,v=null;0===o&&"video"===n&&(v=16e3);var l=null;try{l=t.Qt[n][o].segments[u[i]].size}catch(t){}h.addSegment(c,{identifier:a,isFinalSegment:s,priority:f,includeWithBandwidthChecks:d,timeout:v,size:l}).catch((function(t){if(!(t instanceof Qe||t instanceof Se||t instanceof je))throw t}))},a=0;a<u.length;a++)s(a)})).catch(console.error)},i.Ge=function(){var t=this,n=function(n){if(0===t.Qt[n].length)return"continue";var i=0,e=t._e.getSegmentsToLoad(!1,n,t.$i());e.length>0&&(i=e[0]);var r=t.ge;"audio"===n&&(r=t._e.getAudioIndexFromVideo(t.Qt.video,t.Qt.audio,t.ge));var u=t.cr(r,i,n);if(t.Qi.has(u))return"continue";var o=t.tr(r,i,n),s=t.dr(r,i,n),a=t.sorcerer[n].streams[r],h={stream:r,segment:i,type:n},c=o;t.nr(r,n)&&(c={url:c,byteRange:t.ir(r,i,n)}),a.addSegment(c,{identifier:h,isFinalSegment:s,loadOnly:!0,priority:0}).catch((function(t){if(!(t instanceof Qe||t instanceof Se||t instanceof je))throw t}))};for(var i in this.Qt)n(i)},i.Ne=function(){var t=this;return this.re&&this.re.then((function(){for(var n in t.Qt)t.Qt[n].length>0&&t.pr(n)}))},i.er=function(t){this.Qi.add(this.cr(t.stream,t.segment,t.type)),this.Zi[t.segment]||(this.Zi[t.segment]=[]),-1===this.Zi[t.segment].indexOf(t.stream)&&this.Zi[t.segment].push(t.stream)},i.yr=function(t){var n=this;(this.Zi[t.segment]||[]).forEach((function(i){n.Qi.delete(n.cr(i,t.segment,t.type))}))},i.rr=function(t){this.Zi[t.segment]&&this.yr(t)},i.Oi=function(t){this.fire(wi.APPEND_BUFFER_END,{identifier:t}),this.Te(),this.de&&t.stream===this.fe&&(this.de=!1,this.ve=this.Qt.video[t.stream].segments[t.segment].start),this.Zi[t.segment]&&this.yr(t);var n=this._e.canPlayFromTimeInStream(this.se,this.$i());null!==this.se&&this.ae&&n&&(this.ae(this.se),this.ae=null),this.te&&this.te.onSegmentAppended()},i.Si=function(t){this.fire(wi.DOWNLOAD_START,{identifier:t})},i.Ri=function(t,n){this.fire(wi.DOWNLOAD_END,{identifier:t,data:n})},i.ur=function(t,n){this.yr(t);var i=wi.DOWNLOAD_ERROR;410===n&&(i=wi.MEDIA_URL_EXPIRED),this.fire(i,{identifier:t,status:n})},i.ji=function(t,n){this.fire(wi.DOWNLOAD_TIMEOUT,{identifier:t,data:n}),this.Zi[t.segment]&&this.yr(t),"video"===t.type?this.me.video=!1:"audio"===t.type&&(this.me.audio=!1)},i.or=function(t){this.fire(wi.QUOTA_EXCEEDED_ERROR,{buffered:t})},i.ar=function(t,n){var i={previousStreamIndex:this.pt.video.indexOf(this.Qt.video[t]),index:this.pt.video.indexOf(this.Qt.video[n]),streams:this.pt.video};this.fire(wi.STREAM_CHANGE_START,i)},i.sr=function(t){t>this.fe&&this.currentTime>0&&(this.de=!0),this.fe=t;var n={index:this.pt.video.indexOf(this.Qt.video[t]),streams:this.pt.video};this.fire(wi.STREAM_CHANGE,n)},i.Je=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.q.drmHandler){var e={audio:n.map((function(t){return"".concat(t.mime_type,';codecs="').concat(t.codecs,'"')})),video:t.map((function(t){return"".concat(t.mime_type,';codecs="').concat(t.codecs,'"')}))};this.q.drmHandler.init(this,e,i)}},V(n,[{key:"preload",get:function(){return this.X},set:function(t){this.Ye(this.X,t),this.X=t}},{key:"videoElement",get:function(){return this.H}},{key:"videoWidth",get:function(){var t=this.$i();return t?t.width:this.H.videoWidth}},{key:"videoHeight",get:function(){var t=this.$i();return t?t.height:this.H.videoHeight}},{key:"restrictedStreamIndexes",get:function(){return this.we},set:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.we.join(",")!==n.join(",")&&(this.we=n,this.re.then((function(){return t.lockStreamIndexes()})).catch(console.error))}},{key:"currentTime",get:function(){return null!==this.se?this.se:this.H.currentTime},set:function(t){(this.ee||0!==t)&&this.seekToTime(t)}},{key:"downloadSpeed",get:function(){return this.be}},{key:"brainDebug",get:function(){var t=this.sorcerer&&this._e&&this._e.getCurrentSpeed?this._e.getCurrentSpeed():null,n=this.sorcerer&&this.sorcerer.getResponseSpeeds?this.sorcerer.getResponseSpeeds():null;return{currentSpeed:t,responseSpeeds:n=n?n.slice(-20):[]}}},{key:"isLowerProfileAvailable",get:function(){return this.sorcerer?this.sorcerer.video.activeStreamIndex>0:null}}]),n}(Ee),pr=[1,2,5],yr=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).wr=.4,i.mr=.6,i.br=i.V.tests&&i.V.tests.live_volatility&&i.V.tests.live_volatility.group,i.consecutiveStreamIndex={},i.isNewPlayback=!0,i}$(n,t),V(n,[{key:"displayName",get:function(){return"Live"}}]);var i=n.prototype;return i.optimalStreamIndex=function(t,n){if(this.isNewPlayback&&this.scanner.sorcerer.getResponseSpeeds().length>=2&&(this.isNewPlayback=!1),1===t.length)return 0;if(this.isNewPlayback){for(var i=0,e=0,r=this.scanner.videoElement.clientHeight,u=[],o=0;o<t.length;o++){var s=t[o].height;u.push(s),s<r&&s>e&&(i=o,e=t[o].height)}return Math.max(0,i-1)}var a=this.scanner.sorcerer.getCurrentSpeed({type:"average",howMany:5,weights:pr}),h=this.scanner.sorcerer.getVolatilityScaler(5);h||(h=.3);var c=n,f=n;if(this.br)for(var d=0;d<t.length;d++)a*this.wr*h>t[d].bandwidth&&(c=d),a*this.mr*h>t[d].bandwidth&&(f=d);else for(var v=0;v<t.length;v++)a*this.wr>t[v].bandwidth&&(c=v),a*this.mr>t[v].bandwidth&&(f=v);var l=n<c?c:f;this.gr(l),this.consecutiveStreamIndex[l]++;var p=1.5*this.scanner.segmentLength,y=this.scanner.videoElement,w=y.buffered;return w&&0!==w.length?w.end(w.length-1)-y.currentTime<p?0!==n?n-1:0:this.consecutiveStreamIndex[l]>2&&l!==n?l:n:0},i.gr=function(t){for(var n in this.consecutiveStreamIndex[t]||(this.consecutiveStreamIndex[t]=0),this.consecutiveStreamIndex)this.consecutiveStreamIndex.hasOwnProperty(n)&&parseInt(n,10)!==t&&(this.consecutiveStreamIndex[n]=0)},i.getSegmentsToLoad=function(t,n){var i=this.scanner.videoElement,e=this.scanner.sorcerer[t].sourceBuffer;if(function(t,n){if(!n||!n.length)return 0;if(1===n.length&&n.end(0)-n.start(0)<1e-6)return 0;for(var i=0,e=n.length-1;e>=0&&n.end(e)>t;--e)i+=n.end(e)-Math.max(n.start(e),t);return i}(i.currentTime,e&&e.buffered)>=this.scanner.bufferTarget)return[];var r=this.Er(),u=this.kr(),o=n.segments.sort((function(t,n){return t.index-n.index}));return!this._r&&r<o[0].start?[]:(this._r=!0,o.filter((function(t){return!(t.end<r||t.start>u)})))},i.Er=function(){var t=this.Tr(),n=this.scanner.manifest.maxEndTime-t;return Math.max(0,n)},i.kr=function(){var t=this.Tr(),n=this.scanner.bufferTarget,i=this.scanner.manifest.maxEndTime-Math.max(0,t-n);return Math.max(0,i)},i.Tr=function(){return this.scanner.presentationDelay||this.scanner.manifest.presentationDelay},V(n,[{key:"availabilityStart",get:function(){return this.Er()}},{key:"availabilityEnd",get:function(){return this.kr()}}]),n}(fr),wr=["disabled","hidden","showing"],mr=["subtitles","captions","descriptions","chapters","metadata"],br=["ar","fa","he","iw","ku","ps","sd","ur","yi"],gr=new x,Er=new x,TelecineTextTrack=function(){function TelecineTextTrack(t,n){var i=t.kind,e=t.src,r=void 0===e?null:e,u=t.label,o=void 0===u?"":u,s=t.language,a=void 0===s?"":s,h=t.id,c=void 0===h?ie():h;if(-1===mr.indexOf(i))throw ve(12,"SYNTAX_ERR","Syntax Error");et(this),Object.defineProperties(this,{kind:{value:i,enumerable:!0},label:{value:o,enumerable:!0},language:{value:a,enumerable:!0},id:{value:"".concat(c),enumerable:!0},rtl:{value:-1!==br.indexOf(a.substr(0,2)),enumerable:!0}}),this.video=n,this.src=r,this.et=!1,gr.set(this,"disabled")}return TelecineTextTrack.prototype.dispatchEvent=function(t){this.fire(t,{target:this})},V(TelecineTextTrack,[{key:"mode",get:function(){return gr.get(this)},set:function(t){if(wr.indexOf(t)>-1){if(this.et=!0,gr.get(this)===t)return;gr.set(this,t),this.video.currentScanner&&this.video.currentScanner.setModeForTrack(this,t),this.dispatchEvent("modechange")}}},{key:"src",get:function(){return Er.get(this)},set:function(t){Er.set(this,t),this.video.fire(wi.TEXT_SRC_UPDATE,this)}},{key:"cues",get:function(){return this.video.currentScanner?this.video.currentScanner.getCuesForTrack(this):[]}},{key:"activeCues",get:function(){return this.video.currentScanner?this.video.currentScanner.getActiveCuesForTrack(this):[]}}]),TelecineTextTrack}();function kr(t){var n=/^(?:(\d{2,}):)?(\d{2}):(\d{2})[,.](\d{3})$/.exec(t);if(!n)return-1;var i=parseInt(n[4],10)/1e3;return i+=parseInt(n[3],10),n[2]&&(i+=60*parseInt(n[2],10)),n[1]&&(i+=60*parseInt(n[1],10)*60),i}function _r(t,n,i){return i?n?n(t):t:(t&&t.then||(t=P.resolve(t)),n?t.then(n):t)}function Tr(t,n){try{var i=t()}catch(t){return n(t)}return i&&i.then?i.then(void 0,n):i}function Ar(t,n){return t&&t.then?t.then(n):n(t)}var Sr=xi.browser.ie||xi.browser.edge?.5:.2;function Rr(){}function Or(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return P.resolve(t.apply(this,n))}catch(t){return P.reject(t)}}}var jr=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).Ar=!1,i.Sr=!1,i.Rr=2e3,i.Or=1e4,i.reset(),i.bufferTarget=e.bufferTarget||12,i.presentationDelay=e.presentationDelay||12,window.addEventListener("online",(function(){i.play()})),i}$(n,t),V(n,null,[{key:"displayName",get:function(){return"HLSLiveScanner"}},{key:"supported",get:function(){return"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported}},{key:"supportedVideoTypes",get:function(){return["application/x-mpegURL"]}},{key:"supportsPlaybackRate",get:function(){return!1}}]);var i=n.prototype;return i.deactivate=function(){t.prototype.deactivate.call(this),this.reset()},i.reset=function(){this.Gt&&this.Gt.destroy(),this.jr&&this.jr.stop(),this.Mr=new ft,this.Gt=null,this.Qt={},this.Qt.video=[],this.Qt.audio=[],this.fe=0,this.Ir=!1,this.Nr=!1,this.Dr=!1,this.Pr=0,this.Cr=0,this.xr=0,this.Lr=!1,this.Ur=new yr(this,this.V),this.we=[],this.Hr={},this.Fr=0,this.Br=0,this.Vr=this.V.tests&&this.V.tests.live_playrate_recover&&this.V.tests.live_playrate_recover.group,this.qr=null,this.Wr=null,this.Gr=null},i.endLive=function(){this.Ir=!1,this.jr&&this.jr.stop(),this.Gt&&(this.Gt.abortFetches(),this.Gt.endOfStream()),this.Nr=!0,t.prototype.deactivate.call(this),this.fire(li.ENDED)},i.$r=function(){this.Ir||(this.Ir=!0,this.fire(mi.STREAM_ONLINE))},i.Yr=function(){this.Ir&&(this.Ir=!1,this.fire(mi.STREAM_OFFLINE))},i.zr=function(t){t?this.$r():this.Yr()},i.Kr=function(t){try{var n=this;if(n.Nr)return;n.jr&&(n.jr.stop(),n.jr.off());var i=[ht("module/media-manifest.js")];return n.video.metadata.p2p&&i.push(ht("module/streamroot.js")),_r(P.allSettled(i),(function(i){var e=Z(i,1)[0].value,r=e.M3U8Loader,u=e.PLAYLIST_UPDATE,o=e.PLAYLIST_ERROR;return n.jr=new r,n.jr.on(u,(function(){return n.Xr()})),n.jr.on(o,(function(){return n.Yr()})),Ar(Tr((function(){var i=n.video.metadata.playlistRefreshUrl;return _r(n.jr.start(t,i),(function(t){n.pt=t,n.$r()}))}),(function(t){throw n.Yr(),n.endLive(),t})),(function(t){n.Jr(n.H),n.Qt.video=n.Qr(n.Xe(n.pt.video)),n.Qt.video.forEach((function(t){n.Gt.addStream(se(t.mimeType,t.codecs),t.initSegment)})),n.pt.audio&&(n.Qt.audio=n.Qr(n.Xe(n.pt.audio)),n.Qt.audio.forEach((function(t){n.Gt.addStream(se(t.mimeType,t.codecs),t.initSegment)}))),n.fire(wi.STREAMS_LOADED,n.Qt),n.manifest.captions&&n.manifest.captions.length>0&&(n.manifest.captions.forEach(n.Zr.bind(n)),n.fire(wi.TEXT_TRACKS_AVAILABLE)),n.tu(),n.nu(!0)}))}))}catch(t){return P.reject(t)}},i.iu=function(){try{var t=this;return function(t){if(t&&t.then)return t.then(Rr)}(Tr((function(){var n=t.$i();return _r(t.jr.update(n.uri),(function(){t.$r()}))}),(function(){t.Yr()})))}catch(t){return P.reject(t)}},i.Jr=function(t){this.Gt&&this.Gt.destroy(),this.Gt=new hr(t,{fetcherRetryAbortErrors:!1,fetcherTimeout:8e3})},i.tu=function(){this.Gt.video.on("streamchange",this.sr.bind(this)),this.Gt.video.on("streamchangestart",this.ar.bind(this)),this.Gt.on("downloadend",this.Ri.bind(this)),this.Gt.on("downloadtimeout",this.ji.bind(this)),this.Gt.on("downloadabort",this.eu.bind(this)),this.Gt.on("appendbufferend",this.ru.bind(this))},i.Ri=function(t,n){t&&t.isInitSegmentRequest||(n.extraContext={liveAvail:{start:this.Ur.availabilityStart,end:this.Ur.availabilityEnd}},this.fire(wi.DOWNLOAD_END,{identifier:t,data:n}))},i.ji=function(t,n){if(!t||!t.isInitSegmentRequest){var i="".concat(t.type,"_").concat(t.segment);delete this.Hr[i],this.fire(wi.DOWNLOAD_TIMEOUT,{identifier:t,data:n})}},i.eu=function(t,n){if(!t||!t.isInitSegmentRequest){var i="".concat(t.type,"_").concat(t.segment);delete this.Hr[i]}},i.ar=function(t,n){var i={previousStreamIndex:this.Qt.video.indexOf(this.Qt.video[t]),index:this.Qt.video.indexOf(this.Qt.video[n]),streams:this.Qt.video};this.fire(wi.STREAM_CHANGE_START,i)},i.sr=function(t){this.Dr=!1,this.fire(wi.STREAM_CHANGE,{index:t,streams:this.Qt.video})},i.ru=function(){this.Lr||(this.Lr=!0)},i.Xr=function(){this.Ne(),this.Sr&&this.manifest.captions&&this.manifest.captions.length>0&&this.uu(),this.zr(this.ou()||!this.su()),this.au(),this.Vr&&this.hu()},i.cu=function(t,n,i){this.qr=t,this.Wr=i,this.Gr=n,this.playbackRate=n},i.fu=function(){this.qr=null,this.Wr=null,this.Gr=null,this.playbackRate=1},i.hu=function(){var t=this.Ur.availabilityStart,n=this.Ur.availabilityEnd;if(this.Lr)if(t&&n&&this.currentTime){if(!(this.qr&&new Date-this.qr<this.Wr)){var i=n-this.currentTime;i<6?this.cu(new Date,.9,15e3):i>300?this.cu(new Date,1.1,15e3):this.qr&&this.fu()}}else this.fu()},i.Zr=function(t,n){var i=t.label,e=t.language;if(!this.du){var r=new TelecineTextTrack({label:i,id:n,kind:"captions",language:e},this.q);this.q.textTracks=Zi([r]),this.du=this.addTextTrack(r)}},i.uu=function(){try{var t=this;return _r(t.Mr,(function(){if(t.manifest.captions){var n=t.manifest.captions[0].segments,i=n.slice(t.xr);t.xr=n.length,i.forEach(Or((function(n){return _r(We(n.url).text(),(function(n){var i=function(t){var n=0,i=t.split(/(?:(?:\r\n|\n){2,})/),e=[],r=null;do{0===n&&/^\uFEFF?WEBVTT(?: .*)?/.test(i[n])&&n++,(r=/^(?:(.*)(?:\r\n|\n))?([\d:,.]+) --> ([\d:,.]+)(.*)?(?:\r\n|\n)([\s\S]*)/.exec(i[n]))&&e.push({startTime:kr(r[2]),endTime:kr(r[3]),text:r[5]}),n++}while(n<i.length);return e}(n),e=function(t){var n=t.match(/=MPEGTS:(\d+),/);return(n&&n[1]||0)/9e4}(n);i.forEach((function(n){n.startTime=e+n.startTime,n.endTime=e+n.endTime;var i=new(window.VTTCue||window.TextTrackCue)(n.startTime,n.endTime,n.text);t.du.addCue(i)}))}))})))}}))}catch(t){return P.reject(t)}},i.ou=function(){return this.manifest.maxEndTime>0&&(this.manifest.maxEndTime===this.Fr?this.Br++:this.Br=0,this.Fr=this.manifest.maxEndTime),this.Br<3},i.Ne=function(){try{var t=this;return _r(t.Mr,(function(){for(var n in t.Qt)t.Qt[n].length>0&&t.pr(n)}))}catch(t){return P.reject(t)}},i.pr=function(t){var n=this,i=this.Gt[t].activeStreamIndex,e=this.$i(t,i);this.Ur.getSegmentsToLoad(t,e).forEach((function(e){var r="".concat(t,"_").concat(e.index),u={stream:i,segment:e.index,type:t};n.Hr[r]||(n.sorcerer[t].streams[i].addSegment(e.url,{identifier:u}).catch((function(t){delete n.Hr[r]})),n.Hr[r]=!0)}))},i.getCurrentStream=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"video";return this.$i(t)},i.$i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"video",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return void 0!==this.Gt&&null!==this.Gt&&(n=this.Gt[t].activeStreamIndex),this.Qt[t][n]},i.nu=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.Dr){var n=this.video&&this.video.metadata.percentShown?this.video.metadata.percentShown:null,i=this.Ur.filterStreams(this.Qt.video,this.H.clientWidth,this.H.clientHeight,n);if(0!==i.length){var e=this.Ur.optimalStreamIndex(i,this.fe),r=this.Qt.video.indexOf(i[e]);if(r>=0&&(t||r!==this.fe)){if(r-this.fe>0&&this.Cr>0){if(ne(this.Cr)<this.Or)return}else this.Cr=te();var u={index:r,streams:this.Qt.video};this.fire(wi.STREAM_TARGET_CHANGE,u),this.Dr=!0,this.Gt.video.switchTo(r,!0),this.fe=r,this.iu()}}}},i.au=function(){var t=this.buffered;if(t.length){var n,i=t.length,e=this.H.currentTime;try{n=function(t,n){if(!t||!t.length)return null;if(1===t.length&&t.end(0)-t.start(0)<1e-6)return null;for(var i,e=0;e<t.length;e++)if(t.start(e)>n&&(0===e||t.end(e-1)-n<=.5)){i=e;break}return i>=0?i:null}(t,e)}catch(t){throw DOMException,t}if(null!==n&&0!==this.H.readyState&&!(this.H.paused||i<=n)){var r,u;try{r=t.start(n),u=t.end(i-1)}catch(t){throw DOMException,t}var o=r-e,s=u-r;if(s>0&&s<=2*this.segmentLength){var a="Preventing jump too close to buffered end time."+" Would have jumped to: ".concat(r,".")+" Last buffered end time ".concat(u,".");this.fire(mi.BUFFER_GAP_JUMP_PREVENT,{msg:a})}else{if(0===n){var h="Jumping forward ".concat(o)+" seconds because of gap before start time of ".concat(r);this.fire(mi.BUFFER_GAP_JUMP,{msg:h})}else{var c="Jumping forward ".concat(o," seconds because of gap starting at")+" ".concat(t.end(n-1)," and ending at ").concat(r);this.fire(mi.BUFFER_GAP_JUMP,{msg:c})}this.H.currentTime=r+.1}}}},i.su=function(){var t=this.buffered;return!!(t&&t.length&&this.H.currentTime+Sr>t.end(t.length-1))},i.setVideoSrc=function(t){try{var n=this;return _r(n.Oe(n.X),(function(){return _r(n.Kr(t),(function(){n.H.src=URL.createObjectURL(n.Gt.mediaSource),n.Mr.resolve()}))}))}catch(t){return P.reject(t)}},i.Oe=function(t){try{return this.vu=new ft,"none"===t&&this.paused||this.vu.resolve(),this.vu}catch(t){return P.reject(t)}},i.getBitrateAtTime=function(t,n){if(!this.Gt)return 0;var i=this.Gt.streamIndexAtTime(t,n);return this.Qt[n][i]?this.Qt[n][i].bandwidth:0},i.Xe=function(t){var n=t.slice(0);return n.sort((function(t,n){var i=t.width*t.height*t.bitrate,e=n.width*n.height*n.bitrate;return t.width===n.width&&t.height===n.height?t.framerate-n.framerate:i-e})),n},i.Qr=function(t){return t.filter((function(n){return n.mimeType===t[0].mimeType}))},i.onprogress=function(){this.au()},i.ondurationchange=function(){this.au()},i.ontimeupdate=function(){if(this.Gt){t.prototype.ontimeupdate.call(this),this.fire(wi.DROPPED_FRAMES,this.Gt.getDroppedFrameTotal());var n=this.$i();if(n){var i={speed:this.Gt.getCurrentSpeed({type:"average",howMany:3,weights:[1,2,5]}),bitrate:n.bitrate,speeds:this.Gt.getResponseSpeeds()};this.fire(wi.BANDWIDTH,i)}!this.Ir&&this.su()&&this.fire(mi.STREAM_OFFLINE),ne(this.Pr)>this.Rr&&(this.nu(),this.Pr=te())}},i.seekToTime=function(){},i.onpause=function(){this.jr&&this.jr.stop()},i.pause=function(){t.prototype.pause.call(this),this.jr&&this.jr.stop(),this.Gt&&(this.Gt.abortFetches(),this.Hr={},this.Gt.removeBuffer().catch((function(){})))},i.play=function(){var n=this;return t.prototype.play.call(this,Or((function(){var t=!1;return n.vu.resolve(),function(i,e){var r=function(){if(n.Ar)return _r(n.iu(),(function(){return n.Hr={},Ar(Tr((function(){return function(t,n){return t&&t.then?t.then(Rr):P.resolve()}(n.Gt.removeBuffer())}),(function(t){})),(function(){return _r(n.Mr,(function(){return n.Ne(),_r(n.lu(),(function(){n.currentTime=n.buffered.start(0)+.1,t=!0}))}))}))}))}();return r&&r.then?r.then(e):e(r)}(0,(function(i){return t?i:_r(n.Mr,(function(){n.Ne(),n.Ar=!0}))}))})))},i.lu=function(){var t=this;return new P((function(n){t.Gt.once("appendbufferend",n)}))},i.setCaptionsState=function(t){this.Sr=t},V(n,[{key:"preload",get:function(){return this.X},set:function(t){this.X!==t&&"none"!==t&&this.vu.resolve(),this.X=t}},{key:"restrictedStreamIndexes",get:function(){return this.we},set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.we.join(",")!==t.join(",")&&(this.we=t,this.Ur.lock(this.we))}},{key:"videoWidth",get:function(){return this.pu?this.pu.width:this.H.videoWidth}},{key:"videoHeight",get:function(){return this.pu?this.pu.height:this.H.videoHeight}},{key:"currentTime",get:function(){return this.H.currentTime},set:function(t){this.H.currentTime=t}},{key:"isLowerProfileAvailable",get:function(){return this.Gt?this.Gt.video.activeStreamIndex>0:null}},{key:"sorcerer",get:function(){return this.Gt}},{key:"segmentLength",get:function(){return this.pt.targetDuration}}]),n}(Ee),Mr=document.createElement("video"),Ir={"application/x-mpegURL":"application/x-mpegURL"},Nr=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).yu=null,i.reset(),window.addEventListener("online",(function(){i.play()})),i}$(n,t),V(n,null,[{key:"displayName",get:function(){return"NativeHLSLiveScanner"}},{key:"supported",get:function(){return n.supportedVideoTypes.length>0}},{key:"supportedVideoTypes",get:function(){var t=[];if("function"!=typeof Mr.canPlayType)return t;for(var n in Ir){var i=Ir[n];Mr.canPlayType(i).replace(/^no$/,"")&&t.push(n)}return t}},{key:"supportsPlaybackRate",get:function(){return!1}}]);var i=n.prototype;return i.deactivate=function(){t.prototype.deactivate.call(this),this.reset()},i.reset=function(){this.wu&&clearTimeout(this.wu),this.re=null,this.wu=null,this.Ir=!1,this.Nr=!1,this.mu=null,this.bu=0,this.wu=null,this.Ur=new yr(this,this.V),this.we=[]},i.endLive=function(){var n=this;this.Ir=!1,this.Nr=!0,clearTimeout(this.wu),this.H.pause(),setTimeout((function(){t.prototype.deactivate.call(n),n.fire(li.ENDED)}),0)},i.gu=function(){var t=this,n=vt(this.video.metadata.playlistRefreshUrl.split("?")[1]);n.expires&&(this.wu=setTimeout((function(){t.Eu()}),1e3*(n.expires-10)))},i.Eu=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=this.video.metadata.playlistRefreshUrl;return We(i).json().then((function(e){if(!("url"in e))throw new Error("Error parsing 'url' key from player live API refresh endpoint: ".concat(i," ").concat(e));return t.ku(e.url.hls).then((function(){return t.play(),t._u(5e3),null})).catch((function(){return t.Eu(++n)}))})).catch((function(){if(n>=3)throw new Error("Manifest failed to load after ".concat(n," attempts."));return++n,t.Eu(n)}))},i.Tu=function(){var t=this;this.on(mi.STREAM_OFFLINE,(function(){t.Ir=!1}))},i.Au=function(t){return this.Tu(),this.Ir=!0,this.fire(mi.STREAM_ONLINE),this._u(5e3),P.resolve(t)},i.ku=function(t){var n=this;return this.yu=t,/json=1/.test(t)?We(t).json().then((function(t){if(!("url"in t))throw new Error("Error parsing 'url' key from Live API manifest endpoint: ".concat(n.yu," ").concat(t));n.H.src=t.url,n.gu()})).catch((function(t){var i=n.video.metadata.playlistRefreshUrl;return We(i).json().then((function(t){if(!("url"in t))throw new Error("Error parsing 'url' key from player live API refresh endpoint: ".concat(i," ").concat(t));n.yu=t.url.ios,n.H.src=t.url.ios,n.gu()}))})):(this.H.src=t,this.gu(),P.resolve())},i._u=function(t){var n=this;"number"==typeof xi.iOS&&xi.iOS<9||this.mu||(this.mu=setTimeout((function(){if(n.Ir){var t=new XMLHttpRequest;t.onload=function(){410!==t.status?(200!==t.status&&n.fire(mi.STREAM_OFFLINE),t.response.match(/^#EXTM3U\n#EXT-X-VERSION:3\n$/)&&n.fire(mi.STREAM_OFFLINE)):n.Eu()},t.onerror=function(){n.fire(mi.STREAM_OFFLINE)},/json=1/.test(n.yu)?We(n.yu).json().then((function(i){"url"in i||n.fire(mi.STREAM_OFFLINE),t.open("GET",i.url),t.send()})).catch((function(){t.open("GET",n.yu),t.send()})):(t.open("GET",n.yu),t.send())}}),t))},i.setVideoSrc=function(t){var n=this;this.re=this.Au(t).then((function(){return n.yu=t,n.ku(t)}))},i.onprogress=function(){this.mu&&(clearTimeout(this.mu),this.mu=null)},i.onstalled=function(){this._u(1e4)},i.onerror=function(){var n=this;return this.H.error.code===this.H.error.MEDIA_ERR_SRC_NOT_SUPPORTED?(We(this.yu).then((function(){t.prototype.onerror.call(n)})).catch((function(i){i instanceof Oe?n.fire(li.ERROR,new TelecineError("MediaNetworkError","A network error ocurred while fetching the media.")):t.prototype.onerror.call(n)})),!1):t.prototype.onerror.call(this)},i.onwaiting=function(){this._u(1e4)},i.seekToTime=function(){},i.play=function(){var n=this;return t.prototype.play.call(this,(function(){return n.re}))},V(n,[{key:"currentTime",get:function(){return this.H.currentTime},set:function(t){this.H.currentTime=t}}]),n}(Ee),Dr=function(){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.Su=t,this.B=t.B,this.V=n}V(t,null,[{key:"displayName",get:function(){return"Effect"}},{key:"supported",get:function(){return!1}},{key:"supportedScanners",get:function(){return[]}}]);var n=t.prototype;return n.activate=function(){throw new TelecineError("NotImplemented","The effect must implement the activate method.")},n.deactivate=function(){throw new TelecineError("NotImplemented","The effect must implement the deactivate method.")},t}(),Pr=new x,Cr=new x,TelecineFile=function(){function TelecineFile(t,n){var i=t.src,e=t.mime,r=t.id,u=void 0===r?ie():r,o=t.priority,s=void 0===o?0:o,a=t.metadata,h=void 0===a?{}:a;if(!i)throw new TypeError("Must provide a src for the file.");if(!e)throw new TypeError("Must provide a mime type for the file.");Object.defineProperties(this,{mime:{value:e,enumerable:!0},id:{value:"".concat(u),enumerable:!0},metadata:{value:h,enumerable:!0}}),this.video=n,this.priority=s,this.src=i}return V(TelecineFile,[{key:"priority",get:function(){return Pr.get(this)},set:function(t){if(!("number"==typeof(t=parseInt(t,10))&&isFinite(t)&&Math.floor(t)===t&&t>=0))throw new TypeError("The file priority must be an integer greater than or equal to 0.");Pr.set(this,t)}},{key:"src",get:function(){return Cr.get(this)},set:function(t){Cr.set(this,t),this.video.fire(wi.FILE_SRC_UPDATE,this)}},{key:"restrictedStreamIndexes",get:function(){if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");return this.video.currentScanner.restrictedStreamIndexes},set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!Array.isArray(t))throw new TypeError("Indexes must be an array.");if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");this.video.currentScanner.restrictedStreamIndexes=t}}]),TelecineFile}();function xr(){return!!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration||window.WebKitMediaKeys)}function Lr(t,n,i){"string"==typeof n&&(n=function(t){for(var n=new ArrayBuffer(2*t.length),i=new Uint16Array(n),e=0,r=t.length;e<r;e++)i[e]=t.charCodeAt(e);return i}(n));var e=0,r=new ArrayBuffer(t.byteLength+4+n.byteLength+4+i.byteLength),u=new DataView(r);new Uint8Array(r,e,t.byteLength).set(t),e+=t.byteLength,u.setUint32(e,n.byteLength,!0),e+=4;var o=new Uint8Array(r,e,n.byteLength);return o.set(n),e+=o.byteLength,u.setUint32(e,i.byteLength,!0),e+=4,new Uint8Array(r,e,i.byteLength).set(i),new Uint8Array(r,0,r.byteLength)}function Ur(t){for(var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=n?t.buffer:t,e=String.fromCharCode.apply(null,new Uint16Array(i)),r=(new DOMParser).parseFromString(e,"application/xml"),u={},o=r.getElementsByTagName("HttpHeader"),s=0;s<o.length;++s){var a=o[s].querySelector("name"),h=o[s].querySelector("value");u[a.textContent]=h.textContent}var c=r.querySelector("Challenge");return[u,t=ee(c.textContent)]}function Hr(t,n,i,e){var r=e.audio||[],u=e.video||[],o=[{video:"HW_SECURE_ALL",audio:"SW_SECURE_CRYPTO"},{video:"HW_SECURE_DECODE",audio:"SW_SECURE_CRYPTO"},{video:"HW_SECURE_CRYPTO",audio:"SW_SECURE_CRYPTO"},{video:"SW_SECURE_DECODE",audio:"SW_SECURE_CRYPTO"},{video:"SW_SECURE_CRYPTO",audio:"SW_SECURE_CRYPTO"}].map((function(t){var n={persistentState:"optional",sessionTypes:["temporary"]};return u.length&&(n.videoCapabilities=u.map((function(n){return{contentType:n,robustness:t.video}}))),r.length&&(n.audioCapabilities=r.map((function(n){return{contentType:n,robustness:t.audio}}))),n})),s=Object.keys(t).map((function(e){var r=t[e].id;if(n||i){var u=null,s=n?window.WebKitMediaKeys:window.MSMediaKeys;try{u=new s(r)}catch(t){}return P.resolve({name:r,keySystem:u})}return navigator.requestMediaKeySystemAccess(r,o).then((function(t){return t.createMediaKeys()})).catch((function(t){})).then((function(t){return{name:r,keySystem:t}}))}));return P.all(s)}function Fr(t,n){var i={},e="".concat(window.screen.availWidth,"x").concat(window.screen.availHeight),r=window.devicePixelRatio;return i.merchant="vimeo",i.sessionId=JSON.stringify({ua:navigator.userAgent,token:t,resolution:e,pixelRatio:r}),i.userId=n,i}function Br(t,n){var i=null;return Object.keys(t).forEach((function(e){n.name===t[e].id&&(i=t[e])})),i}var Vr=function(){function t(t,n){this.Ru=t.cdms,this.Ou=t.lr_token,this.ju=t.user,this.Mu=t.asset,this.Iu=n,this.Nu=null,this.Du=null,this.Pu=null,this.Cu=null,this.xu=this.Lu.bind(this)}var n=t.prototype;return n.init=function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.H=t.H,this.Uu=t,xr()?(this.Hu=Fr(this.Ou,this.ju),Hr(this.Ru,this.Iu,!1,i).then((function(t){if(t.forEach((function(t){t.keySystem&&(n.Pu=t)})),!n.Pu)return n.Uu.fire(wi.EME_UNSUPPORTED),!1;var i=Br(n.Ru,n.Pu);return n.Cu="encrypted",n.Nu=i.license_url,n.Iu&&(n.Fu=i.certificate_url,n.Cu="webkitneedkey"),n.H.addEventListener(n.Cu,n.xu),n.Iu?(n.H.webkitSetMediaKeys(n.Pu.keySystem),!0):n.H.mediaKeys?(n.Du=n.H.mediaKeys.createSession(),n.Du.addEventListener("message",(function(t){return n.Bu(t)})),!0):(n.Du=n.Pu.keySystem.createSession(),n.Du.addEventListener("message",(function(t){return n.Bu(t)})),n.H.setMediaKeys(n.Pu.keySystem),!0)}))):(this.Uu.fire(wi.EME_UNSUPPORTED),!1)},n.destroy=function(){this.Du&&this.Du.sessionId&&this.Du.close(),this.H.removeEventListener(this.Cu,this.xu)},n.Lu=function(t){var n=this;return"com.apple.fps.1_0"===this.Pu.name?(this.Vu().then((function(i){n.qu="assetId=".concat(n.Mu);var e=Lr(t.initData,n.qu,i);return n.Du=n.Pu.keySystem.createSession("video/mp4",e),n.Du.addEventListener("webkitkeymessage",(function(t){return n.Bu(t)})),i})).catch((function(t){n.Uu.fire(t.error,t.payload)})),!0):!this.Du.sessionId&&!this.Wu&&(this.Wu=this.Du.generateRequest(t.initDataType,t.initData).catch((function(){n.Uu.fire(wi.DRM_FAILURE)})),!0)},n.Bu=function(t){var n=this;return new P((function(i,e){n.Wu=null;var r=new XMLHttpRequest;r.keySession=t.target,r.responseType="arraybuffer",r.open("POST",n.Nu),r.setRequestHeader("dt-custom-data",window.btoa(JSON.stringify(n.Hu)));var u=t.message;if("com.microsoft.playready"===n.Pu.name){var o=Ur(t.message,!1),s=o[0];Object.keys(s).forEach((function(t){r.setRequestHeader([t],s[t])})),u=o[1]}if("com.apple.fps.1_0"===n.Pu.name){var a=btoa(String.fromCharCode.apply(null,u));a=encodeURIComponent(a),u="spc=".concat(a,"&").concat(n.qu),r.setRequestHeader("Content-type","application/x-www-form-urlencoded")}r.onload=function(){if(403!==r.status)if(r.status>=400)e({error:wi.DRM_FAILURE});else try{n.Uu.fire(wi.DRM_AUTH_SUCCESS);var t=new Uint8Array(r.response),u=t.buffer;"com.apple.fps.1_0"===n.Pu.name&&(u=function(t){var n=window.atob(t.trim());return"<ckc>"===n.substr(0,5)&&"</ckc>"===n.substr(-6)&&(n=n.slice(5,-6)),new Uint8Array(atob(n).split("").map((function(t){return t.charCodeAt(0)})))}(btoa(String.fromCharCode.apply(null,t)))),r.keySession.update(u),i()}catch(t){e("Error updating key session: ".concat(t))}else{var o=JSON.parse(r.getResponseHeader("x-dt-error-message"));e({error:wi.DRM_AUTH_FAILURE,payload:{text:o.error,code:o.error_code}})}},r.onerror=e,r.send(u)})).catch((function(t){n.Uu.fire(t.error,t.payload)}))},n.Vu=function(){var t=this;return new P((function(n,i){var e=new XMLHttpRequest;e.responseType="arraybuffer",e.open("GET",t.Fu),e.setRequestHeader("dt-custom-data",window.btoa(JSON.stringify(t.Hu))),e.onload=function(){if(403!==e.status)if(e.status>=400)i({error:wi.DRM_FAILURE});else try{n(new Uint8Array(e.response))}catch(t){i(t)}else{var t=JSON.parse(e.getResponseHeader("x-dt-error-message"));i({error:wi.DRM_AUTH_FAILURE,payload:{text:t.error,code:t.error_code}})}},e.onerror=i,e.send()}))},t}(),qr=function(){function t(t,n){this.Ru=t.cdms,this.Mu=t.asset,this.Iu=n,this.Gu=null,this.Nu=null,this.Du=null,this.Pu=null,this.Cu=null,this.xu=this.Lu.bind(this),this.$u=this.Yu.bind(this)}var n=t.prototype;return n.init=function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.H=t.H,this.Uu=t,this.zu=!!window.MSMediaKeys,xr()||this.zu?Hr(this.Ru,this.Iu,this.zu,i).then((function(t){n.Pu=t.find((function(t){return t.keySystem}));var i=n.Pu&&Br(n.Ru,n.Pu);if(!i)throw n.Uu.fire(wi.EME_UNSUPPORTED),new Error("No valid key system was found.");n.Gu=i.license_url;var r=e&&e.inits&&e.inits[i.id];return r||n.Ku(i),n.Xu().then((function(){return r&&n.Lu(r.cenc)}))})):(this.Uu.fire(wi.EME_UNSUPPORTED),P.reject())},n.destroy=function(){this.Du&&this.Du.sessionId&&this.Du.close(),this.H.removeEventListener(this.Cu,this.xu)},n.Ku=function(t){this.Cu="encrypted",this.Nu=t.license_url,this.Iu?(this.Fu=t.certificate_url,this.Cu="webkitneedkey"):this.zu&&(this.Cu="msneedkey"),this.H.addEventListener(this.Cu,this.xu)},n.Xu=function(){var t=this;return new P((function(n){if(t.zu){var i=function i(){t.H.msSetMediaKeys(t.Pu.keySystem),t.H.removeEventListener("loadedmetadata",i),n()};t.H.readyState>=1?i():t.H.addEventListener("loadedmetadata",i)}else{if(t.Iu)t.H.webkitSetMediaKeys(t.Pu.keySystem);else{var e=t.H.mediaKeys||t.Pu.keySystem;t.Du=t.Ju(e),t.Du.addEventListener("message",(function(n){return t.Bu(n)})),t.H.mediaKeys||t.H.setMediaKeys(t.Pu.keySystem)}n()}}))},n.Ju=function(t,n,i){var e=t.createSession(n,i);if(!e)throw new Error("Could not create key session");return e},n.Lu=function(t){var n=this,i=new Error("A decryption key error was encountered");return"com.apple.fps.1_0"===this.Pu.name?(this.Vu(this.Fu).then((function(e){n.qu=function(t){var n=function(t){var n=new Uint16Array(t.buffer);return String.fromCharCode.apply(null,n)}(t),i=document.createElement("a");return i.href=n,i.hostname}(t.initData);var r=Lr(t.initData,n.qu,e);return n.Du=n.Ju(n.Pu.keySystem,"video/mp4",r),n.Du.contentId=n.qu,n.Du.addEventListener("webkitkeymessage",(function(t){return n.Bu(t)})),n.Du.addEventListener("webkitkeyerror",(function(t){throw i})),e})).catch((function(t){n.Uu.fire(t.error,t.payload)})),!0):"com.microsoft.playready"===this.Pu.name?(this.Du=this.Ju(this.H.msKeys,"video/mp4",t.initData),this.Du.addEventListener("mskeymessage",(function(t){return n.Bu(t)})),this.Du.addEventListener("mskeyerror",(function(t){throw i})),!0):!this.Du.sessionId&&!this.Wu&&(this.Du.addEventListener("keystatuseschange",this.$u),this.Wu=this.Du.generateRequest(t.initDataType,t.initData).catch((function(){n.Uu.fire(wi.DRM_FAILURE)})),!0)},n.Yu=function(){var t=!1,n=H(this.Du.keyStatuses.values());n.forEach((function(n,i){switch(n){case"expired":t=!0}})),n.every((function(t){return"output-restricted"===t}))&&this.Uu.fire(wi.DRM_OUTPUT_RESTRICTED),t&&this.Du.close()},n.Bu=function(t){var n=this;return this.Qu(this.Gu).then((function(i){return new P((function(e,r){n.Nu=i,n.Wu=null;var u=new XMLHttpRequest;u.keySession=t.target,u.open("POST",n.Nu),u.responseType="arraybuffer";var o=t.message;if("com.microsoft.playready"===n.Pu.name){var s=Ur(t.message),a=s[0];Object.keys(a).forEach((function(t){u.setRequestHeader(t,a[t])})),o=s[1]}"com.apple.fps.1_0"===n.Pu.name&&(o=new Uint8Array(o),u.setRequestHeader("Content-type","application/octet-stream")),u.onload=function(){if(403!==u.status)if(u.status>=400)r(new TelecineError(wi.DRM_FAILURE));else try{n.Uu.fire(wi.DRM_AUTH_SUCCESS);var t=new Uint8Array(u.response);u.keySession.update(t),e()}catch(t){r(new TelecineError(wi.DRM_FAILURE,"Error updating key session: ".concat(t)))}else r(new TelecineError(wi.DRM_AUTH_FAILURE))},u.onerror=r,u.send(o)})).catch((function(t){n.Uu.fire(t.name,{text:t.message||"License request failed."})}))}))},n.Qu=function(t){return new P((function(n,i){var e=new XMLHttpRequest;e.open("GET",t),e.onload=function(){if(e.status>=400)i(new TelecineError(wi.DRM_FAILURE));else try{try{var t=JSON.parse(e.response),r=t.licenseAcquisitionUrl,u=t.token;if(!r&&!u)throw new Error;n("".concat(r,"?ExpressPlayToken=").concat(u))}catch(t){n(e.response)}}catch(t){i(new TelecineError(wi.DRM_FAILURE,"Error retrieving License Acquisition URL (LA_URL): ".concat(t)))}},e.onerror=i,e.send()}))},n.Vu=function(t){return new P((function(n,i){var e=new XMLHttpRequest;e.open("GET",t),e.responseType="arraybuffer",e.setRequestHeader("Pragma","Cache-Control: no-cache"),e.setRequestHeader("Cache-Control","max-age=0"),e.onload=function(){if(403!==e.status)if(e.status>=400)i({error:wi.DRM_FAILURE});else try{n(new Uint8Array(e.response))}catch(t){i(t)}else i({error:wi.DRM_AUTH_FAILURE})},e.onerror=i,e.send()}))},t}(),Wr=new x,TelecineVideo=function(){function TelecineVideo(t){var n=this,i=t.files,e=t.id,r=void 0===e?ie():e,u=t.title,o=void 0===u?null:u,s=t.subtitle,a=void 0===s?null:s,h=t.metadata,c=void 0===h?{}:h,f=t.textTracks,d=void 0===f?Zi():f,v=t.externalDisplayFiles,l=void 0===v?{}:v,p=t.chapters,y=void 0===p?[]:p,w=t.duration;if(!i||!Array.isArray(i))throw new TypeError("Must provide files for the video.");et(this);var m=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.getFileById=Qi,t}(i.map((function(t){return t instanceof TelecineFile?(t.video=n,t):new TelecineFile(t,n)}))),b=Zi(d.map((function(t){return t instanceof TelecineTextTrack?(t.video=n,t):new TelecineTextTrack(t,n)})));Object.keys(l).forEach((function(t){!l[t]||l[t]instanceof TelecineFile||(l[t]=new TelecineFile(l[t],n))})),Object.defineProperties(this,{id:{value:"".concat(r),enumerable:!0},title:{value:o,enumerable:!0},subtitle:{value:a,enumerable:!0},metadata:{value:c,enumerable:!0},files:{value:m,enumerable:!0},textTracks:{value:b,enumerable:!0,writable:!0},chapters:{value:y,enumerable:!0},duration:{value:w,enumerable:!0},externalDisplayFiles:{value:l,enumerable:!0}}),c.drm&&(c.drm.fastly?this.Zu=new qr(c.drm,c.useHls):this.Zu=new Vr(c.drm,c.useHls))}return TelecineVideo.prototype.deactivate=function(){var t=this;this.Zu&&this.Zu.destroy(),this.textTracks.forEach((function(n){return t.currentScanner.removeTextTrack(n)}))},V(TelecineVideo,[{key:"drmHandler",get:function(){return this.Zu||null}},{key:"currentFile",get:function(){return this.currentScanner.currentFile},set:function(t){this.currentScanner.currentFile=t}},{key:"currentScanner",get:function(){return Wr.get(this)},set:function(t){var n=this;this.currentScanner&&this.currentScanner.constructor.supportsTextTracks&&this.textTracks.forEach((function(t){return n.currentScanner.removeTextTrack(t)})),t.constructor.supportsTextTracks&&this.textTracks.forEach((function(n){return t.addTextTrack(n)})),Wr.set(this,t)}},{key:"chapters",get:function(){return this.chapters}}]),TelecineVideo}(),Gr=function(){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.Su=t,this.V=n,this.to=null,this.no=this.V.embedTime?this.V.embedTime:0,this.io=!1,this.eo=!1,this.ro=!1,this.playInitiated=!1,this.uo=!1,this.oo=250,et(this),this.so=this.ao.bind(this),this.ho=this.co.bind(this),this.fo=this.do.bind(this),this.vo=this.lo.bind(this),this.po=this.yo.bind(this),this.wo=this.mo.bind(this),this.bo(this.Su.on),this.V.noInterval||this.Eo()}var n=t.prototype;return n.destroy=function(){clearInterval(this.to),this.bo(this.Su.off),this.ao()},n.bo=function(t){t(li.PAUSE,this.ho),t(li.PLAYING,this.so),t(li.SEEKING,this.fo),t(li.SEEKED,this.vo),t(mi.STREAM_ONLINE,this.po),t(mi.STREAM_OFFLINE,this.wo)},n.co=function(){this.userPlayState=!1},n.ao=function(){this.io&&(this.io=!1,this.fire(wi.BUFFER_ENDED))},n.do=function(){this.eo=!0},n.lo=function(){this.eo=!1},n.yo=function(){this.uo=!0},n.mo=function(){this.uo=!1},n.Eo=function(){clearInterval(this.to),this.to=setInterval(this.runIntervalCheck.bind(this),this.oo)},n.runIntervalCheck=function(){if(this.Su.video){var t=this.Su.video.currentScanner;if(t){var n=this.Su.isLive(),i=t.currentTime,e=this.oo/2/1e3;if(this.playInitiated&&(!this.eo||n)&&(!this.Su.paused||this.userPlayState)&&!this.io&&i<this.no+e){if(n&&!this.uo)return;for(var r=this.Su.buffered,u=0;u<r.length;u++)if(i>=r.start(u)&&i+.2<=r.end(u))return;if(i+e>=this.Su.duration)return;this.io=!0,this.fire(wi.BUFFER_STARTED)}(this.playInitiated&&this.io&&i>this.no+e||n&&!this.uo&&this.io)&&(this.io=!1,this.fire(wi.BUFFER_ENDED)),this.no=i}}},V(t,[{key:"userPlayState",get:function(){return this.ro},set:function(t){this.ro=t,t||this.ao()}}]),t}();function $r(){var t,n;function i(){t.src?document.createElement("video").load():t.load()}function e(){if(!n)return P.reject();t.preload="";var i=t.play();return void 0===i&&(i=new P((function(n){t.addEventListener("playing",n)}))),i}function r(){n&&(n.resolve(),n=null)}function u(t){n&&(n.reject(t),n=null)}return{set video(n){t=n},get active(){return!!n},start:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P.resolve.bind(P);return n||(n=new ft),i(),t().then(e).then(r).catch(u),n},cancel:function(){n&&(n.reject(new TelecineError("PlayInterrupted","The play() request was interrupted by a call to pause()")),n=null)}}}var Yr=function(){function t(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.B=t,this.ko=n,this.V=i,this.H=null,this.it=Zi(),this._o={},this.To=new Ee(t),this.V.playRequest=new $r,this.Ao=[],this.So=[],et(this)}var n=t.prototype;return n.supportsEffect=function(t){var n=this;return!!t.supported&&t.supportedScanners.some((function(t){return n.Ro(n.To)===t.displayName}))},n.getEffectByName=function(t){var n=this,i=null;return this.So.forEach((function(e){t===n.Oo(e)&&(i=e)})),i},n.activateEffect=function(t,n){var i=new t(this,n);return i.activate(),this.So.push(i),i},n.deactivateEffect=function(t){var n=this;return this.So.some((function(i,e){return i.constructor===t&&(i.deactivate(),n.So.splice(e,1),!0)}))},n.deactivateEffects=function(){var t=this;this.So.forEach((function(n){return t.deactivateEffect(n.constructor)}))},n.play=function(){if(!this.H||this.H.files.length<1)throw new TelecineError("NoFiles","There are no files to play.");this.jo.playInitiated||(this.jo.playInitiated=!0),this.jo.userPlayState=!0;var t=this.To.play();return this._o.paused=!1,t},n.pause=function(){if(!this.H||this.H.files.length<1)throw new TelecineError("NoFiles","There are no files to play.");return this.jo.userPlayState=!1,this.To.pause(),this._o.paused=!0,this},n.isLive=function(){return this.currentScannerName.includes("Live")},n.endLive=function(){this.To.endLive()},n.getBitrateAtTime=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video";return"MediaSourceScanner"!==this.Ro(this.To)&&"HLSLiveScanner"!==this.Ro(this.To)||"audio"===n&&this.To.Qt[n].length<=1?0:this.To.getBitrateAtTime(t,n)},n.getCurrentStream=function(){var t,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"video";return null==(t=(n=this.To).getCurrentStream)?void 0:t.call(n,i)},n.showExternalDisplayPicker=function(t){this.To.showExternalDisplayPicker(t)},n.supportsPresentationMode=function(t){return-1!==this.supportedPresentationModes.indexOf(t)},n.addChapter=function(t,n){this.To.addChapter(t,n)},n.removeChapter=function(t){this.To.removeChapter(t)},n.addCuePoint=function(t,n){return this.To.addCuePoint(t,n)},n.removeCuePoint=function(t){return this.To.removeCuePoint(t)},n.removeAllCuePoints=function(){return this.To.removeAllCuePoints()},n.addVideoEventListeners=function(){return this.To.addVideoEventListeners()},n.removeVideoEventListeners=function(){return this.To.removeVideoEventListeners()},n.Mo=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.textTrackSupport,e=void 0!==i&&i,r=this.H.files.sort((function(t,n){return t.priority-n.priority})),u=this.ko,o=function(n){var i=r[n];for(var o in u){var s=u[o];if(s.supported&&(!e||s.supportsTextTracks)&&-1===t.Ao.indexOf(t.Ro(s))&&s.supportedVideoTypes.some((function(t){return i.mime===t})))return{v:s}}};for(var s in r){var a=o(s);if("object"===F(a))return a.v}return e?(this.ht("TextTracksNotSupported","None of the scanners support text tracks in this browser."),this.Ao=[],this.Mo()):null},n.Io=function(t,n){var i=this;if(this.To.constructor!==t||this.To.video!==n){this.To.deactivate();var e=new t(this.B,this.V);Object.keys(ki).forEach((function(t){var n=ki[t];e.on(n,(function(t){return i.No(n,t,e)}))})),this.To=e,n.currentScanner=e,this.To.video=n;for(var r=Object.keys(this._o),u=0;u<r.length;u++){var o=r[u];"paused"!==o?"currentTime"!==o&&(this.To[o]=this._o[o]):!1===this._o.paused&&this.To.play()}this.To.addChapters(n.chapters,n.duration),this.fire(wi.SCANNER_CHANGE,this.Ro(this.To))}},n.Do=function(){if(null!==this.H){var t=this.Mo({textTrackSupport:this.H.textTracks.length>0});t?this.Io(t,this.H):this.ht("FilesNotPlayable","None of the files could be played in this browser.")}},n.Po=function(){this.To.deactivate(),this.To=new Ee(this.B)},n.No=function(t,n,i){if(i===this.To){switch(t){case li.ERROR:return void(n instanceof TelecineError&&this.fire(li.ERROR,n));case wi.SCANNER_ERROR:this.ht("ScannerError","The current scanner can no longer be used because ".concat(n.reason)),this.Ao.push(this.Ro(this.To)),this.Do([]);break;case wi.FILE_ERROR:this.ht("FileError","The current file can no longer be used because ".concat(n.reason)),this.To.ct();break;case wi.DOWNLOAD_ERROR:this.ht("DownloadError",n),this.To.ct();break;case wi.EME_UNSUPPORTED:this.ht("DRMFailure",{text:null,code:"emeunsupported"});break;case wi.DRM_FAILURE:case wi.DRM_AUTH_FAILURE:this.ht("DRMFailure",{text:n.text,code:n.code});break;case wi.DRM_OUTPUT_RESTRICTED:this.ht("DRMFailure",{text:null,code:"outputrestricted"});break;case wi.DRM_AUTH_SUCCESS:this.fire(wi.DRM_AUTH_SUCCESS);break;case li.TIME_UPDATE:this._o.currentTime=this.To.currentTime;break;case wi.MEDIA_URL_EXPIRED:this.ht("MediaUrlExpired",n);break;case wi.MEDIA_URL_BAD_REQUEST:this.ht("MediaUrlBadRequest",n);break;case Ei.BRAIN_ML_MODEL_ERR:this.ht("MimirError",n);break;case Ei.BRAIN_ML_MODEL_NET_ERR:this.ht("MimirNetworkError",n);break;case Ei.BRAIN_ML_MODEL_TIMEOUT:this.ht("MimirNetworkTimeout",n);break;case bi.SPATIAL_UNSUPPORTED:this.getEffectByName("ThreeSixtyEffect").deactivate();break;case li.ENDED:this._o.paused=!0;break;case li.WAITING:this.fire(li.WAITING)}this.So.forEach((function(n){"function"==typeof n["on".concat(t)]&&n["on".concat(t)]()})),this.fire(t,n)}},n.ht=function(t,n){this.fire(li.ERROR,new TelecineError(t,n))},n.Ro=function(t){return t instanceof Ee?t.constructor.displayName:t.prototype.constructor.displayName},n.Eo=function(){var t=this;this.jo&&this.jo.destroy(),this.jo=new Gr(this,this.V),this.jo.on(wi.BUFFER_STARTED,(function(){t.fire(wi.BUFFER_STARTED)})),this.jo.on(wi.BUFFER_ENDED,(function(){t.fire(wi.BUFFER_ENDED)}))},n.Oo=function(t){return t instanceof Dr?t.constructor.displayName:t.prototype.constructor.displayName},n.Co=function(t){"HLSLiveScanner"===this.Ro(this.To)&&this.To.setCaptionsState(t)},V(t,[{key:"element",get:function(){return this.B}},{key:"videoElement",get:function(){return this.To.videoElement}},{key:"manifest",get:function(){return this.To.manifest||{video:[]}}},{key:"supportsSettingVolume",get:function(){return this.ko.some((function(t){return t.supported&&t.supportsSettingVolume}))}},{key:"supportsPlaybackRate",get:function(){return this.To.constructor.supportsPlaybackRate}},{key:"supportsTextTracks",get:function(){return this.ko.some((function(t){return t.supported&&t.supportsTextTracks}))}},{key:"activeEffects",get:function(){return this.So}},{key:"isLowerProfileAvailable",get:function(){return this.To.isLowerProfileAvailable}},{key:"buffered",get:function(){return this.To.buffered}},{key:"bufferTarget",get:function(){return this.To.bufferTarget},set:function(t){this._o.bufferTarget=t,this.To.bufferTarget=t}},{key:"presentationDelay",get:function(){return this.To.presentationDelay},set:function(t){this._o.presentationDelay=t,this.To.presentationDelay=t}},{key:"manifestLoadDurations",get:function(){return this.To.manifestLoadDurations?this.To.manifestLoadDurations:[]}},{key:"successfulSegments",get:function(){return this.To.successfulSegments?this.To.successfulSegments:[]}},{key:"failedSegments",get:function(){return this.To.failedSegments?this.To.failedSegments:[]}},{key:"cuePoints",get:function(){return this.To.cuePoints}},{key:"currentChapterID",get:function(){return this.To&&this.To.chaptersTrack&&this.To.chaptersTrack.activeCues.length?this.To.chaptersTrack.activeCues[0].id:null}},{key:"chapters",get:function(){return this.To.chaptersTrack?this.To.chaptersTrack.cues:[]}},{key:"chaptersTrack",get:function(){return this.To.chaptersTrack}},{key:"currentFile",get:function(){return this.To.currentFile},set:function(t){if("string"==typeof t&&(t=this.vt.filter((function(n){return n.id===t}))[0]),!t)throw new TelecineError("FileNotValid","The file is not valid.");this.To.currentFile=t}},{key:"currentScannerName",get:function(){return this.Ro(this.To)}},{key:"currentTime",get:function(){return this.To.currentTime},set:function(t){this._o.currentTime=t,this.To.currentTime=t}},{key:"duration",get:function(){return this.To.duration}},{key:"ended",get:function(){return this.To.ended}},{key:"externalDisplayAvailable",get:function(){return this.To.externalDisplayAvailable}},{key:"externalDisplayActive",get:function(){return this.To.externalDisplayActive}},{key:"loop",get:function(){return this.To.loop},set:function(t){this._o.loop=t,this.To.loop=t}},{key:"muted",get:function(){return this.To.muted},set:function(t){this._o.muted=!!t,this.To.muted=!!t}},{key:"playsinline",get:function(){return this.To.playsinline},set:function(t){this._o.playsinline=!!t,this.To.playsinline=!!t}},{key:"paused",get:function(){return this.To.paused}},{key:"played",get:function(){return this.To.played}},{key:"seekable",get:function(){return this.To.seekable}},{key:"seeking",get:function(){return this.To.seeking}},{key:"defaultPlaybackRate",get:function(){return this.To.defaultPlaybackRate},set:function(t){this._o.defaultPlaybackRate=t,this.To.defaultPlaybackRate=t}},{key:"playbackRate",get:function(){return this.To.playbackRate},set:function(t){this._o.playbackRate=t,this.To.playbackRate=t}},{key:"preload",get:function(){return this.To.preload},set:function(t){this._o.preload=t,this.To.preload=t}},{key:"presentationMode",get:function(){return this.To.presentationMode},set:function(t){this.To.presentationMode=t}},{key:"supportedPresentationModes",get:function(){return this.To.supportedPresentationModes}},{key:"video",get:function(){return this.H},set:function(t){this.H&&this.H.deactivate(),this.Ao=[],this.Eo(),null===t?(this.H=null,this.Po()):(this.H=new TelecineVideo(t),this.Do())}},{key:"videoWidth",get:function(){return this.To.videoWidth}},{key:"videoHeight",get:function(){return this.To.videoHeight}},{key:"volume",get:function(){return this.To.volume},set:function(t){if(t<0||t>1)throw new TelecineError("IndexSizeError","Failed to set the 'volume' property: The volume provided (".concat(t,") is outside of the range [0, 1]."));this._o.volume=t,this.To.volume=t}},{key:"brainDebug",get:function(){return this.To.brainDebug}}]),t}(),zr=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).xo=!1,i.H=i.Su.To.H,i}$(n,t),V(n,null,[{key:"displayName",get:function(){return"CanvasEffect"}},{key:"supported",get:function(){return!0}},{key:"supportedScanners",get:function(){return[Ee,lr]}}]);var i=n.prototype;return i.activate=function(){this.xo=!0,this.Lo=document.createElement("canvas"),this.Lo.className="vp-canvas-effect",this.Lo.style.cssText="\n            position: absolute;\n            top:0;\n            left:0;\n            bottom:0;\n            right:0;\n        ",this.Uo=this.Lo.getContext("2d",{alpha:!1}),this.B.appendChild(this.Lo),this.Ho()},i.deactivate=function(){this.Lo&&this.B.removeChild(this.Lo),this.Fo(),this.xo=!1},i.Ho=function(){this.Bo()},i.Bo=function(){this.Vo=window.requestAnimationFrame(this.qo.bind(this))},i.qo=function(){var t=this.H,n=this.Lo;n.width=t.clientWidth,n.height=t.clientHeight;var i=Math.floor(this.Wo()),e=Math.floor(this.Go()),r=Math.floor((t.clientWidth-i)/2),u=Math.floor((t.clientHeight-e)/2);this.Uo.fillStyle="#000",this.Uo.fillRect(0,0,n.width,n.height),this.Uo.drawImage(t,r,u,i,e),this.Bo()},i.$o=function(){return this.H.videoHeight/this.H.videoWidth},i.Wo=function(){return Math.min(this.H.clientHeight/this.$o(),this.H.clientWidth)},i.Go=function(){return Math.min(this.H.clientWidth*this.$o(),this.H.clientHeight)},i.Fo=function(){this.Vo&&(window.cancelAnimationFrame(this.Vo),this.Vo=null)},n}(Dr),Kr=function(){function t(){}return V(t,null,[{key:"Equirect",get:function(){return"equirectangular"}}]),t}(),Xr=function(){function t(){}return V(t,null,[{key:"Mono",get:function(){return"mono"}},{key:"TopBottom",get:function(){return"top-bottom"}}]),t}(),Jr=function(){function t(t,n,i){switch(this.isStereo=n!==Xr.Mono,this.Yo=null,this.zo=null,t){case Kr.Equirect:this.createEquirectProjection(i,n);break;default:this.createEquirectProjection(i,Xr.Mono)}}var n=t.prototype;return n.createEquirectProjection=function(t,n){switch(n){case Xr.Mono:this.Yo=this.Ko(t);break;case Xr.TopBottom:this.Yo=this.Ko(t),this.zo=this.Ko(t),this.Yo.layers.set(1),this.zo.layers.set(2),this.Xo(this.Yo.geometry,.5,0),this.Xo(this.zo.geometry,.5,.5)}},n.Ko=function(n,i,e,r){var u=new THREE.SphereBufferGeometry(i||t.SPHERE_RADIUS,e||t.TESSELATION_WIDTH,r||t.TESSELATION_HEIGHT);u.scale(-1,1,1);var o=new THREE.MeshBasicMaterial({map:n});return new THREE.Mesh(u,o)},n.Xo=function(t,n,i){for(var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=0;r<t.attributes.uv.array.length;r+=2)t.attributes.uv.array[r+e]*=n,t.attributes.uv.array[r+e]+=i},V(t,[{key:"left",get:function(){return this.Yo}},{key:"right",get:function(){return this.zo}}],[{key:"TESSELATION_WIDTH",get:function(){return 120}},{key:"TESSELATION_HEIGHT",get:function(){return 80}},{key:"SPHERE_RADIUS",get:function(){return 500}}]),t}(),Qr=function(){function t(t){this.Jo=t}var n=t.prototype;return n.hasVRHeadset=function(){var t=this;return xi.webvr?navigator.getVRDisplays().then((function(n){return n.length>0?(t.Jo.vr.setDevice(n[0]),n[0]):null})):null},n.enter=function(){return this.Jo.vr.getDevice()&&this.Jo.vr.getDevice().requestPresent([{source:this.Jo.domElement}])},n.exit=function(){return this.Jo.vr.getDevice()&&this.Jo.vr.getDevice().exitPresent()},V(t,[{key:"supported",get:function(){return xi.webvr}},{key:"device",get:function(){return this.Jo&&this.Jo.vr.getDevice()?this.Jo.vr.getDevice():null}},{key:"isPresenting",get:function(){return!(!this.Jo||!this.Jo.vr.getDevice())&&this.Jo.vr.getDevice().isPresenting}}]),t}(),Zr=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).xo=!1,i.Qo=null,i.Zo=null,i.Jo=null,i.isUserInteracting=!1,i.ts=0,i.ns=0,i._coordinates={lat:0,long:0},i.es={lat:0,long:0},i.rs={lat:0,long:0},i.us=i.cameraProps,i.os=0,i.ss=0,i.as=0,i.H=i.Su.To.H,i.hs=null,i.cs={x:0,y:0},i.fs={lat:0,long:0},i.ds={videoFps:i.V.fps,motionRenderSpeed:60},i.vs=1e3/i.ds.videoFps,i.ls=[],i.ps=!1,i.ys=!1,i.ws=!1,i.ms={up:!1,down:!1,left:!1,right:!1},i}$(n,t),V(n,[{key:"isUserInteracting",set:function(t){t!==this.bs&&(this.bs=t,t?this.V.isMobile||this.Su.fire(bi.MOTION_START):this.V.isMobile||this.Su.fire(bi.MOTION_END))},get:function(){return this.bs}}],[{key:"displayName",get:function(){return"ThreeSixtyEffect"}},{key:"supported",get:function(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(t){return this.Su.To.fire(bi.SPATIAL_UNSUPPORTED),!1}}},{key:"supportedScanners",get:function(){return[Ee,lr]}}]),n.frustumSurfaceArea=function(t,n,i){var e=2*Jr.SPHERE_RADIUS*2*Math.sin(Math.PI/180*(t/2));return e*(e*n/i)/(4*Math.PI*Math.pow(Jr.SPHERE_RADIUS,2))};var i=n.prototype;return i.activate=function(){var t=this;return new P((function(n,i){if(window.THREE)n();else{var e=document.createElement("script");e.src=t.V.threeUrl,document.body.appendChild(e),e.onload=function(){n()}}})).then((function(){return t.Ot()}))},i.Ot=function(){var t=this;this.xo=!0,this.Qo=new THREE.PerspectiveCamera(this.V.fieldOfView,this.H.clientWidth/this.H.clientHeight,1,2*Jr.SPHERE_RADIUS),this.Qo.target=new THREE.Vector3(0,0,0),this.Qo.layers.enable(1),this.Es(this.V.directorTimeline),this.Zo=new THREE.Scene,this.ks=new THREE.VideoTexture(this.H),this.ks.generateMipmaps=!1,this.ks.minFilter=THREE.NearestFilter,this.ks.maxFilter=THREE.NearestFilter,this.ks.format=THREE.RGBFormat,this._s=new Jr(this.V.projection,this.V.stereoMode,this.ks),this._s.isStereo&&this.Zo.add(this._s.right),this.Zo.add(this._s.left),this.Jo=new THREE.WebGLRenderer,this.Jo.vr.enabled=!0,this.Jo.setPixelRatio(window.devicePixelRatio),this.Ts=document.createElement("div"),this.Ts.appendChild(this.Jo.domElement),this.B.appendChild(this.Ts),this.As(),this.Su.To.H.setAttribute("crossorigin","anonymous"),this.Ho(),this.Su.To.paused||this.Ss(),this.Rs=new Qr(this.Jo),this.Rs.supported&&this.Rs.hasVRHeadset().then((function(n){setTimeout((function(){t.Su.fire(bi.WEBVR_HARDWARE_AVAILABLE,t.Rs.device)}),100)})).catch((function(t){}))},i.toggleVR=function(){var t=this;if(this.Rs.isPresenting)this.Rs.exit().then((function(){t.adjustRenderSize()})).catch((function(t){}));else{if(this.Su.To.paused)return;this.Rs.enter().then((function(){t.adjustRenderSize()})).catch((function(t){}))}},i.onplay=function(){this.xo&&(this.Ss(),this.adjustRenderSize())},i.deactivate=function(){this.Ts&&this.B.removeChild(this.Ts),this.Fo(),this.xo=!1},i.snapToCenter=function(){var t=this;this.ls.forEach((function(t){return clearTimeout(t)}));var n=((this._coordinates.long>=180?360:0)-this._coordinates.long)/11,i=(0-this._coordinates.lat)/11;this.as=0;for(var e=function(e){t.ls.push(setTimeout((function(){0===e&&(t.ps=!0,t.V.isMobile||(t.vs=1e3/t.ds.motionRenderSpeed)),49===e&&(t.ps=!1,t.V.isMobile||(t.vs=1e3/t.ds.videoFps)),t.Os(t._coordinates.lat+i/Math.pow(1.1,e),t._coordinates.long+n/Math.pow(1.1,e)),t.fs.lat=THREE.Math.radToDeg(t.cs.x)+t._coordinates.lat+i/Math.pow(1.1,e),t.fs.long=THREE.Math.radToDeg(t.cs.y)+t._coordinates.long+i/Math.pow(1.1,e)}),e*t.vs))},r=0;r<50;r++)e(r)},i.isStereo=function(){return!!this._s&&this._s.isStereo},i.Es=function(t){t&&t[0]&&void 0!==t[0].p&&"undefined"!==t[0].y&&this.Os(t[0].p,t[0].y)},i.Os=function(t,n){this.es.long=this._coordinates.long,this.es.lat=this._coordinates.lat,t%=360,this._coordinates.lat=Math.max(-85,Math.min(85,t)),n=(n%=360)>=0?n:360+n,this._coordinates.long=n},i.makeContact=function(t){this.isUserInteracting=!0,this.ls.forEach((function(t){return clearTimeout(t)})),this.ps=!1,this.Ms={x:t.x,y:t.y},this.rs.long=this._coordinates.long,this.rs.lat=this._coordinates.lat,this.Is={long:this._coordinates.long,lat:this._coordinates.lat},this.V.isMobile||(this.vs=1e3/this.ds.motionRenderSpeed)},i.move=function(t){this.fs.lat=THREE.Math.radToDeg(this.cs.x)+this.es.lat,this.fs.long=THREE.Math.radToDeg(this.cs.y)+this.es.long;var n=this.Is.lat-.2*(this.Ms.y-t.y),i=.2*(this.Ms.x-t.x)+this.Is.long;this.Os(n,i)},i.moveWheel=function(t){this.fs.lat=THREE.Math.radToDeg(this.cs.x)+this.es.lat,this.fs.long=THREE.Math.radToDeg(this.cs.y)+this.es.long;var n=this._coordinates.lat-.1*t.y,i=this._coordinates.long+.1*t.x;this.Os(n,i)},i.moveDevice=function(t,n,i,e){this.ws=!0;var r=new THREE.Quaternion,u=window.orientation;null===u&&(u=this.H.clientWidth>this.H.clientHeight?90:0),t=t?THREE.Math.degToRad(t):0,n=n?THREE.Math.degToRad(n):0,i=i?THREE.Math.degToRad(i):0;var o=u?THREE.Math.degToRad(u):0,s=new THREE.Vector3(0,0,1),a=new THREE.Euler,h=new THREE.Quaternion,c=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));a.set(n,t,-i,"YXZ"),r.setFromEuler(a),r.multiply(c),r.multiply(h.setFromAxisAngle(s,-o)),this.cs=(new THREE.Euler).setFromQuaternion(r,"YXZ"),this.as=this.cs.z,this.isUserInteracting||this.ps||this.Os(THREE.Math.radToDeg(this.cs.x)-this.fs.lat,-THREE.Math.radToDeg(this.cs.y)+this.fs.long),this.ys||(this.snapToCenter(),this.Su.fire(bi.MOTION_START),this.ys=!0)},i.releaseContact=function(t){if(this.fs.lat=THREE.Math.radToDeg(this.cs.x)-this._coordinates.lat,this.fs.long=THREE.Math.radToDeg(this.cs.y)+this._coordinates.long,this.isUserInteracting=!1,this.Is&&!t){var n=Math.hypot(this._coordinates.long-this.Is.long,this._coordinates.lat-this.Is.lat);this.Ns(n)}},i.abandonMotion=function(){this.isUserInteracting=!1,this.Is=null},i.keyPress=function(t){this.Ds()||(this.isUserInteracting=!0,this.ls&&this.ls.forEach((function(t){return clearTimeout(t)}))),this.ms[t]||(this.ms[t]=!0)},i.keyUp=function(t){this.ms[t]=!1,this.Ds()||(this.isUserInteracting=!1,this.Ns(1/0))},i.Ps=function(){var t=this;Object.keys(this.ms).forEach((function(n){if(t.ms[n])switch(n){case"up":t.Os(t._coordinates.lat+2,t._coordinates.long);break;case"down":t.Os(t._coordinates.lat-2,t._coordinates.long);break;case"left":t.Os(t._coordinates.lat,t._coordinates.long-2);break;case"right":t.Os(t._coordinates.lat,t._coordinates.long+2)}}))},i.Ds=function(){var t=this;return Object.keys(this.ms).map((function(n){return t.ms[n]})).some((function(t){return t}))},i.Ns=function(t){var n=this;t>=20&&function(){var i={long:n._coordinates.long-n.es.long,lat:n._coordinates.lat-n.es.lat};t===1/0&&(i.long/=2,i.lat/=2);for(var e=function(t){n.ls.push(setTimeout((function(){1===t&&(n.ps=!0),49===t&&(n.ps=!1,n.vs=1e3/n.ds.videoFps);var e=2/Math.pow(t,1.5);n.fs.lat=THREE.Math.radToDeg(n.cs.x)+n._coordinates.lat+i.lat,n.fs.long=THREE.Math.radToDeg(n.cs.y)+n._coordinates.long+i.long,n.Os(n._coordinates.lat+i.lat*e,n._coordinates.long+i.long*e)}),t*n.vs))},r=1;r<50;r++)e(r)}()},i.onseeked=function(){this.xo&&this.Cs()},i.onresize=function(){this.adjustRenderSize(),this.isUserInteracting=!1},i.Cs=function(){if(!this.isVRPresenting){this.os=THREE.Math.degToRad(90+this._coordinates.lat),this.ss=THREE.Math.degToRad(this._coordinates.long),this.Qo.position.set(Math.sin(this.os)*Math.cos(this.ss),Math.cos(this.os),Math.sin(this.os)*Math.sin(this.ss)),this.Qo.lookAt(this.Qo.target),this.Qo.rotation.z+=this.as;var t=this.cameraProps;this.Su.fire(bi.CAMERA_UPDATE,t),this.us.yaw===t.yaw&&this.us.pitch===t.pitch&&this.us.roll===t.roll&&this.us.fov===t.fov||(this.us=t,this.Su.fire(bi.CAMERA_CHANGE,t))}this.Jo.render(this.Zo,this.Qo)},i.adjustRenderSize=function(){if(this.isVRPresenting)this.Qo.aspect=this.H.clientWidth/this.H.clientHeight,this.Qo.updateProjectionMatrix(),this.Jo.setSize(this.H.clientWidth,this.H.clientHeight);else{this.H.clientWidth>this.H.clientHeight?this.Qo.aspect=Math.max(1,Math.min(2,this.H.clientWidth/this.H.clientHeight)):this.Qo.aspect=Math.max(1/3,Math.min(3,this.H.clientWidth/this.H.clientHeight)),this.Qo.updateProjectionMatrix();var t=ue(this.H.clientWidth,this.H.clientHeight,this.Qo.aspect,1);this.Jo.setSize(t.width,t.height),this.Ts.style.paddingTop="".concat(t.top,"px")}},i.Ho=function(){var t=this;this.Jo.setAnimationLoop((function(){t.Ds()&&t.Ps(),t.Cs()}))},i.Fo=function(){this.Jo.setAnimationLoop(null)},i.Ss=function(){this.xs({backgroundColor:"#000",display:"block"})},i.As=function(){this.xs({backgroundColor:"#000",display:"none"})},i.xs=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.backgroundColor,i=t.display;this.Ts.style.cssText="position:absolute;left:0;top:0;margin-left:auto;margin-right:auto;padding:0;background:".concat(n,";width:100%;height:100%;text-align:center;display:").concat(i)},V(n,[{key:"currentCoordinates",get:function(){return this._coordinates},set:function(t){var n=Z(t,2),i=n[0],e=n[1];if(i>90||i<-90)throw new RangeError("Latitude should be a float between -90 and 90.");if(e<0||e>360)throw new RangeError("Longitude should be a float between 0 and 360.");this.Os(i,e),this.Cs()}},{key:"cameraProps",get:function(){return{yaw:this._coordinates.long,pitch:this._coordinates.lat,roll:this.roll,fov:this.fieldOfView}},set:function(t){t=G(G({},this.cameraProps),t),this.fieldOfView=t.fov,this.roll=t.roll,this.currentCoordinates=[t.pitch,t.yaw]}},{key:"roll",get:function(){return 180*this.as/Math.PI},set:function(t){if(t<-180||t>180)throw new RangeError("Roll should be a float between -180 and 180.");this.as=THREE.Math.degToRad(t)}},{key:"isVRPresenting",get:function(){return this.Rs&&this.Rs.isPresenting}},{key:"fieldOfView",get:function(){return this.Qo?this.Qo.fov:this.V.fieldOfView},set:function(t){this.Qo.fov=t,this.Qo.updateProjectionMatrix(),this.Jo.render(this.Zo,this.Qo)}},{key:"hasVRHeadset",get:function(){return this.Rs&&!!this.Rs.device}}]),n}(Dr);function tu(t){return"symbol"==F(t)||Sn(t)&&"[object Symbol]"==jt(t)}var nu=/^\s+|\s+$/g,iu=/^[-+]0x[0-9a-f]+$/i,eu=/^0b[01]+$/i,ru=/^0o[0-7]+$/i,uu=parseInt;function ou(t){if("number"==typeof t)return t;if(tu(t))return NaN;if(Mt(t)){var n="function"==typeof t.valueOf?t.valueOf():t;t=Mt(n)?n+"":n}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(nu,"");var i=eu.test(t);return i||ru.test(t)?uu(t.slice(2),i?2:8):iu.test(t)?NaN:+t}var su=kt?kt.prototype:void 0,au=su?su.toString:void 0;function hu(t){if("string"==typeof t)return t;if(Nn(t))return function(t,n){for(var i=-1,e=null==t?0:t.length,r=Array(e);++i<e;)r[i]=n(t[i],i,t);return r}(t,hu)+"";if(tu(t))return au?au.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}function cu(t){return null==t?"":hu(t)}var fu=Et.isFinite,du=Math.min,vu=function(t){var n=Math.round;return function(t,i){if(t=ou(t),(i=null==i?0:du(function(t){var n=function(t){return t?(t=ou(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}(t),i=n%1;return n==n?i?n-i:n:0}(i),292))&&fu(t)){var e=(cu(t)+"e").split("e");return+((e=(cu(n(e[0]+"e"+(+e[1]+i)))+"e").split("e"))[0]+"e"+(+e[1]-i))}return n(t)}}();function lu(t){return!isNaN(t)}function pu(t){return vu(t,3)}var yu=0;function wu(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"b",n=++yu;return"".concat(t).concat(n)}wu(),wu();var mu=wu(),bu=wu(),gu=wu(),Eu=wu(),ku=wu(),_u=wu(),Tu=wu(),Au=wu(),Su=wu(),Ru=wu(),Ou=wu(),ju=wu(),Mu=wu(),Iu=wu(),Nu=wu(),Du=wu(),Pu=wu(),Cu=wu(),xu=wu(),Lu=wu(),Uu=Object.freeze({__proto__:null,CONFIG_CHANGED:Au,TELECINE_READY:Su,TELECINE_VIDEO_INIT:Ru,PLAY_INITIATED:Ou,QUALITY_CHANGED:ju,FORCED_QUALITY:Mu,CUE_CHANGED:Iu,CAPTIONS_CHANGED:Nu,SPATIAL_PLAYBACK_TOGGLED:Du,PICTURE_IN_PICTURE_AVAILABLE:Pu,PICTURE_IN_PICTURE_NOT_AVAILABLE:Cu,PICTURE_IN_PICTURE_ACTIVATED:xu,PICTURE_IN_PICTURE_DEACTIVATED:Lu}),Hu=Object.freeze({__proto__:null,EVENT_PENDING:"liveeventpending",EVENT_ACTIVE:"liveeventactive",EVENT_STARTING:"liveeventstarting",EVENT_STARTED:"liveeventstarted",EVENT_ENDED:"liveeventended",ARCHIVE_STARTED:"livearchivestarted",ARCHIVE_DONE:"livearchivedone",ARCHIVE_ERROR:"livearchiveerror"}),Fu={h264:"video/mp4",hls:"application/vnd.apple.mpegurl",hlsLive:"application/x-mpegURL",dash:"application/vnd.vimeo.dash+json",dashMpd:"video/vnd.mpeg.dash.mpd",vp6:"video/x-flv",vp8:"video/webm",webm:"video/webm",hds:"application/f4m"},Bu={"application/vnd.apple.mpegurl":"hls","application/vnd.vimeo.dash+json":"dash","video/vnd.mpeg.dash.mpd":"dash","video/mp4":"progressive","video/webm":"progressive","video/x-flv":"progressive","application/x-mpegURL":"hlslive"},Vu=(G(G(G(G(G(G(G(G(G({},li),wi),mi),Hu),bi),pi),gi),Ei),Uu),G(G({},mi),Hu));function qu(t){var n;return"done"===(null==t||null==(n=t.archive)?void 0:n.status)}function Wu(t){return"pending"===(null==t?void 0:t.status)}function Gu(t){return"started"===(null==t?void 0:t.status)}function $u(t){return"ended"===(null==t?void 0:t.status)}function Yu(t){return zu(t,"/playlist/refresh")}function zu(t,n){var i,e=null==(i=t.request.files.hls)?void 0:i.default_cdn,r=t.request,u=r.signature,o=r.timestamp,s=r.expires,a="https://".concat(t.player_url,"/live/").concat(t.video.id),h="?signature=".concat(u,"&time=").concat(o,"&expires=").concat(s,"&cdn=").concat(e);return"".concat(a).concat(n).concat(h)}var Ku=En(Object.keys,Object),Xu=Object.prototype.hasOwnProperty;function Ju(t){if(!Tn(t))return Ku(t);var n=[];for(var i in Object(t))Xu.call(t,i)&&"constructor"!=i&&n.push(i);return n}var Qu=Vt(Et,"DataView"),Zu=Vt(Et,"Promise"),to=Vt(Et,"Set"),no=Vt(Et,"WeakMap"),io=Ct(Qu),eo=Ct(Qt),ro=Ct(Zu),uo=Ct(to),oo=Ct(no),so=jt;(Qu&&"[object DataView]"!=so(new Qu(new ArrayBuffer(1)))||Qt&&"[object Map]"!=so(new Qt)||Zu&&"[object Promise]"!=so(Zu.resolve())||to&&"[object Set]"!=so(new to)||no&&"[object WeakMap]"!=so(new no))&&(so=function(t){var n=jt(t),i="[object Object]"==n?t.constructor:void 0,e=i?Ct(i):"";if(e)switch(e){case io:return"[object DataView]";case eo:return"[object Map]";case ro:return"[object Promise]";case uo:return"[object Set]";case oo:return"[object WeakMap]"}return n});var ao=so,ho=Object.prototype.hasOwnProperty;function co(t){if(null==t)return!0;if(Pn(t)&&(Nn(t)||"string"==typeof t||"function"==typeof t.splice||Un(t)||Jn(t)||In(t)))return!t.length;var n=ao(t);if("[object Map]"==n||"[object Set]"==n)return!t.size;if(Tn(t))return!Ju(t).length;for(var i in t)if(ho.call(t,i))return!1;return!0}function fo(t){return Pn(t)?ui(t):Ju(t)}function vo(){return[]}var lo=Object.prototype.propertyIsEnumerable,po=Object.getOwnPropertySymbols,yo=po?function(t){return null==t?[]:(t=Object(t),function(t,n){for(var i=-1,e=null==t?0:t.length,r=0,u=[];++i<e;){var o=t[i];n(o)&&(u[r++]=o)}return u}(po(t),(function(n){return lo.call(t,n)})))}:vo;function wo(t,n){for(var i=-1,e=n.length,r=t.length;++i<e;)t[r+i]=n[i];return t}var mo=Object.getOwnPropertySymbols?function(t){for(var n=[];t;)wo(n,yo(t)),t=kn(t);return n}:vo;function bo(t,n,i){var e=n(t);return Nn(t)?e:wo(e,i(t))}function go(t){return bo(t,fo,yo)}function Eo(t){return bo(t,si,mo)}var ko=Object.prototype.hasOwnProperty,_o=/\w*$/,To=kt?kt.prototype:void 0,Ao=To?To.valueOf:void 0;var So=Kn&&Kn.isMap,Ro=So?Gn(So):function(t){return Sn(t)&&"[object Map]"==ao(t)},Oo=Kn&&Kn.isSet,jo=Oo?Gn(Oo):function(t){return Sn(t)&&"[object Set]"==ao(t)},Mo={};function Io(t,n,i,e,r,u){var o,s=1&n,a=2&n,h=4&n;if(i&&(o=r?i(t,e,r,u):i(t)),void 0!==o)return o;if(!Mt(t))return t;var c=Nn(t);if(c){if(o=function(t){var n=t.length,i=new t.constructor(n);return n&&"string"==typeof t[0]&&ko.call(t,"index")&&(i.index=t.index,i.input=t.input),i}(t),!s)return mn(t,o)}else{var f=ao(t),d="[object Function]"==f||"[object GeneratorFunction]"==f;if(Un(t))return ln(t,s);if("[object Object]"==f||"[object Arguments]"==f||d&&!r){if(o=a||d?{}:An(t),!s)return a?function(t,n){return ni(t,mo(t),n)}(t,function(t,n){return t&&ni(n,si(n),t)}(o,t)):function(t,n){return ni(t,yo(t),n)}(t,function(t,n){return t&&ni(n,fo(n),t)}(o,t))}else{if(!Mo[f])return r?t:{};o=function(t,n,i){var e=t.constructor;switch(n){case"[object ArrayBuffer]":return yn(t);case"[object Boolean]":case"[object Date]":return new e(+t);case"[object DataView]":return function(t,n){var i=n?yn(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}(t,i);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return wn(t,i);case"[object Map]":return new e;case"[object Number]":case"[object String]":return new e(t);case"[object RegExp]":return function(t){var n=new t.constructor(t.source,_o.exec(t));return n.lastIndex=t.lastIndex,n}(t);case"[object Set]":return new e;case"[object Symbol]":return function(t){return Ao?Object(Ao.call(t)):{}}(t)}}(t,f,s)}}u||(u=new on);var v=u.get(t);if(v)return v;u.set(t,o),jo(t)?t.forEach((function(e){o.add(Io(e,n,i,e,t,u))})):Ro(t)&&t.forEach((function(e,r){o.set(r,Io(e,n,i,r,t,u))}));var l=h?a?Eo:go:a?keysIn:fo,p=c?void 0:l(t);return function(t,n){for(var i=-1,e=null==t?0:t.length;++i<e&&!1!==n(t[i],i););}(p||t,(function(e,r){p&&(e=t[r=e]),ti(o,r,Io(e,n,i,r,t,u))})),o}function No(t){return Io(t,5)}function Do(t){var n=this,i={},e={get attributes(){return Object.assign({},n)},get previousAttributes(){return i},clear:function(){r();var t=n.attributes;for(var i in t)delete n[i]},set:function(t){for(var i in r(),t=No(t))n[i]=t[i]},clone:function(){return new Do(n.attributes)},toJSON:function(){return No(n.attributes)}};function r(){co(n.attributes)||(i=No(n.attributes))}return e.set(t),ut(n,e)}function Po(t,n){var i=new Do(di(t,n)),e=!1;return ot(i,{reset:function(t){return i.clear(),function(t){e=!0,i.set(t),di(i,n)}(t),i},isNewVideo:function(){var t=i.previousAttributes;return!e||t.video.id!==i.video.id||t.video.version.current!==i.video.version.current||t.video.live_event&&!qu(t.video.live_event)&&qu(i.video.live_event)}})}Mo["[object Arguments]"]=Mo["[object Array]"]=Mo["[object ArrayBuffer]"]=Mo["[object DataView]"]=Mo["[object Boolean]"]=Mo["[object Date]"]=Mo["[object Float32Array]"]=Mo["[object Float64Array]"]=Mo["[object Int8Array]"]=Mo["[object Int16Array]"]=Mo["[object Int32Array]"]=Mo["[object Map]"]=Mo["[object Number]"]=Mo["[object Object]"]=Mo["[object RegExp]"]=Mo["[object Set]"]=Mo["[object String]"]=Mo["[object Symbol]"]=Mo["[object Uint8Array]"]=Mo["[object Uint8ClampedArray]"]=Mo["[object Uint16Array]"]=Mo["[object Uint32Array]"]=!0,Mo["[object Error]"]=Mo["[object Function]"]=Mo["[object WeakMap]"]=!1;var Co=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,xo=/^\w*$/;function Lo(t,n){if("function"!=typeof t||null!=n&&"function"!=typeof n)throw new TypeError("Expected a function");var i=function i(){var e=arguments,r=n?n.apply(this,e):e[0],u=i.cache;if(u.has(r))return u.get(r);var o=t.apply(this,e);return i.cache=u.set(r,o)||u,o};return i.cache=new(Lo.Cache||un),i}Lo.Cache=un;var Uo=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ho=/\\(\\)?/g,Fo=function(t){var n=Lo((function(t){var n=[];return 46===t.charCodeAt(0)&&n.push(""),t.replace(Uo,(function(t,i,e,r){n.push(e?r.replace(Ho,"$1"):i||t)})),n}),(function(t){return 500===i.size&&i.clear(),t})),i=n.cache;return n}();function Bo(t){if("string"==typeof t||tu(t))return t;var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}function Vo(t,n,i){var e=null==t?void 0:function(t,n){for(var i=0,e=(n=function(t,n){return Nn(t)?t:function(t,n){if(Nn(t))return!1;var i=F(t);return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!tu(t))||xo.test(t)||!Co.test(t)||null!=n&&t in Object(n)}(t,n)?[t]:Fo(cu(t))}(n,t)).length;null!=t&&i<e;)t=t[Bo(n[i++])];return i&&i==e?t:void 0}(t,n);return void 0===e?i:e}function qo(t,n,i){return void 0===i&&(i=n,n=void 0),void 0!==i&&(i=(i=ou(i))==i?i:0),void 0!==n&&(n=(n=ou(n))==n?n:0),function(t,n,i){return t==t&&(void 0!==i&&(t=t<=i?t:i),void 0!==n&&(t=t>=n?t:n)),t}(ou(t),n,i)}function Wo(t){return t.quality||t.metadata.quality}function Go(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],e=t.url;if("avc_url"in t&&(e=t.avc_url),i)return e;var r=n?xi.spatialHEVC&&xi.hevc:xi.hevc,u=n?xi.spatialHEVC&&xi.hdr:xi.hdr;return u&&"hevc_hdr_url"in t?e=t.hevc_hdr_url:r&&"hevc_sdr_url"in t?e=t.hevc_sdr_url:xi.av1&&"av1_url"in t&&(e=t.av1_url),e}function $o(t){if(co(t.progressive))return[];var n=t.progressive;return"progressive_avc"in t&&(n=t.progressive_avc),n.filter(zo(n))}function Yo(t){if("number"==typeof t)return t;var n=t.split("-");return 5===n.length?n[0]:parseInt(n[0],10)}function zo(t){var n=t.filter(Ko).map(Wo);return function(t){return-1===n.indexOf(Wo(t))||Ko(t)}}function Ko(t){var n=t.fps;return"metadata"in t&&(n=t.metadata.fps),n>30}function Xo(t){return Jo(t)>=720}function Jo(t){return"string"!=typeof t&&(t=Wo(t)),parseInt(t,10)}function Qo(t){var n=$o(t.request.files).map((function(t){return t.quality}));return Zo(t,t.embed.quality,n)}function Zo(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return t.embed.on_site||xi.android||xi.iOS||xi.windowsPhone||!n||i.length&&-1===i.indexOf(n)?null:n}function ts(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"desc";return function(n,i){var e=Jo(n),r=ns(n),u=Jo(i),o=ns(i);return"asc"===t?e-u||r-o:u-e||o-r}}function ns(t){return"object"!==F(t)?0:"fps"in t?t.fps:"metadata"in t&&"fps"in t.metadata?t.metadata.fps:0}function is(t){var n=t.video.live_event,i=t.request.files;if(!co(i.hls)){var e,r=i.hls.default_cdn,u=i.hls.cdns[r].json_url||(null==(e=n.playback)?void 0:e.hls_noredirect),o=t.request.flags.live_dash?2:1;return{id:"hls-".concat(r,"-").concat(t.video.id),src:u,mime:Fu.hlsLive,priority:o,metadata:{cdn:r,origin:i.hls.cdns[r].origin,quality:"sd"}}}return null}function es(t,n){var i=[];if(n.video){var e=n.video.currentFile.mime;if(e===Fu.hlsLive)return n.manifest.video.map((function(t){return G(G({},t),{},{quality:"".concat(t.height,"p")})}));i=[Fu.dash,Fu.dashMpd].includes(e)?function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return[];var i=t.streams;"streams_avc"in t&&(i=t.streams_avc);var e=n?xi.spatialHEVC&&xi.hevc:xi.hevc,r=n?xi.spatialHEVC&&xi.hdr:xi.hdr;return r&&"streams_hevc_hdr"in t?i=t.streams_hevc_hdr:e&&"streams_hevc_sdr"in t?i=t.streams_hevc_sdr:xi.av1&&"streams_av1"in t&&(i=t.streams_av1),i}(t.request.files.dash,t.video.spatial):n.video.files.filter((function(t){return"progressive"===Bu[t.mime]}))}return i.filter(zo(i)).sort(ts())}function rs(t){var n=Wo(t),i={"1440p":"2K","2160p":"4K","2700p":"5K","3240p":"6K","3780p":"7K","4320p":"8K"};for(var e in i)n=n.replace(e,i[e]);return n}function us(t){return xi.spatialPlayback&&t.video.spatial?35:50}var os={captureException:function(t){},captureMessage:function(t){},captureBreadcrumb:function(){}},ss=os,as=function(t){ss=Object.assign({},os,t)},hs=function(t,n){return ss.captureException(t,n)},cs=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"backbone",e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"info";return ss.captureBreadcrumb(t,n,i,e)};function fs(t,n,i){var e=t.embed.playsinline&&(xi.mobileAndroid||xi.iOS>=10),r=!1,u=!1,o=!1,s=!0,a="auto";function h(t){if(!s&&i.buffered&&i.buffered.length>0){t=t||i.currentTime;var e=function(t,n){var i=t.length-1;if(t.length>1)for(var e=0,r=t.length;e<r;e++)if(t.start(e)<=n&&t.end(e)>=n){i=e;break}return i}(i.buffered,t),u=i.buffered.end(e),a=u/i.duration,h=i.duration;if(n.fire(li.PROGRESS,{loaded:u,duration:h,loadProgress:a}),o&&r&&u===i.duration)return void(r&&i.paused&&i.play().catch(hs))}}function c(n){if("auto"!==n){var e=es(t,i).reverse().map((function(t){return t.quality})).indexOf(n);-1!==e&&(cs("Switched to ".concat(n),{},"video"),i.video.currentFile.restrictedStreamIndexes=[e])}else i.video.currentFile.restrictedStreamIndexes=[]}function f(e){var r=es(t,i).map((function(t){return t.quality})),u=Zo(t,t.embed.quality,r);u&&n.fire(Mu,u),c(u||"auto")}return n.on(Ru,(function(){i.playsinline=e,i.muted=t.embed.muted})),n.on(bu,(function(){s=!0,i.paused||i.pause(),u=!1,r=!1,setTimeout((function(){i.currentTime=0}),300)})),i.on(li.PLAY,(function(){s=!1,n.fire(li.PLAY,i.currentTime)})),i.on(li.PAUSE,(function(){r=!1,n.fire(li.PAUSE,i.currentTime,i.ended)})),i.on(li.PLAYING,(function(t){h()})),i.on(li.TIME_UPDATE,(function(t){var e=i.currentTime;if(!s){var r=i.duration,u=e/r,o=i.playbackRate;n.fire(li.TIME_UPDATE,{currentTime:e,duration:r,timeProgress:u,playbackRate:o})}})),i.on(li.ENDED,(function(t){i.loop?i.play().catch(hs):(r=!1,n.fire(li.ENDED,t))})),i.on(li.LOADED_METADATA,(function(n){var e=i.duration;if(isFinite(e)&&e>0){if(e<t.video.duration-1||e>t.video.duration+1)return;t.video.duration=e}t.video.video_width=i.videoWidth,t.video.video_height=i.videoHeight})),i.on(li.DURATION_CHANGE,(function(n){var e=i.duration;isFinite(e)&&(t.video.duration>0&&(e<t.video.duration-1||e>t.video.duration+1)||(t.video.duration=e))})),i.on(li.PROGRESS,h),i.on(wi.BUFFER_STARTED,(function(){o=!0})),i.on(wi.BUFFER_ENDED,(function(){o=!1})),n.on(mu,(function(n,e){e||(e=(i.duration||t.video.duration)*qo(n,0,1)),e=qo(e,0,i.duration||t.video.duration),i.currentTime=e})),i.on(li.SEEKING,(function(){var t=i.currentTime,e=i.duration,r=t/e;n.fire(li.SEEKING,{currentTime:t,duration:e,timeProgress:r})})),i.on(li.SEEKED,(function(){h();var t=i.currentTime,e=i.duration,r=t/e;n.fire(li.SEEKED,{currentTime:t,duration:e,timeProgress:r})})),i.on(wi.CURRENT_FILE_CHANGE,(function(e){cs("Current file changed",{id:e.id,mime:e.mime,src:e.src,metadata:e.metadata},"video"),e.metadata.quality,[Fu.dash,Fu.dashMpd].includes(e.mime)&&f(),[Fu.hlsLive].includes(e.mime)?i.once(wi.STREAMS_LOADED,(function(){f()})):function(i){var e=Qo(t);e&&n.fire(Mu,e)}()})),{play:function(){return r=!0,u||(n.fire(Ou),u=!0),i.play()},pause:function(){r=!1,i.pause()},get quality(){return a},set quality(e){!function(e){var r=i.video.currentFile.mime;if([Fu.dash,Fu.dashMpd,Fu.hlsLive].includes(r))c(e);else{var u=es(t,i).filter((function(t){return t.metadata.quality===e}));u.length>0&&(s=!0,i.video.currentFile=u[0])}a=e,n.fire(ju,e)}(e)}}}function ds(t,n,i){var e=!1,r=i.presentationMode;function u(){!i.supportsPresentationMode("picture-in-picture")||xi.spatialPlayback&&t.video.spatial?n.fire(Cu):n.fire(Pu)}i.on(li.LOADED_METADATA,(function(){e=!0})),i.on(li.PLAY,(function(){e?u():i.once(li.LOADED_METADATA,u)})),i.on(wi.PRESENTATION_MODE_CHANGE,(function(t){"inline"===r&&"picture-in-picture"===t&&n.fire(xu),"picture-in-picture"===r&&"inline"===t&&n.fire(Lu),r=t,i.video.textTracks.forEach((function(n){"picture-in-picture"===t&&"hidden"===n.mode&&(n.mode="showing"),"inline"===t&&"showing"===n.mode&&(n.mode="hidden")}))})),n.on(_u,(function(){i.supportsPresentationMode("picture-in-picture")&&(i.presentationMode="picture-in-picture")})),n.on(Tu,(function(){i.supportsPresentationMode("picture-in-picture")&&(i.presentationMode="inline")}))}function vs(t,n,i){var e=null;xi.spatialPlayback&&(n.on(Ru,(function(){e&&(i.deactivateEffect(Zr),e=null,n.fire(Du,e));var r=t.video.spatial;r&&(t.request.drm||i.supportsEffect(Zr)&&(e=i.activateEffect(Zr,{threeUrl:t.request.urls.three_js,fps:t.video.fps,fieldOfView:r.fov,directorTimeline:r.director_timeline,projection:r.projection,stereoMode:r.stereo_mode,initialView:r.initial_view,isMobile:xi.android,dimensions:t.embed.on_site?{width:1080,height:540}:{width:640,height:360}}),n.fire(Du,e)))})),i.on(bi.SPATIAL_UNSUPPORTED,(function(){e&&(i.deactivateEffect(Zr),e=null,n.fire(Du,e))})))}function ls(t,n,i){var e=null;n.on(Ru,(function(){e&&(i.deactivateEffect(zr),e=null),t.video.canvas&&(t.request.drm||i.supportsEffect(zr)&&(e=i.activateEffect(zr)))}))}var ps=ci((function(t,n,i){ai(t,n,i)}));function ys(t,n,i){return i?n?n(t):t:(t&&t.then||(t=P.resolve(t)),n?t.then(n):t)}var ws=function(){function t(t,n,i){et(this),this.Ls=No(t),this.Us=t.session_url||t.sessionUrl,this.Hs=n,this.Fs=i,this.Bs=!1,this.Vs=!1,this.qs()}var n=t.prototype;return n.disable=function(){this.Vs=!0},n.forcePolling=function(){this.isForcePolling||(this.Bs=!0,this.qs())},n.unforcePolling=function(){this.Bs=!1},n.qs=function(){!1!==this.Ls.polling&&(this.Ws()?this.Gs():this.$s()&&this.Ys())},n.$s=function(){var t;return!($u(this.Ls)&&"started"!==(null==(t=this.Ls.archive)?void 0:t.status)||!this.isForcePolling&&Gu(this.Ls))},n.Ws=function(){return!this.Us||!(!Wu(this.Ls)||null!==this.Ls.id)},n.zs=function(){try{var t=this;return ys(We(t.Hs).json(),(function(n){return t.Us=n.url,n.url}))}catch(t){return P.reject(t)}},n.Ys=function(){try{var t=this;if(t.Vs)return;var n,i={};return xi.browser.ie&&(i={Pragma:"no-cache","Cache-Control":"no-cache"}),function(t,n){return t&&t.then?t.then(n):n()}(function(e,r){try{var u=ys(We({url:t.Us,retry:3,retryStatus:function(t){return[410].includes(t)||Te.retryStatus(t)},hooks:{beforeRetry:[t.Lt.bind(t)]},headers:i}).json(),(function(t){n=t}))}catch(t){return r()}return u&&u.then?u.then(void 0,r):u}(0,(function(){throw new Error("Hit max retries polling ".concat(t.Us))})),(function(i){if(n.status!==t.Ls.status){var e;if($u(n)&&"provision_expire"===n.terminate_reason)return t.Us=null,t.Ls.id=null,void setTimeout(t.qs.bind(t),5e3);var r=(q(e={},"active",Vu.EVENT_ACTIVE),q(e,"pending",Vu.EVENT_PENDING),q(e,"started",Vu.EVENT_STARTED),q(e,"ended",Vu.EVENT_ENDED),e)[n.status];try{t.fire(r,n)}catch(t){throw new Error("Error firing live event status change ".concat(t))}}if(n.archive&&(!t.Ls.archive||n.archive.status!==t.Ls.archive.status)){var u,o=(q(u={},"started",Vu.ARCHIVE_STARTED),q(u,"done",Vu.ARCHIVE_DONE),q(u,"error",Vu.ARCHIVE_ERROR),u)[n.archive.status];t.fire(o,n)}t.Ls=ps(t.Ls,n),t.$s()&&setTimeout(t.Ys.bind(t),5e3)}))}catch(t){return P.reject(t)}},n.Lt=function(t,n){try{return ys(this.zs(),(function(n){t.url=n}))}catch(t){return P.reject(t)}},n.Gs=function(){try{var t=this;if(t.Vs)return;return ys(We(t.Fs).json(),(function(n){var i=!1;return function(e,r){var u=function(){if(null!==n.ingest.session_id)return t.Ls.id=n.ingest.session_id,ys(t.zs(),(function(){t.Ys(),i=!0}))}();return u&&u.then?u.then(r):r(u)}(0,(function(n){if(i)return n;setTimeout(t.Gs.bind(t),5e3)}))}))}catch(t){return P.reject(t)}},V(t,[{key:"isForcePolling",get:function(){return this.Bs}}]),t}();function ms(){}function bs(t,n,i){var e,r,u=function(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return P.resolve(t.apply(this,n))}catch(t){return P.reject(t)}}}((function(t){return function(t){if(t&&t.then)return t.then(ms)}(function(n,e){try{var u=function(t,n,i){return t&&t.then||(t=P.resolve(t)),n?t.then(n):t}(ht("module/streamroot.js"),(function(n){r=n(i,{TelecineEvents:wi,VideoEvents:li},t)}))}catch(t){return}return u&&u.then?u.then(void 0,e):u}(0,(function(t){})))}));function o(){i.endLive()}n.on(Au,(function(){r&&r.destroy(),t.video.p2p&&(u(t.video.p2p),i.bufferTarget=30,i.presentationDelay=30),e&&(e.disable(),e=null),t.video.live_event&&!qu(t.video.live_event)&&function(i){(e=new ws(i,function(t){return zu(t,"/session/refresh")}(t),function(t){return"https://".concat(t.vimeo_url,"/live_event/status?clip_id=").concat(t.video.id)}(t))).on(Vu.EVENT_ENDED,o),Object.keys(Vu).forEach((function(t){var i=Vu[t];e.on(i,(function(t){n.fire(i,t)}))}))}(t.video.live_event)})),n.on(gu,(function(){e&&e.disable()})),i.on(Vu.STREAM_ONLINE,(function(){e.isForcePolling&&e.unforcePolling()})),i.on(Vu.STREAM_OFFLINE,(function(){e.isForcePolling||e.forcePolling()}))}function gs(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t||"null"===t||0===n.length)return{track:null};var i=t.split("."),e=Z(i,2),r=e[0],u=e[1],o=r.split(/[-_]/),s=Z(o,1),a=s[0],h=r!==a,c=n.filter((function(t){return h&&t.language===r||t.language===a})).sort((function(t,n){var i=2*(t.language===a&&t.kind===u)+2*(t.language===r)+1*(t.kind===u);return 2*(n.language===a&&n.kind===u)+2*(n.language===r)+1*(n.kind===u)-i}));return c.length>0?{track:c[0],exactMatch:c[0].language===r&&c[0].kind===u}:{track:null}}function Es(t,n,i){var e;function r(){if(0!==n.video.textTracks.length){if(n.video.textTracks.forEach((function(t){t.on("cuechange",u),t.on("modechange",o)})),n.video.textTracks.language&&Z(n.video.textTracks.language.split(/[-_]/),1)[0]!=Z(n.video.textTracks.language.split(/[-_]/),1)[0]){var i="".concat(n.video.textTracks.language,".subtitles");if(gs(i,n.video.textTracks).track)return void t.fire(Eu,i)}t.fire(ku)}else t.fire(ku)}function u(n){for(var i,e=n.target,r=e.activeCues,u=[],o=0,s=r.length;o<s;o++)""!==r[o].text.replace(/^\s+|\s+$/gm,"")&&((i=document.createElement("span")).appendChild(r[o].getCueAsHTML()),u.push({html:i.innerHTML.replace("\n","<br>"),text:r[o].text}));t.fire(Iu,e,u)}function o(n){var e=n.target,r=i.querySelector("video");xi.iOS&&function(t){var n=[document.fullscreenElement,document.webkitFullscreenElement,document.webkitCurrentFullScreenElement,document.mozFullScreenElement,document.msFullscreenElement].find((function(t){return void 0!==t}));return void 0!==n?!!n:t.webkitDisplayingFullscreen}(r)&&"showing"===e.mode&&t.fire(Nu,e)}t.on(Ru,r),t.on(Eu,(function(i){if(!e||e.id!==i){var r=n.video.textTracks.getTrackById(i),u=!0;if(!r){var o=gs(i,n.video.textTracks);r=o.track,u=o.exactMatch}r!==e&&setTimeout((function(){n.video&&n.video.textTracks.forEach((function(t){t.mode=t===r?"hidden":"disabled"})),t.fire(Nu,r,!u),e=r}),0)}})),t.on(ku,(function(){setTimeout((function(){n.video&&n.video.textTracks.forEach((function(t){t.mode="disabled"})),t.fire(Iu),e&&(e=null,t.fire(Nu,null))}),0)})),t.on(wi.TEXT_TRACKS_AVAILABLE,r)}function ks(t,n,i){var e,r;return e=new Yr(i,[lr,jr,Nr,Ee],{externalDisplays:[AirPlayExternalDisplay],mediaSourceScanner:{droppedFrameSwitchPercent:us(t)},tests:t.request.ab_tests,fileCodecs:t.request.file_codecs,bufferTarget:t.video.buffer_target,presentationDelay:t.video.presentation_delay}),Object.values(li).filter((function(t){return![li.TIME_UPDATE,li.PROGRESS,li.SUSPEND,li.ERROR].includes(t)})).forEach((function(t){e.on(t,(function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";cs(t,n,"video event")}))})),e.on(wi.STREAMS_LOADED,(function(n){n.video.forEach((function(n){var i=function(t,n){return n.find((function(n){return Yo(n.id)===String(t)||Yo(n.id)===Yo(t)}))}(n.id,es(t,e));i?(n.profile=i.profile,n.quality=i.quality,n.fps=i.fps):(n.profile=null,n.quality="".concat(n.height,"p"),n.fps=n.framerate)}))})),e.on(wi.STREAM_CHANGE,(function(t){var i=t.index,e=t.streams,r=e[i];cs("Stream changed",r,"video"),n.fire(wi.STREAM_CHANGE,r,i,e)})),e.on(wi.STREAM_TARGET_CHANGE,(function(t){var i=t.index,e=t.streams,r=e[i];n.fire(wi.STREAM_TARGET_CHANGE,r,i,e)})),function(t,n,i){i.forEach((function(i){t(i,(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];n.apply(void 0,[i].concat(e))}))}))}(e.on,n.fire,[pi.ACTIVATED,pi.AVAILABLE,pi.DEACTIVATED,pi.UNAVAILABLE,mi.STREAM_OFFLINE,mi.STREAM_ONLINE,mi.BUFFER_GAP_JUMP,mi.BUFFER_GAP_JUMP_PREVENT,gi.MEDIASESSION_PAUSE,gi.MEDIASESSION_PLAY,gi.MEDIASESSION_SEEK_BACKWARD,gi.MEDIASESSION_SEEK_FORWARD,wi.AV_DURATION_MISMATCH,wi.BANDWIDTH,wi.BUFFER_ENDED,wi.BUFFER_OCCUPANCY,wi.BUFFER_STARTED,wi.CHAPTER_CUES_UPDATED,wi.CUE_POINT,wi.CURRENT_FILE_CHANGE,wi.DOWNLOAD_END,wi.DOWNLOAD_TIMEOUT,wi.DRM_AUTH_SUCCESS,wi.DROPPED_FRAMES,wi.MANIFEST_LOADED,wi.MANIFEST_TIMEOUT,wi.QUOTA_EXCEEDED_ERROR,wi.SCANNER_CHANGE,wi.STREAM_CHANGE_START,wi.STREAM_BUFFER_END,wi.STREAM_BUFFER_START,wi.TEXT_TRACKS_AVAILABLE,bi.CAMERA_UPDATE,bi.CAMERA_CHANGE,bi.MOTION_END,bi.MOTION_START,bi.SPATIAL_UNSUPPORTED,bi.WEBVR_ENTER,bi.WEBVR_EXIT,bi.WEBVR_HARDWARE_AVAILABLE,Ei.BRAIN_ML_SWITCH_TO_SKYFIRE,Ei.BRAIN_ML_MODEL_INPUTS,li.DURATION_CHANGE,li.ERROR,li.LOAD_START,li.LOADED_DATA,li.LOADED_METADATA,li.PLAYING,li.RATE_CHANGE,li.RESIZE,li.STALLED,li.VOLUME_CHANGE,li.WAITING]),n.fire(Su),new Es(n,e,i),new ds(t,n,e),new vs(t,n,e),new ls(t,n,e),new bs(t,n,e),r=new fs(t,n,e),n.on(Au,(function(){var r=t.video.live_event;if(Wu(r)||function(t){return"active"===(null==t?void 0:t.status)}(r)||$u(r)&&!qu(r))e.video=null;else if(!Gu(r)||!e.video||t.isNewVideo()){var u=Gu(r)?function(t){var n=[],i=is(t);i&&n.push(i);var e=function(t){var n,i=t.video.live_event,e=t.request.files;if(co(e.dash))return null;var r=e.dash.default_cdn,u=e.dash.cdns[r].url||(null==(n=i.playback)?void 0:n.dash_noredirect),o=t.request.flags.live_dash?2:1;return{id:"dash-".concat(r,"-").concat(t.video.id),src:u,mime:Fu.dashMpd,priority:o,metadata:{cdn:r,origin:e.dash.cdns[r].origin,quality:"sd"}}}(t);return e&&n.push(e),n}(t):function(t){var n=t.request.files,i=$o(n),e=Qo(t),r=t.request.cookie.quality||e||function(t){var n=$o(t.request.files),i=n.some(Xo);xi.mobileAndroid&&(i=!1);var e="720p";if(i){var r=n.map(Wo);-1!==r.indexOf("1080p")&&-1===r.indexOf("720p")&&(e="1080p")}return t.request.cookie.hd||t.video.default_to_hd?e:"360p"}(t),u=function(t){var n=t.files,i=void 0===n?[]:n,e=t.preference,r=void 0===e?"360p":e,u=t.priorityOffset,o=void 0===u?0:u;(i=H(i)).sort(ts());var s=i.map(Wo);if(r){-1===s.indexOf(r)&&(s.push(r),s.sort((function(t,n){return Jo(n)-Jo(t)})));var a=s.indexOf(r),h=s.splice(0,a);h.reverse(),s.push.apply(s,tt(h))}return i.map((function(t){return{id:t.id,src:t.url,mime:t.mime,priority:s.indexOf(t.quality)+1+o,metadata:{profile:t.profile,cdn:t.cdn,origin:t.origin,quality:t.quality,fps:t.fps}}}))}({files:i,preference:r,priorityOffset:2}),o=t.request.drm&&xi.browser.safari;return(n.hls&&(xi.iPhone||xi.iPad)||o)&&(u=u.concat(function(t){var n=t.request.files,i=n.hls.default_cdn,e=t.request.drm,r=Go(n.hls.cdns[i],t.video.spatial,e);return{id:"hls-".concat(i,"-").concat(t.video.id),src:r,mime:Fu.hls,priority:2,metadata:{cdn:i,origin:n.hls.cdns[i].origin,quality:"sd"}}}(t))),n.dash&&!o&&(u=u.concat(function(t){var n=t.request.files;return co(n.dash)?[]:Object.keys(n.dash.cdns).map((function(i){var e=Go(n.dash.cdns[i],t.video.spatial);return{id:"dash-".concat(i,"-").concat(t.video.id),src:e,mime:t.request.drm?Fu.dashMpd:Fu.dash,priority:i===n.dash.default_cdn?1:2,metadata:{cdn:i,origin:n.dash.cdns[i].origin,quality:"sd"}}}))}(t))),u}(t),o=function(t){return t.request.text_tracks.map((function(t){return{id:t.id,src:t.url,kind:t.kind,label:t.label,language:t.lang}}))}(t);!e.video||t.isNewVideo()?function(r,u){var o=t.video.live_event,s=i.getBoundingClientRect(),a=Gu(o)?is(t):function(t){var n=t.request.files;if(!co(n.hls)){var i=n.hls.default_cdn,e=n.hls.cdns[i],r=e.captions||e.avc_url;return r?{src:r,mime:Fu.hls,metadata:{cdn:i,origin:e.origin,quality:"sd"}}:null}return null}(t);e.video={id:t.video.id,title:t.video.title,subtitle:"from ".concat(t.video.owner.name),files:r,textTracks:u,chapters:Vo(t,"embed.chapters",[]),duration:t.video.duration,externalDisplayFiles:{AirPlay:a},metadata:{playlistRefreshUrl:Yu(t),thumbnail:t.video.thumbs[640],useHls:t.request.drm&&xi.browser.safari,drm:t.request.drm,p2p:t.video.p2p,percentShown:Zr.frustumSurfaceArea(t.video.spatial.fov,s.width,s.height)}},n.fire(Ru)}(u,o):function(t,n){t.forEach((function(t){var n=e.video.files.getFileById(t.id);n&&n.src!==t.src&&(n.src=t.src)})),n.forEach((function(t){var n=e.video.textTracks.getTrackById(t.id);n&&n.src!==t.src&&(n.src=t.src)}))}(u,o)}})),st({telecine:e},r)}function _s(t,n,i){this.constructorName="BackboneError",this.message=t,this.name=n,this.source=i}_s.prototype=new Error;var Ts={embed:{},request:{cookie:{},files:{},flags:{},urls:{},text_tracks:[],file_codecs:{}},video:{owner:{},thumbs:{},version:{}},user:{}};function As(t,n){var i,e,r,u=et(),o=null,s=new Po(n,Ts);function a(t){return u.fire(Au,t),t}var h={play:function(){return e.play()},pause:function(){return e.pause()},get currentTime(){return r.currentTime>.1?pu(r.currentTime):0},set currentTime(t){if(t=parseFloat(t),isNaN(t)||t<0)throw new _s("Seconds must be a positive number less than the duration of the video.","RangeError","setCurrentTime");u.fire(mu,null,t)},get duration(){return pu(s.video.duration)},get enabledTextTrack(){return o},loadVideo:function(t){return s.reset(t),s=a(s),this},unload:function(){return u.fire(bu),this},destroy:function(){return u.fire(gu),this},on:function(t,n){return u.on(t,n),this},once:function(t,n){return u.once(t,n),this},off:function(t,n){return u.off(t,n),this},hasTextTrack:function(t){var n,i,e=this.textTracks;if(lu(t))i=e.getTrackById(t);else{var r=t.split(".")[0];n=e.some((function(t){return t.language.toLowerCase()===r.toLowerCase()}))}return!(!i&&!n)},enableTextTrack:function(t){var n,i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this.textTracks;if(lu(t))o=s.getTrackById(t);else{var a=t.split("."),h=Z(a,2);n=h[0];var c=h[1];if(i=void 0===c?e:c,!this.hasTextTrack(t))throw new _s("There are no tracks for ".concat(n.toUpperCase(),"."),"InvalidTrackLanguageError","enableTextTrack");var f=i?"".concat(n,".").concat(i):n;o=gs(f,s).track}if(!o||i&&o.kind!==i)throw new _s("There are no ".concat(i," tracks for ").concat(n.toUpperCase(),"."),"InvalidTrackError","enableTextTrack");r.Co(!0),u.fire(Eu,o.id)},disableTextTrack:function(){o=null,r.Co(!1),u.fire(ku)},get qualities(){return function(t){var n,i=t.representations.map((function(n){var i=Wo(n);return{id:i,label:rs(n),active:t.quality===i}})),e=null==(n=t.video)?void 0:n.currentFile.mime;return[Fu.dash,Fu.dashMpd,Fu.hlsLive].includes(e)&&i.unshift({id:"auto",label:"Auto",active:!t.quality||"auto"===t.quality}),i}(this)},get quality(){return e.quality},set quality(t){e.quality=t},get playbackRate(){return r?r.playbackRate:1},set playbackRate(t){r.playbackRate=t,r.defaultPlaybackRate=t},get presentationMode(){return r.presentationMode},set presentationMode(t){"picture-in-picture"===t?u.fire(_u):u.fire(Tu)},get textTracks(){return r.video?r.video.textTracks:[]},get representations(){return es(s,r)},get volume(){return r?r.volume:pu(s.request.cookie.volume)},set volume(t){if(t=parseFloat(t),isNaN(t)||t<0||t>1)throw new _s("Volume should be a number between 0 and 1.","RangeError","setVolume");r.volume=t},get videoId(){return s.video.id},get videoWidth(){return r.videoWidth||s.video.width},get videoHeight(){return r.videoHeight||s.video.height},get readyState(){return r.videoElement.readyState},get brainDebug(){return r.brainDebug}};return s=a(s),e=new ks(s,u,t),r=e.telecine,i=Object.create(r),st(i,h)}var Ss={};function Rs(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((null==(t=Ss.en)?void 0:t[n])&&(n=Ss.en[n]),Object.keys(i).forEach((function(t){n=n.replace(new RegExp("{".concat(t,"}"),"g"),i[t])})),n.match(/\{\w+}/))throw new Error("Missing token definition.");return n}function Os(t){return function(t){return/^(https?:)?\/\/(.+)\.vimeo(ws)?\.(com|dev)(?=$|\/)/.test(t)}(t)?function(t){try{return new URL(t).origin}catch(t){}var n=document.createElement("a");return n.href=t,n.origin?n.origin:"".concat(n.protocol.replace(":",""),"://").concat(n.host)}(t):""}function js(t,n,i){if(function(t){return/^(https?:)?\/\/(.+)\.vimeo(ws)?\.(com|dev)\/video\/\d+\/config(?=$|\?)/.test(t)}(n))return n;var e=function(t){if(function(t){return!isNaN(t)&&parseInt(Number(t),10)==t&&!isNaN(parseInt(t,10))}(t))return parseInt(t,10);var n=t.match(/(video|\.com|\.dev)\/(\d+)/);if(!n||n.length<3)throw new Error("Please provide a Vimeo URL with a valid clip id.");return parseInt(n[2],10)}(n),r=vt(window.location.search),u=vt("".concat(n).split("?")[1]),o=Object.assign(r,u,i);return lt("".concat(t,"/video/").concat(e,"/config"),o)}function Ms(t,n){return-1!==H(n).indexOf(t)}function Is(t,n){return n&&0===n.indexOf(t)}!function(t){for(var n=this,i=function i(e){return e.length>=t.length?t.apply(n,e):function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return i([].concat(tt(e),n))}},e=arguments.length,r=new Array(e>1?e-1:0),u=1;u<e;u++)r[u-1]=arguments[u];i(r)}((function(t,n){return Object.keys(t).every((function(i){return t[i]===n[i]}))})),function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];n.reduce((function(t,n){return function(){return t(n.apply(void 0,arguments))}}))}((function(t){return t?H(t.parentNode.children).indexOf(t):-1}),(function(t,n){for(;(null==(i=t)?void 0:i.parentElement)&&!Ms(t,n);){var i;t=t.parentElement}return Ms(t,n)?t:null}));var Ns=0;function Ds(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"p",n=++Ns;return"".concat(t).concat(n)}function Ps(t){var n=t;return!t||t instanceof Error||(n=new Error(t.message||t),t.name&&(n.name=t.name)),n}Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds(),Ds();var Cs={Ks:Ds(),Xs:Ds(),Js:Ds(),Qs:Ds(),Ue:Ds(),Zs:Ds(),ta:Ds(),na:Ds(),ia:Ds(),ea:Ds(),ra:Ds(),oa:Ds(),sa:Ds(),aa:Ds(),ha:Ds(),ca:Ds(),fa:Ds(),da:Ds(),va:Ds(),la:Ds(),pa:Ds(),ya:Ds(),wa:Ds(),ma:Ds(),ba:Ds(),ga:Ds(),Ea:Ds(),ka:Ds(),_a:Ds(),Ta:Ds(),Aa:Ds(),Sa:Ds(),Ra:Ds(),Oa:Ds(),ja:Ds(),Ma:Ds(),Ia:Ds(),Na:Ds(),Da:Ds(),Pa:Ds(),Ca:Ds(),xa:Ds(),La:Ds(),Ua:Ds(),Ha:Ds(),Fa:Ds(),Ba:Ds(),Va:Ds(),qa:Ds(),Wa:Ds(),Ga:Ds(),$a:Ds(),Ya:Ds(),za:Ds(),Ka:Ds(),Xa:Ds(),Ja:Ds(),Qa:Ds(),Za:Ds(),th:Ds(),nh:Ds(),ih:Ds(),eh:Ds(),rh:Ds(),uh:Ds(),oh:Ds(),sh:Ds(),ah:Ds(),hh:Ds(),fh:Ds(),dh:Ds(),vh:Ds(),lh:Ds(),ph:Ds(),yh:Ds(),wh:Ds(),mh:Ds(),bh:Ds(),gh:Ds(),Eh:Ds(),kh:Ds(),_h:Ds(),Th:Ds(),Ah:Ds(),Sh:Ds(),Rh:Ds(),Oh:Ds(),jh:Ds(),Mh:Ds(),Ih:Ds(),Nh:Ds(),Dh:Ds(),Ph:Ds(),Ch:Ds(),xh:Ds(),Lh:Ds(),Uh:Ds(),Hh:Ds(),Fh:Ds(),Bh:Ds(),Vh:Ds(),qh:Ds(),Wh:Ds(),Gh:Ds(),_loadVideo:Ds(),$h:Ds(),Yh:Ds(),zh:Ds(),Kh:Ds(),Xh:Ds(),Jh:Ds(),Qh:Ds(),Zh:Ds(),tc:Ds(),nc:Ds(),ic:Ds(),ec:Ds(),rc:Ds(),uc:Ds(),oc:Ds(),sc:Ds(),ac:Ds(),hc:Ds(),cc:Ds(),fc:Ds(),ne:Ds(),dc:Ds(),vc:Ds(),lc:Ds(),pc:Ds(),yc:Ds(),wc:Ds(),mc:Ds(),bc:Ds(),gc:Ds(),Ec:Ds(),kc:Ds(),_c:Ds(),Tc:Ds(),Ac:Ds(),Sc:Ds(),Rc:Ds(),Oc:Ds()},xs=(Ds(),Ds(),Ds(),Ds(),7);function Ls(t){return"dev"===t.request.build.js?"dev":"3.24.2"}var Us,Hs=new P((function(t){Us=t}));function Fs(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Hs.then((function(e){return i/=.1,Math.random()<=i&&e.captureException(Ps(t),n),e.lastEventId()}))}window.addEventListener("unhandledrejection",(function(t){t.preventDefault(),t.reason&&Fs(t.reason).catch((function(t){}))}));var Bs={setUp:function(t){t.config.request.sentry.enabled&&ht("module/sentry.js").then((function(n){var i="dev"===t.config.request.build.js?"dev":"production",e=[new n.Integrations.Dedupe,new n.Integrations.ExtraErrorData,new n.Integrations.Breadcrumbs({console:!1}),new n.Integrations.GlobalHandlers({onunhandledrejection:!1})];return n.init({dsn:t.config.request.sentry.url,release:Ls(t.config),environment:i,integrations:e,ignoreErrors:["NotAllowedError","AbortError","PlayInterrupted","Failed to load image"],blacklistUrls:[/^moz-extension/i,/^chrome-extension/i],beforeSend:function(i,e){var r;if(!t.config.request)return null;if(xi.appleMail)return null;if(Is("ReportingObserver",i.message)&&Math.random()>.01)return null;var u=null==(r=e.originalException)?void 0:r.error;return Is("Non-Error exception captured",i.message)&&u?(n.withScope((function(t){t.setExtra("nonErrorException",!0),n.captureException(u)})),null):(i.tags["document.visibilityState"]=document.visibilityState,t.config.request.sentry.enabled?i:null)}}),n.configureScope((function(n){if(n.setTag("session",t.config.request.session),n.setTag("locale",t.config.request.lang),n.setTag("debug_intent",t.config.request.sentry.debug_intent?1:0),n.setTag("product",function(t){return t.config.video.p2p?"vimeo-live-ecdn":t.config.request.flags.ott?"vimeo-ott-vod":t.config.video.live_event?"vimeo-live":t.config.embed.context&&-1!==t.config.embed.context.indexOf("Stock")?"vimeo-stock-vod":t.config.video.vod?"vimeo-ondemand":"vimeo-vod"}(t)),n.setTag("backend",t.config.request.build.backend),n.setTag("video_embed_permission",t.config.video.embed_permission),n.setTag("video_privacy",t.config.video.privacy),t.config.user.logged_in&&n.setUser({id:t.config.user.id}),t.config.request.ab_tests)for(var i in t.config.request.ab_tests){var e=t.config.request.ab_tests[i];for(var r in n.setTag("".concat(i,"_test"),1),n.setTag("".concat(i,"_group"),e.group),e.data)n.setTag("".concat(i,"_data_").concat(r),e.data[r])}})),t.config.request.sentry.debug_intent&&window.addEventListener("unload",(function(){n.captureMessage("Session debug",{level:"info"})}),!1),n})).then(Us).catch((function(t){}))},captureException:Fs,captureMessage:function(t,n){return Hs.then((function(i){return i.captureMessage(t,n),i.lastEventId()}))},captureBreadcrumb:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"player",e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"info";return Hs.then((function(r){return r.addBreadcrumb({message:t,data:n,category:i,level:e})}))}};function Vs(t){var n=t.events,i=null,e=null,r=null,u=null,o=null,s={video:{},request:{},embed:{}};function a(){return e&&e-6e4<=Date.now()}function h(t){var n=Date.now()+1e3*t;return o=setTimeout((function(){"onLine"in navigator&&!navigator.onLine||u||(u=f().catch(Bs.captureException))}),1e3*t-6e4-5e3),n}function c(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};clearTimeout(o);var u=i;if(isNaN(t)&&"string"!=typeof t)return e=h((i=t).request.expires),P.resolve({old:u,loaded:i});Date.now();var a=(s=ps(s,i)).request.referrer;a&&(r.referrer=a);var c=(null==(n=i)?void 0:n.player_url)?"https://".concat(i.player_url):"",f=Os(t)||c,d=js(f,t,r);return We(d,{withCredentials:!0,throwHttpErrors:!1}).json().then((function(t){return(i=t).view!==xs&&(e=h(i.request.expires),s.request.session&&i.video.id===s.video.id&&(i.request.session=s.request.session),a&&(i.request.referrer=a),s.embed.player_id&&(i.embed.player_id=s.embed.player_id),s.embed.on_site&&(i.embed.on_site=1,i.embed.context=s.embed.context)),Date.now(),{old:u,loaded:i}})).catch((function(t){Bs.captureException(t)}))}function f(){var t;clearTimeout(o),Date.now();var r=null==(t=i)?void 0:t.request.referrer,s=i.request,a=s.signature,c=s.session,f=s.timestamp,d=s.expires,v=i.request.ott_chromecast_token,l="https://".concat(i.player_url,"/video/").concat(i.video.id,"/config/request?session=").concat(c,"&signature=").concat(a,"&time=").concat(f,"&expires=").concat(d);return v&&(l="".concat(l,"&ott_chromecast_token=").concat(v)),r&&(l+="".concat(-1===l.indexOf("?")?"?":"&","referrer=").concat(encodeURIComponent(r))),We(l,{withCredentials:!0,retry:3}).json().then((function(t){return i.request=t,r&&(i.request.referrer=r),e=h(i.request.expires),Date.now(),u=null,n.fire(Cs.Ch),i.request})).catch((function(t){var i={id:"network",title:Rs("Network error"),message:Rs("A network hiccup interrupted playback. Please {linkStart}reload the player{linkEnd} and try again.",{linkStart:'<a href="javascript:window.location.reload()" rel="noopener">',linkEnd:"</a>"}),final:!0};throw n.fire(Cs.Xs,i.id,i),t}))}return window.addEventListener("online",(function(){a()&&(u=f().catch(Bs.captureException))})),n.on(Cs.Xs,(function(t){u||"media-url-expired"!==t||(u=f().catch(Bs.captureException))})),{get isExpired(){return a()},load:function(t,n){return c(t,n)},reload:function(){var t;return(null==(t=i)?void 0:t.video.id)?c(i.video.id):P.reject(new Error("No config loaded."))},toJSON:function(){return i},get config(){return i},set config(t){i=t},verify:function(){return a()?(u||(u=f()),u):P.resolve(i.request)},get H(){return r},set H(t){r=t}}}t.BarebonePlayer=function(t,n){as(Bs);var i=null,e=document.createElement("style");e.setAttribute("type","text/css"),e.textContent="\n    .vp-telecine video {\n        width: 100%;\n        height: auto;\n    }\n",t.appendChild(e);var r=document.createElement("div");r.className="vp-video-wrapper";var u=document.createElement("div");u.className="vp-video";var o=document.createElement("div");o.className="vp-telecine",u.appendChild(o),r.appendChild(u),t.appendChild(r);var s=new Vs({events:et()});return s.load(n).then((function(){return(i=new As(o,s.config)).loadVideo(s.config),i}))}}(this.window=this.window||{});

